import{a as N,L as g,r as $,j as a,x as d,E as A,N as b,y as O,B as M}from"./index-a59700e2.js";import{u as T,a as W,c as P,m as D,T as z,C as _,G as L,L as E,A as I,b as Q,d as G,F as R,e as Y,M as q}from"./AdapterMoment-1f717f9b.js";import{s as k,T as V,u as v,B as K}from"./setupAxios-41eb1db7.js";import{D as H}from"./DynamicInputs-fcabbf9d.js";import{u as J}from"./useGetCitiesNamesQuery-13bbd935.js";import{A as U}from"./Autocomplete-63e30613.js";const X=({address:e,case_count:o,city:n,display_phone_numbers:r,email:u,first_name:i,last_name:m,office_name:l,phone_numbers:c})=>({address:e,numberOfCases:o,city:n,displayPhoneNumbers:r,email:u,name:`${T(i)} ${T(m)}`,officeName:l,phoneNumbers:c}),Z=async e=>{var m;const{sortBy:o="created_at",sort:n="desc",page:r=1,size:u=25}=e;let i;try{i=await k({method:"get",url:"api/lawyers-list",params:{...e,sortBy:o===""?"created_at":P(o),sort:n===""?"asc":n,page:r,size:u},withCredentials:!0}),(m=i.data.data)!=null&&m.lawyers&&(i.data.data.lawyers=i.data.data.lawyers.map(l=>X(l)))}catch{i={data:{error:500,message:"Connection problem"}}}return i},ee=e=>W(["lawyersList",e],()=>Z(e),{keepPreviousData:!0,refetchOnMount:!1,refetchOnWindowFocus:!1}),ae=()=>"#6b7280",S=e=>{const{id:o,first_name:n,last_name:r,city:u,email:i,name:m}=e;let l="";return m&&(l=m),n&&(l=`${n} ${r??""}`),u&&(l=u),i&&(l=i),{id:o,name:l}},se=({city:e,email:o,firstName:n,lastName:r,officeName:u,phoneNumbers:i,address:m})=>{let l=null;typeof e!="string"&&(l=e.id);const c=i.filter(t=>t.length>5);return{city_id:l,email:o,first_name:n,last_name:r,office_name:u,address:m,phone_numbers:c}},y={name:"name",officeName:"officeName",email:"email",address:"address",city:"city",displayPhoneNumbers:"displayPhoneNumbers",phoneNumbers:"phoneNumbers",numberOfCases:"numberOfCases"},te=()=>{var f,x;const{t:e}=N(),{state:{sortable:{sort:o,sortBy:n},pageable:{page:r,size:u},searchable:i},dispatch:m}=g();let l={page:r,size:u,sort:o,sortBy:n};const c=i.reduce((s,j)=>{const C=D(j);return{...s,...C}},{}),{data:t,isLoading:h,refetch:p}=ee({...l,...c}),w=$.useMemo(()=>[{accessorFn:s=>s.name,id:y.name,header:()=>a.jsx("span",{children:e(`entities.${[y.name]}`)}),cell:s=>s.getValue(),isSearchable:!0,isSortable:!0},{accessorFn:s=>s.officeName,id:y.officeName,header:()=>a.jsx("span",{children:e(`entities.${[y.officeName]}`)}),cell:s=>s.getValue(),isSearchable:!0,isSortable:!0},{accessorFn:s=>s.email,id:y.email,header:()=>a.jsx("span",{children:e(`entities.${[y.email]}`)}),cell:s=>s.getValue(),isSearchable:!0,isSortable:!0},{accessorFn:s=>s.displayPhoneNumbers,id:y.displayPhoneNumbers,header:()=>a.jsx("span",{children:e(`entities.${[y.phoneNumbers]}`)}),cell:s=>s.getValue(),isSortable:!0},{accessorFn:s=>s.address,id:y.address,header:()=>a.jsx("span",{children:e(`entities.${[y.address]}`)}),cell:s=>s.getValue(),isSearchable:!1,isSortable:!0},{accessorFn:s=>s.city,id:y.city,header:()=>a.jsx("span",{children:e(`entities.${[y.city]}`)}),cell:s=>s.getValue(),isSortable:!0},{accessorFn:s=>s.numberOfCases,id:y.numberOfCases,header:()=>a.jsx("span",{children:e(`entities.${[y.numberOfCases]}`)}),cell:s=>s.getValue(),isSortable:!0}],[]);return h?a.jsx(a.Fragment,{children:"Loading..."}):a.jsx(z,{columns:w,data:(f=t==null?void 0:t.data.data)==null?void 0:f.lawyers,hasSearch:!0,sort:o,sortBy:n,totalNumber:(x=t==null?void 0:t.data.data)==null?void 0:x.meta.total_number,page:r,size:u,borderKeyword:"type",updateState:m,refetch:p,mapBorderColors:ae})},re=({citiesOptions:e})=>[{name:"firstName",type:d.input,gridWidth:6,condition:!1},{name:"lastName",type:d.input,gridWidth:6,condition:!1},{name:"officeName",type:d.input,gridWidth:6,condition:!1},{name:"email",type:d.input,gridWidth:6},{name:"address",type:d.input,gridWidth:6,condition:!1},{name:"city",type:d.autocomplete,gridWidth:6,options:e},{name:"phoneNumbers",subfieldName:"phoneNumber",type:d.dynamicInputs,gridWidth:12}],oe=()=>{const{t:e}=N(),{state:{addLawyerForm:o,addLawyerAutocompleteValues:n},dispatch:r}=g(),{data:u}=J({search:n.city}),i=(c,t,h)=>(p,w)=>{switch(t){case d.input:const{value:f}=p==null?void 0:p.target;let x=f;h?(x=f.replace(h,""),r({type:b.addLawyerForm,payload:{name:c,fieldValue:x}})):r({type:b.addLawyerForm,payload:{name:c,fieldValue:x}});break;case d.checkbox:r({type:b.addLawyerForm,payload:{name:c,fieldValue:w}});break;case d.datepicker:r({type:b.addLawyerForm,payload:{name:c,fieldValue:p}});break;case d.dynamicInputs:r({type:b.addLawyerForm,payload:{name:c,fieldValue:p}});break;case d.autocomplete:r({type:b.addLawyerForm,payload:{name:c,fieldValue:w?S(w):""}});break;case d.dynamicAutocompletes:r({type:b.addLawyerForm,payload:{name:c,fieldValue:p.map(s=>S(s))}});break}},m=()=>console.log("Submitted"),l=c=>{const{name:t,type:h,gridClassName:p,formFieldClassName:w,gridWidth:f,options:x,size:s,subfieldName:j,format:C}=c;switch(h){case d.checkbox:return a.jsx(L,{className:p,item:!0,xs:f||12,children:a.jsx(R,{control:a.jsx(Y,{className:w,name:t,size:s??"small",checked:o[t],onChange:i(t,h)}),label:e(`entities.${t}`)})},t);case d.input:return a.jsx(L,{className:p,item:!0,xs:f||12,children:a.jsx(V,{fullWidth:!0,className:w,size:s??"small",label:e(`entities.${t}`),name:t,value:o[t],onChange:i(t,h,C)})},t);case d.autocomplete:return a.jsx(L,{className:p,item:!0,xs:f||12,children:a.jsx(U,{fullWidth:!0,className:w,options:x??[],getOptionLabel:F=>S(F).name,size:s??"small",value:o[t],onChange:i(t,h),renderInput:F=>a.jsx(V,{...F,label:e(`entities.${t}`),onChange:G(B=>r({type:b.addLawyerAutocompleteValues,payload:{inputName:t,inputValue:B.target.value}}),300)})})},t);case d.datepicker:return a.jsx(L,{className:p,item:!0,xs:f||12,children:a.jsx(E,{dateAdapter:I,children:a.jsx(Q,{label:e(`entities.${t}`),value:o[t],className:w,slotProps:{textField:{size:"small",fullWidth:!0},actionBar:{actions:["clear"]}},format:"DD. MM. YYYY",onChange:i(t,h)})})},t);case d.dynamicInputs:return a.jsx(L,{className:p,item:!0,xs:f||12,children:a.jsx(H,{label:e(`entities.${t}`),inputProps:{label:e(`entities.${j}`),size:"small",fullWidth:!0},values:o[t],onValuesChange:i(t,h)})},t);default:return""}};return a.jsx(A,{children:a.jsx(_,{children:a.jsx("form",{onSubmit:m,children:a.jsx(L,{container:!0,spacing:2,children:re({citiesOptions:u}).map(c=>l(c))})})})})},ie=async e=>{let o;try{o=await k({method:"post",url:"api/lawyers",data:e,withCredentials:!0})}catch{o={data:{error:500,message:"Connection problem"}}}return o},ne=(e,o)=>{const n=O();return v(r=>ie(r),{onSuccess:r=>(r.data.error||(o({type:b.resetLawyerFormData}),e(),n.invalidateQueries({queryKey:["lawyersList"]})),r.data.message),onError:r=>({error:r,message:"Connection problem"})})},le=e=>{const{open:o,onClose:n}=e,{t:r}=N(),{state:{addLawyerForm:u},dispatch:i}=g(),{mutate:m,isLoading:l}=ne(n,i);return a.jsx(A,{children:a.jsx(q,{open:o,header:r("entities.addNewLawyer"),children:a.jsx(oe,{}),onClose:n,hasActionButton:!0,actionButtonText:"submit",hasCancelButton:!0,onSubmit:()=>m(se(u)),isLoading:l,hasCloseIconButton:!0})})},he=e=>{const{t:o}=N(),{state:{addLawyerModalOpen:n},dispatch:r}=g();return a.jsx(A,{children:a.jsxs($.Suspense,{fallback:"Loading....",children:[a.jsx(M,{className:"my-2 flex justify-end",children:a.jsx(K,{onClick:()=>r({type:b.addLawyerModalOpen,payload:!n}),children:o("entities.addNewLawyer")})}),a.jsx(te,{}),a.jsx(le,{open:n,onClose:()=>r({type:b.addLawyerModalOpen,payload:!1})})]})})};export{he as Lawyers};
