import{e as p,j as o,F as C,H as F,J as R}from"./index-21362e13.js";import{a as j,c as P,E as i,m as T,T as O}from"./transformData-c9a6da6d.js";import{a as B}from"./setupAxios-8a7a2a3c.js";const z=({ssn:e,case_count:a})=>({ssn:e,numberOfCases:a}),$=async e=>{var t;const{sortBy:a="created_at",sort:r="asc",page:c=1,size:l=10}=e;let s;try{s=await B({method:"get",url:"api/ssn-list",params:{...e,sortBy:a===""?"created_at":P(a),sort:r===""?"asc":r,page:c,size:l},withCredentials:!0}),(t=s.data.data)!=null&&t.ssn_numbers&&(s.data.data.ssn_numbers=s.data.data.ssn_numbers.map(d=>z(d)))}catch{s={data:{error:500,message:"Connection problem"}}}return s},A=e=>j(["ssnNumbersList",e],()=>$(e),{keepPreviousData:!0,refetchOnMount:!1,refetchOnWindowFocus:!1}),E=(e,a)=>{var r;switch(a.type){case i.sortable:return{...e,sortable:a.payload};case i.pageable:return{...e,pageable:a.payload};case i.searchable:const{key:c,value:l}=a.payload,s=(r=e.searchable)==null?void 0:r.map(t=>t.key===c?{...t,value:l}:t);return e.searchable.some(t=>t.key===c)||s.push({key:c,value:l}),{...e,searchable:s};default:return e}},w={sortable:{sort:"",sortBy:""},pageable:{page:1,size:25,totalNumber:null},searchable:[]},L=p.createContext({state:w,dispatch:()=>null}),D=({children:e})=>{const[a,r]=p.useReducer(E,w);return o.jsx(L.Provider,{value:{state:a,dispatch:r},children:e})},M=()=>p.useContext(L),Q=()=>"#6b7280",h={ssn:"ssn",numberOfCases:"numberOfCases"},V=()=>{var b,m;const{t:e}=C(),{state:{sortable:{sort:a,sortBy:r},pageable:{page:c,size:l},searchable:s},dispatch:t}=M();let d={page:c,size:l,sort:a,sortBy:r};const S=s.reduce((n,x)=>{const N=T(x);return{...n,...N}},{}),{data:u,isLoading:f,refetch:y}=A({...d,...S}),k=p.useMemo(()=>[{accessorFn:n=>n.ssn,id:h.ssn,header:()=>o.jsx("span",{children:e(`entities.${[h.ssn]}`)}),cell:n=>n.getValue(),isSearchable:!0,isSortable:!0},{accessorFn:n=>n.numberOfCases,id:h.numberOfCases,header:()=>o.jsx("span",{children:e(`entities.${[h.numberOfCases]}`)}),cell:n=>n.getValue(),isSortable:!0}],[]);return f?o.jsx(o.Fragment,{children:"Loading..."}):o.jsx(O,{columns:k,data:(b=u==null?void 0:u.data.data)==null?void 0:b.ssn_numbers,hasSearch:!0,sort:a,sortBy:r,totalNumber:(m=u==null?void 0:u.data.data)==null?void 0:m.meta.total_number,page:c,size:l,borderKeyword:"type",updateState:t,refetch:y,mapBorderColors:Q})},H=(e,a)=>{var r;switch(a.type){case i.sortable:return{...e,sortable:a.payload};case i.pageable:return{...e,pageable:a.payload};case i.searchable:const{key:c,value:l}=a.payload,s=(r=e.searchable)==null?void 0:r.map(t=>t.key===c?{...t,value:l}:t);return e.searchable.some(t=>t.key===c)||s.push({key:c,value:l}),{...e,searchable:s};default:return e}},_={sortable:{sort:"",sortBy:""},pageable:{page:1,size:25,totalNumber:null},searchable:[]},v=p.createContext({state:_,dispatch:()=>null}),G=({children:e})=>{const[a,r]=p.useReducer(H,_);return o.jsx(v.Provider,{value:{state:a,dispatch:r},children:e})},K=()=>p.useContext(v),W=({case_count:e,package_name:a})=>({numberOfCases:e,packageName:a}),J=async e=>{var t;const{sortBy:a="created_at",sort:r="asc",page:c=1,size:l=10}=e;let s;try{s=await B({method:"get",url:"api/packages-list",params:{...e,sortBy:a===""?"created_at":P(a),sort:r===""?"asc":r,page:c,size:l},withCredentials:!0}),(t=s.data.data)!=null&&t.packages&&(s.data.data.packages=s.data.data.packages.map(d=>W(d)))}catch{s={data:{error:500,message:"Connection problem"}}}return s},q=e=>j(["packagesList",e],()=>J(e),{keepPreviousData:!0,refetchOnMount:!1,refetchOnWindowFocus:!1}),I=()=>"#6b7280",g={packageName:"packageName",numberOfCases:"numberOfCases"},U=()=>{var b,m;const{t:e}=C(),{state:{sortable:{sort:a,sortBy:r},pageable:{page:c,size:l},searchable:s},dispatch:t}=K();let d={page:c,size:l,sort:a,sortBy:r};const S=s.reduce((n,x)=>{const N=T(x);return{...n,...N}},{}),{data:u,isLoading:f,refetch:y}=q({...d,...S}),k=p.useMemo(()=>[{accessorFn:n=>n.packageName,id:g.packageName,header:()=>o.jsx("span",{children:e(`entities.${[g.packageName]}`)}),cell:n=>n.getValue(),isSearchable:!0,isSortable:!0},{accessorFn:n=>n.numberOfCases,id:g.numberOfCases,header:()=>o.jsx("span",{children:e(`entities.${[g.numberOfCases]}`)}),cell:n=>n.getValue(),isSortable:!0}],[]);return f?o.jsx(o.Fragment,{children:"Loading..."}):o.jsx(O,{columns:k,data:(b=u==null?void 0:u.data.data)==null?void 0:b.packages,hasSearch:!0,sort:a,sortBy:r,totalNumber:(m=u==null?void 0:u.data.data)==null?void 0:m.meta.total_number,page:c,size:l,borderKeyword:"type",updateState:t,refetch:y,mapBorderColors:I})},ee=e=>o.jsx(F,{children:o.jsx(p.Suspense,{fallback:"Loading....",children:o.jsxs(R,{className:"flex flex-col lg:flex-row gap-4",children:[o.jsx(D,{children:o.jsx(V,{})}),o.jsx(G,{children:o.jsx(U,{})})]})})});export{ee as SSNNumbersAndPackages};
