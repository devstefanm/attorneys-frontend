import{g as et,e as tt,s as ye,f as oe,_ as re,h as _e,i as at,k as st,r as H,m as it,n as nt,j as a,o as ot,p as rt,c as ke,q as ce,a as Q,t as Y,v as m,w as s,B as P,D as Be,I as Oe,E as U,x as ge,y as Ce,z as lt}from"./index-519f3ca8.js";import{S as ct,u as X,a as K,c as ze,t as le,r as ne,m as Te,T as dt,R as ut,A as pt,d as je,C as he,G as A,D as Me,L as Ve,b as Le,e as Ie,F as ue,f as Ne,M as Re,g as G,h as qe,i as mt,j as ht,k as yt,l as gt,n as bt}from"./ConfirmationDialog-13a70a71.js";import{s as q,T as Z,u as pe,S as ft,B as de}from"./setupAxios-8cb3d16d.js";import{u as Pe}from"./useGetCitiesNamesQuery-62190486.js";import{A as we}from"./Autocomplete-41d87e66.js";import{F as Qe,I as xt,a as Ct}from"./FileUpload-3f4194c2.js";function kt(e){return tt("MuiSwitch",e)}const jt=et("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]),R=jt,Nt=["className","color","edge","size","sx"],wt=e=>{const{classes:t,edge:i,size:n,color:o,checked:d,disabled:l}=e,u={root:["root",i&&`edge${oe(i)}`,`size${oe(n)}`],switchBase:["switchBase",`color${oe(o)}`,d&&"checked",l&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},y=rt(u,kt,t);return re({},t,y)},St=ye("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,i.edge&&t[`edge${oe(i.edge)}`],t[`size${oe(i.size)}`]]}})(({ownerState:e})=>re({display:"inline-flex",width:34+12*2,height:14+12*2,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"}},e.edge==="start"&&{marginLeft:-8},e.edge==="end"&&{marginRight:-8},e.size==="small"&&{width:40,height:24,padding:7,[`& .${R.thumb}`]:{width:16,height:16},[`& .${R.switchBase}`]:{padding:4,[`&.${R.checked}`]:{transform:"translateX(16px)"}}})),vt=ye(ct,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.switchBase,{[`& .${R.input}`]:t.input},i.color!=="default"&&t[`color${oe(i.color)}`]]}})(({theme:e})=>({position:"absolute",top:0,left:0,zIndex:1,color:e.vars?e.vars.palette.Switch.defaultColor:`${e.palette.mode==="light"?e.palette.common.white:e.palette.grey[300]}`,transition:e.transitions.create(["left","transform"],{duration:e.transitions.duration.shortest}),[`&.${R.checked}`]:{transform:"translateX(20px)"},[`&.${R.disabled}`]:{color:e.vars?e.vars.palette.Switch.defaultDisabledColor:`${e.palette.mode==="light"?e.palette.grey[100]:e.palette.grey[600]}`},[`&.${R.checked} + .${R.track}`]:{opacity:.5},[`&.${R.disabled} + .${R.track}`]:{opacity:e.vars?e.vars.opacity.switchTrackDisabled:`${e.palette.mode==="light"?.12:.2}`},[`& .${R.input}`]:{left:"-100%",width:"300%"}}),({theme:e,ownerState:t})=>re({"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:_e(e.palette.action.active,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},t.color!=="default"&&{[`&.${R.checked}`]:{color:(e.vars||e).palette[t.color].main,"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette[t.color].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:_e(e.palette[t.color].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${R.disabled}`]:{color:e.vars?e.vars.palette.Switch[`${t.color}DisabledColor`]:`${e.palette.mode==="light"?at(e.palette[t.color].main,.62):st(e.palette[t.color].main,.55)}`}},[`&.${R.checked} + .${R.track}`]:{backgroundColor:(e.vars||e).palette[t.color].main}})),Wt=ye("span",{name:"MuiSwitch",slot:"Track",overridesResolver:(e,t)=>t.track})(({theme:e})=>({height:"100%",width:"100%",borderRadius:14/2,zIndex:-1,transition:e.transitions.create(["opacity","background-color"],{duration:e.transitions.duration.shortest}),backgroundColor:e.vars?e.vars.palette.common.onBackground:`${e.palette.mode==="light"?e.palette.common.black:e.palette.common.white}`,opacity:e.vars?e.vars.opacity.switchTrack:`${e.palette.mode==="light"?.38:.3}`})),Ft=ye("span",{name:"MuiSwitch",slot:"Thumb",overridesResolver:(e,t)=>t.thumb})(({theme:e})=>({boxShadow:(e.vars||e).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"})),$t=H.forwardRef(function(t,i){const n=it({props:t,name:"MuiSwitch"}),{className:o,color:d="primary",edge:l=!1,size:u="medium",sx:y}=n,g=nt(n,Nt),C=re({},n,{color:d,edge:l,size:u}),k=wt(C),W=a.jsx(Ft,{className:k.thumb,ownerState:C});return a.jsxs(St,{className:ot(k.root,o),sx:y,ownerState:C,children:[a.jsx(vt,re({type:"checkbox",icon:W,checkedIcon:W,ref:i,ownerState:C},g,{classes:re({},k,{root:k.switchBase})})),a.jsx(Wt,{className:k.track,ownerState:C})]})}),Ue=$t,Et=ke(a.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8 0-1.85.63-3.55 1.69-4.9L16.9 18.31C15.55 19.37 13.85 20 12 20zm6.31-3.1L7.1 5.69C8.45 4.63 10.15 4 12 4c4.42 0 8 3.58 8 8 0 1.85-.63 3.55-1.69 4.9z"}),"DoNotDisturb"),_t=ke(a.jsx("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"}),"GetApp"),Ot=ke(a.jsx("path",{d:"M22 5.18 10.59 16.6l-4.24-4.24 1.41-1.41 2.83 2.83 10-10L22 5.18zm-2.21 5.04c.13.57.21 1.17.21 1.78 0 4.42-3.58 8-8 8s-8-3.58-8-8 3.58-8 8-8c1.58 0 3.04.46 4.28 1.25l1.44-1.44C16.1 2.67 14.13 2 12 2 6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10c0-1.19-.22-2.33-.6-3.39l-1.61 1.61z"}),"TaskAlt"),Dt=({id:e,first_name:t,last_name:i,case_number:n,contract_number:o,jmbg:d,pib:l,name:u,executors:y,lawyer_first_name:g,lawyer_last_name:C,lawyer_office_name:k,state:W,ssn:v,package:j,business_numbers:F,cession:N,principal:r,interest:c})=>({id:e,name:u?X(u):`${t?X(t):""} ${i?X(i):""}`,jmbg_pib:d||""||l||"",caseNumber:n,contractNumber:o,executors:y,lawyer:k?`${g?X(g):""} ${C?X(C):""} (${X(k)})`:`${g?X(g):""} ${C?X(C):""}`,ssn:v??"",package:j??"",state:W,businessNumbers:F,cession:N?a.jsx(Ot,{color:"success"}):a.jsx(Et,{color:"error"}),principal:r,interest:c}),At=async e=>{var y;const{sortBy:t="created_at",sort:i="desc",page:n=1,size:o=25,filter:d="active",clientsFilter:l=9999}=e;let u;try{u=await q({method:"get",url:"api/cases-list",params:{...e,sortBy:t===""?"created_at":ze(t),sort:i===""?"asc":i,page:n,size:o,filter:d===ce.all?"":d,clientsFilter:l===9999?"":l},withCredentials:!0}),(y=u.data.data)!=null&&y.cases&&(u.data.data.cases=u.data.data.cases.map(g=>Dt(g)))}catch{u={data:{error:500,message:"Connection problem"}}}return u},Bt=e=>K(["casesList",e],()=>At(e),{keepPreviousData:!0,refetchOnMount:!1,refetchOnWindowFocus:!1}),zt=e=>{switch(e){case"active":return"#22c55e";case"closed":return"#9ca3af";default:return""}},ee=e=>{const{id:t,first_name:i,last_name:n,name:o,package_name:d,ssn:l}=e;let u="";return o&&(u=o),i&&(u=`${i} ${n??""}`),d&&(u=d),l&&(u=l),{id:t,name:u}},Tt=({address:e,businessNumbers:t,caseNumber:i,cession:n,city:o,client:d,closingDate:l,contractNumber:u,court:y,email:g,employed:C,employer:k,executors:W,firstName:v,interest:j,jmbg:F,lastName:N,lawyer:r,legalEntity:c,name:h,package:x,phoneNumbers:f,pib:p,principal:w,ssnNumber:S,zipCode:$,status:E,oldPayment:_,ourTaxes:B,warningPrice:O,enteringDate:D,lawyerHandOverDate:V,comment:z,limitationObjection:L})=>{let b=null,T=null,te=null,ae=[],se=null,ie=null,I=null,be=null,ve=null,fe=null,xe=null;typeof o!="string"&&(b=o.id),typeof d!="string"&&(T=d.id),typeof y!="string"&&(te=y.id),typeof W!==null&&(ae=W.map(J=>J.id).filter(J=>J!==null)),typeof r!="string"&&(se=r.id),typeof S!="string"&&(ie=S.id),typeof x!="string"&&(I=x.id),typeof k!="string"&&(ve=k==null?void 0:k.id),l&&(be=le(l)),D&&(fe=le(D)),V&&(xe=le(V));const We=i,Fe=u,$e=f.filter(J=>J.length>5),Ee=t.filter(J=>J.length>0);return c?{name:h,pib:p,address:e,cession:n,email:g,zip_code:$,case_number:We,contract_number:Fe,principal:Number(w),interest:Number(j),city_id:b,client_id:T,court_id:te,executor_ids:ae,lawyer_id:se,ssn_number_id:ie,package_id:I,phone_numbers:$e,business_numbers:Ee,closing_date:be,status:E,old_payment:_?Number(_):null,our_taxes:B?Number(B):null,warning_price:O?Number(O):null,entering_date:fe,lawyer_hand_over_date:xe,comment:z,limitation_objection:L}:{first_name:v,last_name:N,employed:C,employer_id:ve,jmbg:F,address:e,cession:n,email:g,zip_code:$,case_number:We,contract_number:Fe,principal:Number(w),interest:Number(j),city_id:b,client_id:T,court_id:te,executor_ids:ae,lawyer_id:se,ssn_number_id:ie,package_id:I,phone_numbers:$e,business_numbers:Ee,closing_date:be,status:E,old_payment:_?Number(_):null,our_taxes:B?Number(B):null,warning_price:O?Number(O):null,entering_date:fe,lawyer_hand_over_date:xe,comment:z,limitation_objection:L}},Mt=e=>{const{is_legal:t,first_name:i,last_name:n,jmbg:o,name:d,pib:l,employed:u,employer:y,executors:g,cession:C,address:k,email:W,zip_code:v,city:j,case_number:F,contract_number:N,closing_date:r,business_numbers:c,lawyer:h,client:x,court:f,ssn_number:p,package:w,principal:S,interest:$,phone_numbers:E,state:_,status:B,old_payment:O,our_taxes:D,warning_price:V,entering_date:z,lawyer_hand_over_date:L,comment:b,limitation_objection:T,fee:te,legal_fee:ae,payment:se,withdrawal:ie}=e;return t?{address:k,email:W,cession:C,name:d,pib:l,legalEntity:t,executors:g&&g.length>0?g.map(I=>({id:I.id,name:`${I.first_name} ${I.last_name}`})):[{id:null,name:""}],phoneNumbers:E&&E.length>0?E:[""],zipCode:v,city:j!=null&&j.id?{id:j.id,name:j.name}:"",caseNumber:F,contractNumber:N,closingDate:r?ne(r):null,businessNumbers:c&&c.length>0?c.map(I=>I.number):[""],lawyer:h!=null&&h.id?{id:h.id,name:`${h.first_name} ${h.last_name}`}:"",client:x!=null&&x.id?{id:x.id,name:x.name}:"",court:f!=null&&f.id?{id:f.id,name:f.name}:"",ssnNumber:p!=null&&p.id?{id:p.id,name:String(p.ssn)}:"",package:w!=null&&w.id?{id:w.id,name:w.package_name}:"",principal:S.toString(),interest:$.toString(),state:_||"active",status:B,comment:b,oldPayment:O?O.toString():"",ourTaxes:D?D.toString():"",warningPrice:V?V.toString():"",enteringDate:z?ne(z):null,lawyerHandOverDate:L?ne(L):null,limitationObjection:T||!1,transactions:{fees:te||null,legal_fees:ae||null,payments:se||null,withdrawals:ie||null}}:{address:k,email:W,cession:C,jmbg:o,employed:u,legalEntity:t,firstName:i,lastName:n,employer:y!=null&&y.id?{id:y.id,name:y.name}:"",executors:g&&g.length>0?g.map(I=>({id:I.id,name:`${I.first_name} ${I.last_name}`})):[{id:null,name:""}],phoneNumbers:E&&E.length>0?E:[""],zipCode:v,city:j!=null&&j.id?{id:j.id,name:j.name}:"",caseNumber:F,contractNumber:N,closingDate:r?ne(r):null,businessNumbers:c&&c.length>0?c.map(I=>I.number):[""],lawyer:h!=null&&h.id?{id:h.id,name:`${h.first_name} ${h.last_name}`}:"",client:x!=null&&x.id?{id:x.id,name:x.name}:"",court:f!=null&&f.id?{id:f.id,name:f.name}:"",ssnNumber:p!=null&&p.id?{id:p.id,name:String(p.ssn)}:"",package:w!=null&&w.id?{id:w.id,name:w.package_name}:"",principal:S.toString(),interest:$.toString(),state:_||"active",status:B,comment:b,oldPayment:O?O.toString():"",ourTaxes:D?D.toString():"",warningPrice:V?V.toString():"",enteringDate:z?ne(z):null,lawyerHandOverDate:L?ne(L):null,limitationObjection:T||!1,transactions:{fees:te||null,legal_fees:ae||null,payments:se||null,withdrawals:ie||null}}},Vt=({address:e,businessNumbers:t,caseNumber:i,cession:n,city:o,client:d,closingDate:l,contractNumber:u,court:y,email:g,employed:C,employer:k,executors:W,firstName:v,interest:j,jmbg:F,lastName:N,lawyer:r,name:c,package:h,phoneNumbers:x,pib:f,principal:p,ssnNumber:w,zipCode:S,state:$,status:E,oldPayment:_,ourTaxes:B,warningPrice:O,enteringDate:D,lawyerHandOverDate:V,comment:z,limitationObjection:L})=>{const b={};return o!==void 0&&(typeof o!="string"?b.city_id=o.id||null:o===""&&(b.city_id=null)),d!==void 0&&(typeof d!="string"?b.client_id=d.id||null:d===""&&(b.client_id=null)),y!==void 0&&(typeof y!="string"?b.court_id=y.id||null:y===""&&(b.court_id=null)),W!==void 0&&(W.length>0?b.executor_ids=W.filter(T=>T.id!==0&&T.id!==null).map(T=>T.id):b.executor_ids=[]),r!==void 0&&(typeof r!="string"?b.lawyer_id=r.id||null:r===""&&(b.lawyer_id=null)),w!==void 0&&(typeof w!="string"?b.ssn_number_id=w.id||null:w===""&&(b.ssn_number_id=null)),h!==void 0&&(typeof h!="string"?b.package_id=h.id||null:h===""&&(b.package_id=null)),k!==void 0&&(typeof k!="string"?b.employer_id=k.id||null:k===""&&(b.employer_id=null)),l!==void 0&&(b.closing_date=l?le(l):null),D!==void 0&&(b.entering_date=D?le(D):null),V!==void 0&&(b.lawyer_hand_over_date=V?le(V):null),i!==void 0&&(b.case_number=i||null),u!==void 0&&(b.contract_number=u||null),x!==void 0&&(x.length>0?b.phone_numbers=x==null?void 0:x.filter(T=>T.length>5):b.phone_numbers=[""]),t!==void 0&&(t.length>0?b.business_numbers=t==null?void 0:t.filter(T=>T.length>0):b.business_numbers=[""]),c!==void 0&&(b.name=c||null),f!==void 0&&(b.pib=f||null),v!==void 0&&(b.first_name=v||null),N!==void 0&&(b.last_name=N||null),C!==void 0&&(b.employed=C),F!==void 0&&(b.jmbg=F||null),$!==void 0&&(b.state=$||null),z!==void 0&&(b.comment=z||null),E!==void 0&&(b.status=E||null),L!==void 0&&(b.limitation_objection=L||null),e!==void 0&&(b.address=e||null),n!==void 0&&(b.cession=n),g!==void 0&&(b.email=g||null),S!==void 0&&(b.zip_code=S||null),p!==void 0&&(b.principal=Number(p)||null),j!==void 0&&(b.interest=Number(j)||null),_!==void 0&&(b.old_payment=Number(_)||null),B!==void 0&&(b.our_taxes=Number(B)||null),O!==void 0&&(b.warning_price=Number(O)||null),b},Lt=({id:e,name:t})=>({id:e,label:t,value:e}),me=e=>Object.keys(e).filter(t=>e[t]===!0).map(t=>ze(t)),It=(e,t)=>{const i=parseFloat(e);if(isNaN(i))return 0;let n=i;return t&&(n=i+(t.fees||0)+(t.legal_fees||0)-(t.withdrawals||0)-(t.payments||0)),parseFloat(n.toFixed(2))},M={name:"name",jmbg_pib:"jmbg_pib",caseNumber:"caseNumber",contractNumber:"contractNumber",cession:"cession",executors:"executors",lawyer:"lawyer",ssn:"ssn",package:"package",state:"state",businessNumbers:"businessNumbers",principal:"principal",interest:"interest"},Rt=()=>{var N,r;const{t:e}=Q(),{state:{sortable:{sort:t,sortBy:i},pageable:{page:n,size:o},searchable:d,filterable:l,filterableByClient:u},dispatch:y}=Y();let g={page:n,size:o,sort:t,sortBy:i};const C=d.reduce((c,h)=>{const x=Te(h);return{...c,...x}},{}),{data:k,isLoading:W,refetch:v}=Bt({...g,...C,filter:l,clientsFilter:u}),j=c=>{const{id:h}=c.original;h&&(y({type:m.editCaseId,payload:h}),y({type:m.editCaseModalOpen,payload:!0}))},F=H.useMemo(()=>[{accessorFn:c=>c.name,id:M.name,header:()=>a.jsx("span",{children:e(`entities.${[M.name]}`)}),cell:c=>c.getValue(),isSearchable:!0,isSortable:!0},{accessorFn:c=>c.jmbg_pib,id:M.jmbg_pib,header:()=>a.jsx("span",{children:e(`entities.${[M.jmbg_pib]}`)}),cell:c=>c.getValue(),isSearchable:!0,isSortable:!0},{accessorFn:c=>c.caseNumber,id:M.caseNumber,header:()=>a.jsx("span",{children:e(`entities.${[M.caseNumber]}`)}),cell:c=>c.getValue(),isSearchable:!0,isSortable:!0},{accessorFn:c=>c.contractNumber,id:M.contractNumber,header:()=>a.jsx("span",{children:e(`entities.${[M.contractNumber]}`)}),cell:c=>c.getValue(),isSearchable:!0,isSortable:!0},{accessorFn:c=>c.businessNumbers,id:M.businessNumbers,header:()=>a.jsx("span",{children:e(`entities.${[M.businessNumbers]}`)}),cell:c=>c.getValue(),isSearchable:!0,isSortable:!0},{accessorFn:c=>c.executors,id:M.executors,header:()=>a.jsx("span",{children:e(`entities.${[M.executors]}`)}),cell:c=>c.getValue(),isSearchable:!0,isSortable:!0},{accessorFn:c=>c.lawyer,id:M.lawyer,header:()=>a.jsx("span",{children:e(`entities.${[M.lawyer]}`)}),cell:c=>c.getValue(),isSearchable:!0,isSortable:!0},{accessorFn:c=>c.ssn,id:M.ssn,header:()=>a.jsx("span",{children:e(`entities.${[M.ssn]}`)}),cell:c=>c.getValue(),isSearchable:!0,isSortable:!0},{accessorFn:c=>c.package,id:M.package,header:()=>a.jsx("span",{children:e(`entities.${[M.package]}`)}),cell:c=>c.getValue(),isSearchable:!0,isSortable:!0}],[]);return W?a.jsx(a.Fragment,{children:"Loading..."}):a.jsx(dt,{columns:F,data:(N=k==null?void 0:k.data.data)==null?void 0:N.cases,hasSearch:!0,sort:t,sortBy:i,totalNumber:(r=k==null?void 0:k.data.data)==null?void 0:r.meta.total_number,page:n,size:o,borderKeyword:"state",updateState:y,refetch:v,mapBorderColors:zt,onRowClick:j})},qt=({employersOptions:e,lawyersOptions:t,clientsOptions:i,courtsOptions:n,ssnNumbersOptions:o,packagesOptions:d,citiesOptions:l,executorsOptions:u})=>[{name:"legalEntity",type:s.toggle,options:[!0,!1],gridClassName:"flex justify-center",labelPlacement:"top"},{name:"firstName",required:!0,type:s.input,gridWidth:6,condition:!1},{name:"lastName",required:!0,type:s.input,gridWidth:6,condition:!1},{name:"jmbg",required:!0,type:s.input,gridWidth:12,condition:!1},{name:"name",required:!0,type:s.input,gridWidth:6,condition:!0},{name:"pib",type:s.input,gridWidth:6,condition:!0},{name:"employed",type:s.checkbox,gridWidth:6,condition:!1},{name:"employer",type:s.autocomplete,gridWidth:12,condition:!1,secondCondition:!0,options:e},{name:"cession",type:s.checkbox,gridWidth:6},{name:"executors",subfieldName:"executor",type:s.dynamicAutocompletes,gridWidth:12,options:u},{name:"principal",type:s.input,gridWidth:6,format:/^[\d 0-9.]{0,24}$/},{name:"interest",type:s.input,gridWidth:6,format:/^[\d 0-9.]{0,24}$/},{name:"businessNumbers",subfieldName:"businessNumber",type:s.dynamicInputs,gridWidth:12},{name:"caseNumber",required:!0,type:s.input,gridWidth:6},{name:"contractNumber",required:!0,type:s.input,gridWidth:6},{name:"ssnNumber",type:s.autocomplete,gridWidth:6,options:o},{name:"package",type:s.autocomplete,gridWidth:6,options:d},{name:"phoneNumbers",subfieldName:"phoneNumber",type:s.dynamicInputs,gridWidth:12},{name:"address",type:s.input,gridWidth:6},{name:"email",type:s.input,gridWidth:6},{name:"zipCode",type:s.input,gridWidth:6,format:/^\d{6}$/},{name:"city",type:s.autocomplete,gridWidth:6,options:l},{name:"lawyer",type:s.autocomplete,gridWidth:6,options:t},{name:"court",type:s.autocomplete,gridWidth:6,options:n},{name:"client",required:!0,type:s.autocomplete,gridWidth:6,options:i},{name:"enteringDate",type:s.datepicker,gridWidth:6},{name:"lawyerHandOverDate",type:s.datepicker,gridWidth:6},{name:"closingDate",type:s.datepicker,gridWidth:6},{name:"status",type:s.input,gridWidth:6},{name:"oldPayment",type:s.input,gridWidth:6,format:/^[\d 0-9.]{0,24}$/},{name:"ourTaxes",type:s.input,gridWidth:6,format:/^[\d 0-9.]{0,24}$/},{name:"warningPrice",type:s.input,gridWidth:6,format:/^[\d 0-9.]{0,24}$/},{name:"comment",type:s.textArea,gridWidth:6},{name:"limitationObjection",type:s.checkbox,gridWidth:6}],Pt=async e=>{let t;try{t=await q({method:"get",url:"api/clients-names",params:{...e},withCredentials:!0})}catch{t={data:{error:500,message:"Connection problem"}}}return t},Se=e=>K(["clientsNames",e],()=>Pt(e),{keepPreviousData:!0,refetchOnMount:!1,refetchOnWindowFocus:!1,select(t){return t.data.data}}),Qt=async e=>{let t;try{t=await q({method:"get",url:"api/courts-names",params:{...e},withCredentials:!0})}catch{t={data:{error:500,message:"Connection problem"}}}return t},Ye=e=>K(["courtsNames",e],()=>Qt(e),{keepPreviousData:!0,refetchOnMount:!1,refetchOnWindowFocus:!1,select(t){return t.data.data}}),Ut=async e=>{let t;try{t=await q({method:"get",url:"api/executors-names",params:{...e},withCredentials:!0})}catch{t={data:{error:500,message:"Connection problem"}}}return t},Ge=e=>K(["executorsNames",e],()=>Ut(e),{keepPreviousData:!0,refetchOnMount:!1,refetchOnWindowFocus:!1,select(t){return t.data.data}}),Yt=async e=>{let t;try{t=await q({method:"get",url:"api/lawyers-names",params:{...e},withCredentials:!0})}catch{t={data:{error:500,message:"Connection problem"}}}return t},He=e=>K(["lawyersNames",e],()=>Yt(e),{keepPreviousData:!0,refetchOnMount:!1,refetchOnWindowFocus:!1,select(t){return t.data.data}}),Gt=async e=>{let t;try{t=await q({method:"get",url:"api/packages-names",params:{...e},withCredentials:!0})}catch{t={data:{error:500,message:"Connection problem"}}}return t},Ke=e=>K(["packagesNames",e],()=>Gt(e),{keepPreviousData:!0,refetchOnMount:!1,refetchOnWindowFocus:!1,select(t){return t.data.data}}),Ht=async e=>{let t;try{t=await q({method:"get",url:"api/ssn-numbers",params:{...e},withCredentials:!0})}catch{t={data:{error:500,message:"Connection problem"}}}return t},Xe=e=>K(["ssnNumbers",e],()=>Ht(e),{keepPreviousData:!0,refetchOnMount:!1,refetchOnWindowFocus:!1,select(t){return t.data.data}}),Kt=async e=>{let t;try{t=await q({method:"get",url:"api/employers-names",params:{...e},withCredentials:!0})}catch{t={data:{error:500,message:"Connection problem"}}}return t},Je=e=>K(["employersNames",e],()=>Kt(e),{keepPreviousData:!0,refetchOnMount:!1,refetchOnWindowFocus:!1,select(t){return t.data.data}}),Ze=({label:e,values:t,autocompleteProps:i,inputProps:n,options:o,name:d,actionType:l,limit:u,onValuesChange:y,updateState:g})=>{const[C,k]=H.useState(t??[{id:null,name:""}]);H.useEffect(()=>{t&&k(t)},[t]);const W=()=>{if(C.length<6){const r=[...C,{id:null,name:""}];k(r),y&&y(r)}},v=r=>{const c=[...C];c.splice(r,1),k(c),y&&y(c)},j=(r,c)=>{const h=[...C];h[r]=c,k(h),y&&y(h)},F=(r,c)=>{const{value:h}=r.target;je(f=>g&&g({type:l,payload:{inputName:d,inputValue:f}}),300)(h),h===""&&j(c,{id:0,name:h})},N=(r,c)=>{var h;if(((h=r==null?void 0:r.currentTarget)==null?void 0:h.ariaLabel)==="Clear")return j(c,{id:0,name:""});if(r!=null&&r.target&&"value"in r.target){const{value:x}=r.target;if(x==="")return j(c,{id:0,name:""})}};return a.jsxs(P,{className:"my-3",children:[a.jsx(Be,{textAlign:"left",children:e}),C.map((r,c)=>a.jsxs(P,{className:"flex my-3",children:[a.jsx(we,{...i,clearIcon:!1,isOptionEqualToValue:(h,x)=>h.id===x.id,options:o??[],getOptionLabel:h=>ee(h).name,onBlur:()=>g&&g({type:l,payload:{inputName:d,inputValue:""}}),value:r!=null&&r.id?r:null,onChange:(h,x)=>j(c,x),onInputChange:h=>N(h,c),renderInput:h=>a.jsx(Z,{...h,...n,label:`${n==null?void 0:n.label} ${c+1}`,onBlur:()=>g&&g({type:l,payload:{inputName:d,inputValue:""}}),onChange:x=>F(x,c)})}),c>0?a.jsx(Oe,{onClick:()=>v(c),children:a.jsx(ut,{})}):a.jsx(P,{className:"w-[42px]"})]},c)),C.length<(u||4)&&a.jsx(P,{className:"flex justify-center",children:a.jsx(Oe,{onClick:W,children:a.jsx(pt,{})})})]})},Xt=()=>{const{t:e}=Q(),{state:{isLegalEntity:t,addCaseForm:i,addCaseAutocompleteValues:n},dispatch:o}=Y(),{data:d}=Pe({search:n.city}),{data:l}=Se({search:n.client}),{data:u}=Ye({search:n.court}),{data:y}=Ge({search:n.executors}),{data:g}=He({search:n.lawyer}),{data:C}=Ke({search:n.package}),{data:k}=Xe({search:n.ssnNumber}),{data:W}=Je({search:n.employer}),v=(N,r,c)=>(h,x)=>{switch(r){case s.toggle:N==="legalEntity"?(o({type:m.isLegalEntity,payload:!t}),o({type:m.addCaseForm,payload:{name:N,fieldValue:x}})):o({type:m.addCaseForm,payload:{name:N,fieldValue:x}});break;case s.input:case s.textArea:const{value:f}=h==null?void 0:h.target;let p=f;c?p.match(c)&&o({type:m.addCaseForm,payload:{name:N,fieldValue:p}}):o({type:m.addCaseForm,payload:{name:N,fieldValue:p}});break;case s.checkbox:o({type:m.addCaseForm,payload:{name:N,fieldValue:x}});break;case s.datepicker:o({type:m.addCaseForm,payload:{name:N,fieldValue:h}});break;case s.dynamicInputs:o({type:m.addCaseForm,payload:{name:N,fieldValue:h}});break;case s.autocomplete:o({type:m.addCaseForm,payload:{name:N,fieldValue:x?ee(x):""}});break;case s.dynamicAutocompletes:o({type:m.addCaseForm,payload:{name:N,fieldValue:h.map(w=>ee(w))}});break}},j=()=>console.log("Submitted"),F=N=>{var B;const{name:r,type:c,gridClassName:h,formFieldClassName:x,gridWidth:f,labelPlacement:p,options:w,size:S,subfieldName:$,format:E,required:_}=N;switch(c){case s.toggle:return a.jsx(A,{className:h,item:!0,xs:f||12,children:a.jsx(ue,{required:_,className:x,value:t,onChange:v(r,c),control:a.jsx(Ue,{color:"primary"}),label:e(`entities.${r}`),labelPlacement:p})},r);case s.checkbox:return a.jsx(A,{className:h,item:!0,xs:f||12,children:a.jsx(ue,{required:_,control:a.jsx(Ne,{className:x,name:r,size:S??"small",checked:i[r],onChange:v(r,c)}),label:e(`entities.${r}`)})},r);case s.input:return a.jsx(A,{className:h,item:!0,xs:f||12,children:a.jsx(Z,{required:_,fullWidth:!0,className:x,size:S??"small",label:e(`entities.${r}`),name:r,value:i[r],onChange:v(r,c,E)})},r);case s.autocomplete:return a.jsx(A,{className:h,item:!0,xs:f||12,children:a.jsx(we,{isOptionEqualToValue:(O,D)=>O.id===D.id,fullWidth:!0,clearIcon:!1,className:x,options:w??[],getOptionLabel:O=>ee(O).name,size:S??"small",value:(B=i[r])!=null&&B.id?i[r]:null,onChange:v(r,c),renderInput:O=>a.jsx(Z,{...O,required:_,label:e(`entities.${r}`),onBlur:()=>o({type:m.addCaseAutocompleteValues,payload:{inputName:r,inputValue:""}}),onChange:je(D=>o({type:m.addCaseAutocompleteValues,payload:{inputName:r,inputValue:D.target.value}}),300)})})},r);case s.datepicker:return a.jsx(A,{className:h,item:!0,xs:f||12,children:a.jsx(Ve,{dateAdapter:Le,children:a.jsx(Ie,{localeText:{clearButtonLabel:e("clear")},label:e(`entities.${r}`),value:i[r],className:x,slotProps:{textField:{size:"small",fullWidth:!0,required:_},actionBar:{actions:["clear"]}},format:"DD. MM. YYYY",onChange:v(r,c)})})},r);case s.dynamicInputs:return a.jsx(A,{className:h,item:!0,xs:f||12,children:a.jsx(Me,{limit:r==="phoneNumbers"?4:2,label:e(`entities.${r}`),inputProps:{label:e(`entities.${$}`),size:"small",fullWidth:!0},values:i[r],onValuesChange:v(r,c)})},r);case s.dynamicAutocompletes:return a.jsx(A,{className:h,item:!0,xs:f||12,children:a.jsx(Ze,{limit:r==="phoneNumbers"?4:2,options:w,label:e(`entities.${r}`),autocompleteProps:{size:"small",fullWidth:!0},inputProps:{label:e(`entities.${$}`)},value:i[r],onValuesChange:v(r,c),actionType:m.addCaseAutocompleteValues,name:r,updateState:o})},r);case s.textArea:return a.jsx(A,{className:h,item:!0,xs:f||12,children:a.jsx(Z,{required:_,fullWidth:!0,multiline:!0,className:x,size:S??"small",label:e(`entities.${r}`),name:r,rows:2,value:i[r],onChange:v(r,c,E)})},r);default:return""}};return a.jsx(U,{children:a.jsx(he,{children:a.jsx("form",{onSubmit:j,children:a.jsx(A,{container:!0,spacing:2,children:qt({citiesOptions:d,clientsOptions:l,courtsOptions:u,executorsOptions:y,lawyersOptions:g,packagesOptions:C,ssnNumbersOptions:k,employersOptions:W}).map(N=>(typeof N.condition!="boolean"||N.condition===t)&&(typeof N.secondCondition!="boolean"||N.secondCondition===i.employed)&&F(N))})})})})},Jt=async e=>{let t;return t=await q({method:"post",url:"api/cases",data:e,withCredentials:!0}),t},Zt=(e,t)=>{const i=ge();return pe(n=>Jt(n),{onSuccess:n=>(n.data.error||(t({type:m.resetCaseFormData}),t({type:m.openSuccessSnackbar,payload:!0}),e(),i.invalidateQueries({queryKey:["casesList"]})),n.data.message),onError:n=>{var o,d;return console.error(n),t({type:m.openErrorSnackbar,payload:!0}),{error:n,message:((d=(o=n==null?void 0:n.response)==null?void 0:o.data)==null?void 0:d.message)||"Error has occured"}}})},ea=e=>{var h,x,f,p;const{open:t,onClose:i}=e,{t:n}=Q(),{state:{addCaseForm:o,openSuccessSnackbar:d,openErrorSnackbar:l,addCaseModalOpen:u,editCaseModalOpen:y,exportCasesDialogOpen:g,importCasesDialogOpen:C},dispatch:k}=Y(),{mutate:W,isLoading:v,data:j,error:F,isSuccess:N,isError:r,reset:c}=Zt(i,k);return H.useEffect(()=>{(u||y||g||C)&&N&&c()},[u,y,g,C]),a.jsxs(U,{children:[a.jsx(Re,{open:t,header:n("entities.addNewCase"),children:a.jsx(Xt,{}),onClose:i,hasActionButton:!0,actionButtonText:"submit",hasCancelButton:!0,onSubmit:()=>W(Tt(o)),isLoading:v,hasCloseIconButton:!0}),N&&(j!=null&&j.data.message)?a.jsx(G,{open:d,onClose:()=>k({type:m.openSuccessSnackbar,payload:!1}),severity:"success",content:j==null?void 0:j.data.message}):"",r&&((x=(h=F==null?void 0:F.response)==null?void 0:h.data)!=null&&x.message)?a.jsx(G,{open:l,onClose:()=>k({type:m.openErrorSnackbar,payload:!1}),severity:"error",content:(p=(f=F==null?void 0:F.response)==null?void 0:f.data)==null?void 0:p.message}):""]})},ta=()=>{const{state:{filterable:e,pageable:t},dispatch:i}=Y(),{t:n}=Q(),o=[{id:1,label:n("all"),value:ce.all},{id:2,label:n("active"),value:ce.active},{id:3,label:n("closed"),value:ce.closed}],d=l=>{i({type:Ce.filterable,payload:l}),i({type:Ce.pageable,payload:{...t,page:1}})};return a.jsx(U,{children:a.jsx(Qe,{label:n("entities.stateOfCases"),size:"small",options:o,value:e,onChange:d})})},aa=async(e,t)=>{let i;return i=await q({method:"patch",url:`api/case/${e}`,data:t,withCredentials:!0}),i},sa=(e,t,i)=>{const n=ge();return pe(o=>aa(i,o),{onSuccess:o=>(o.data.error||(t({type:m.resetCaseFormData}),t({type:m.openSuccessSnackbar,payload:!0}),e(),n.invalidateQueries({queryKey:["casesList"]}),n.invalidateQueries({queryKey:["case"]})),o.data.message),onError:o=>{var d,l,u,y;return console.error(o),(l=(d=o==null?void 0:o.response)==null?void 0:d.data)!=null&&l.message&&t({type:m.openErrorSnackbar,payload:!0}),{error:o,message:((y=(u=o==null?void 0:o.response)==null?void 0:u.data)==null?void 0:y.message)||"Error has occured"}}})},ia=({employersOptions:e,lawyersOptions:t,clientsOptions:i,courtsOptions:n,ssnNumbersOptions:o,packagesOptions:d,citiesOptions:l,executorsOptions:u})=>[{name:"firstName",required:!0,type:s.input,gridWidth:6,condition:!1},{name:"lastName",required:!0,type:s.input,gridWidth:6,condition:!1},{name:"jmbg",required:!0,type:s.input,gridWidth:12,condition:!1},{name:"name",required:!0,type:s.input,gridWidth:6,condition:!0},{name:"pib",type:s.input,gridWidth:6,condition:!0},{name:"employed",type:s.checkbox,gridWidth:6,condition:!1},{name:"employer",type:s.autocomplete,gridWidth:12,condition:!1,secondCondition:!0,options:e},{name:"cession",type:s.checkbox,gridWidth:6},{name:"executors",subfieldName:"executor",type:s.dynamicAutocompletes,gridWidth:12,options:u},{name:"principal",type:s.input,gridWidth:6,format:/^[\d 0-9.]{0,24}$/},{name:"interest",type:s.input,gridWidth:6,format:/^[\d 0-9.]{0,24}$/},{name:"businessNumbers",subfieldName:"businessNumber",type:s.dynamicInputs,gridWidth:12},{name:"caseNumber",required:!0,type:s.input,gridWidth:6},{name:"contractNumber",required:!0,type:s.input,gridWidth:6},{name:"ssnNumber",type:s.autocomplete,gridWidth:6,options:o},{name:"package",type:s.autocomplete,gridWidth:6,options:d},{name:"phoneNumbers",subfieldName:"phoneNumber",type:s.dynamicInputs,gridWidth:12},{name:"address",type:s.input,gridWidth:6},{name:"email",type:s.input,gridWidth:6},{name:"zipCode",type:s.input,gridWidth:6,format:/^\d{6}$/},{name:"city",type:s.autocomplete,gridWidth:6,options:l},{name:"lawyer",type:s.autocomplete,gridWidth:6,options:t},{name:"court",type:s.autocomplete,gridWidth:6,options:n},{name:"client",required:!0,type:s.autocomplete,gridWidth:6,options:i},{name:"enteringDate",type:s.datepicker,gridWidth:6},{name:"lawyerHandOverDate",type:s.datepicker,gridWidth:6},{name:"closingDate",type:s.datepicker,gridWidth:6},{name:"status",type:s.input,gridWidth:6},{name:"oldPayment",type:s.input,gridWidth:6,format:/^[\d 0-9.]{0,24}$/},{name:"ourTaxes",type:s.input,gridWidth:6,format:/^[\d 0-9.]{0,24}$/},{name:"warningPrice",type:s.input,gridWidth:6,format:/^[\d 0-9.]{0,24}$/},{name:"comment",type:s.textArea,gridWidth:6},{name:"limitationObjection",type:s.checkbox,gridWidth:6}],na=async e=>{let t;if(e){try{t=await q({method:"get",url:`api/case/${e}`,withCredentials:!0})}catch{t={data:{error:500,message:"errors.serverError"}}}return t}return{data:{error:400,message:"errors.notFound"}}},oa=e=>K(["case",e],()=>na(e),{keepPreviousData:!1,refetchOnMount:!0,refetchOnWindowFocus:!1,select(t){if(t.data.data)return Mt(t.data.data)}}),ra=()=>{const{t:e}=Q(),{state:{isLegalEntity:t,editCaseForm:i,editCaseAutocompleteValues:n,editCaseId:o},dispatch:d}=Y(),{data:l,isLoading:u,isSuccess:y}=oa(o);H.useEffect(()=>{y&&(l!=null&&l.caseNumber)&&d({type:m.setCaseFormData,payload:l})},[l==null?void 0:l.caseNumber]);const{data:g}=Pe({search:n.city}),{data:C}=Se({search:n.client}),{data:k}=Ye({search:n.court}),{data:W}=Ge({search:n.executors}),{data:v}=He({search:n.lawyer}),{data:j}=Ke({search:n.package}),{data:F}=Xe({search:n.ssnNumber}),{data:N}=Je({search:n.employer}),r=(f,p,w)=>(S,$)=>{switch(p){case s.toggle:d({type:m.editCaseForm,payload:{editName:f,fieldEditValue:$}});break;case s.input:case s.textArea:const{value:E}=S==null?void 0:S.target;let _=E;w?_.match(w)&&d({type:m.editCaseForm,payload:{editName:f,fieldEditValue:_}}):d({type:m.editCaseForm,payload:{editName:f,fieldEditValue:_}});break;case s.checkbox:d({type:m.editCaseForm,payload:{editName:f,fieldEditValue:$}});break;case s.datepicker:d({type:m.editCaseForm,payload:{editName:f,fieldEditValue:S}});break;case s.dynamicInputs:d({type:m.editCaseForm,payload:{editName:f,fieldEditValue:S}});break;case s.autocomplete:d({type:m.editCaseForm,payload:{editName:f,fieldEditValue:$?ee($):""}});break;case s.dynamicAutocompletes:d({type:m.editCaseForm,payload:{editName:f,fieldEditValue:S.map(B=>ee(B))}});break}},c=()=>console.log("Submitted"),h=f=>{var L;const{name:p,type:w,gridClassName:S,formFieldClassName:$,gridWidth:E,labelPlacement:_,options:B,size:O,subfieldName:D,format:V,required:z}=f;switch(w){case s.toggle:return a.jsx(A,{className:S,item:!0,xs:E||12,children:a.jsx(ue,{required:z,className:$,value:t,onChange:r(p,w),control:a.jsx(Ue,{color:"primary"}),label:e(`entities.${p}`),labelPlacement:_})},p);case s.checkbox:return a.jsx(A,{className:S,item:!0,xs:E||12,children:a.jsx(ue,{required:z,control:a.jsx(Ne,{className:$,name:p,size:O??"small",checked:i[p],onChange:r(p,w)}),label:e(`entities.${p}`)})},p);case s.input:return a.jsx(A,{className:S,item:!0,xs:E||12,children:a.jsx(Z,{required:z,fullWidth:!0,className:$,size:O??"small",label:e(`entities.${p}`),name:p,value:i[p],onChange:r(p,w,V)})},p);case s.autocomplete:return a.jsx(A,{className:S,item:!0,xs:E||12,children:a.jsx(we,{isOptionEqualToValue:(b,T)=>b.id===T.id,fullWidth:!0,clearIcon:!1,className:$,options:B??[],getOptionLabel:b=>ee(b).name,size:O??"small",value:(L=i[p])!=null&&L.id?i[p]:null,onChange:r(p,w),renderInput:b=>a.jsx(Z,{...b,required:z,label:e(`entities.${p}`),onBlur:()=>d({type:m.editCaseAutocompleteValues,payload:{inputName:p,inputValue:""}}),onChange:je(T=>d({type:m.editCaseAutocompleteValues,payload:{inputName:p,inputValue:T.target.value}}),300)})})},p);case s.datepicker:return a.jsx(A,{className:S,item:!0,xs:E||12,children:a.jsx(Ve,{dateAdapter:Le,children:a.jsx(Ie,{localeText:{clearButtonLabel:e("clear")},label:e(`entities.${p}`),value:i[p],className:$,slotProps:{textField:{size:"small",fullWidth:!0,required:z},actionBar:{actions:["clear"]}},format:"DD. MM. YYYY",onChange:r(p,w)})})},p);case s.dynamicInputs:return a.jsx(A,{className:S,item:!0,xs:E||12,children:a.jsx(Me,{limit:p==="phoneNumbers"?4:2,label:e(`entities.${p}`),inputProps:{label:e(`entities.${D}`),size:"small",fullWidth:!0},values:i[p],onValuesChange:r(p,w)})},p);case s.dynamicAutocompletes:return a.jsx(A,{className:S,item:!0,xs:E||12,children:a.jsx(Ze,{limit:p==="phoneNumbers"?4:2,options:B,label:e(`entities.${p}`),autocompleteProps:{size:"small",fullWidth:!0},inputProps:{label:e(`entities.${D}`)},values:i[p],onValuesChange:r(p,w),actionType:m.editCaseAutocompleteValues,name:p,updateState:d})},p);case s.textArea:return a.jsx(A,{className:S,item:!0,xs:E||12,children:a.jsx(Z,{required:z,fullWidth:!0,multiline:!0,className:$,size:O??"small",label:e(`entities.${p}`),name:p,rows:2,value:i[p],onChange:r(p,w,V)})},p);default:return""}},x=f=>{if(f){const p=Object.entries(f);return a.jsxs(he,{className:"flex justify-between mb-10",children:[a.jsxs("span",{className:"text-xs",children:[e("entities.current_debt"),":"," ",It(i.principal,f)]}),p.map(([w,S])=>S?a.jsxs("span",{className:"text-xs",children:[e(`entities.${w}`),": ",S]},w):"")]})}return""};return u||!i.caseNumber?a.jsx(P,{className:"flex justify-center items-center h-[1300px]",children:a.jsx(qe,{})}):a.jsxs(U,{children:[y&&(l!=null&&l.transactions)?x(l.transactions):"",a.jsx(he,{children:y&&i?a.jsx("form",{onSubmit:c,children:a.jsx(A,{container:!0,spacing:2,children:ia({citiesOptions:g,clientsOptions:C,courtsOptions:k,executorsOptions:W,lawyersOptions:v,packagesOptions:j,ssnNumbersOptions:F,employersOptions:N}).map(f=>(typeof f.condition!="boolean"||f.condition===i.legalEntity)&&(typeof f.secondCondition!="boolean"||f.secondCondition===i.employed)&&h(f))})}):""})]})},la=async e=>{let t;return t=await q({method:"delete",url:`api/case/${e}`,withCredentials:!0}),t},ca=(e,t,i)=>{const n=ge();return pe(()=>la(i),{onSuccess:o=>(o.data.error||(t({type:m.resetCaseFormData}),t({type:m.openSuccessSnackbar,payload:!0}),e(),n.invalidateQueries({queryKey:["casesList"]})),o.data.message),onError:o=>{var d,l,u,y;return console.error(o),(l=(d=o==null?void 0:o.response)==null?void 0:d.data)!=null&&l.message&&t({type:m.openErrorSnackbar,payload:!0}),{error:o,message:((y=(u=o==null?void 0:o.response)==null?void 0:u.data)==null?void 0:y.message)||"Error has occured"}}})},da=e=>{var V,z,L,b;const{open:t,onClose:i}=e,{t:n}=Q(),{state:{editedCaseFormData:o,editCaseId:d,confirmationDialogOpen:l,openSuccessSnackbar:u,openErrorSnackbar:y,addCaseModalOpen:g,editCaseModalOpen:C,exportCasesDialogOpen:k,importCasesDialogOpen:W},dispatch:v}=Y(),j=()=>{v({type:m.confirmationDialogOpen,payload:!1}),i()},{mutate:F,isLoading:N,data:r,error:c,isSuccess:h,isError:x,reset:f}=sa(i,v,d),{mutate:p,isLoading:w,data:S,error:$,isSuccess:E,isError:_,reset:B}=ca(j,v,d);H.useEffect(()=>{(g||C||k||W)&&(h&&f(),E&&B())},[g,C,k,W]);const O=x||_,D=c||$;return a.jsxs(U,{children:[a.jsx(Re,{open:t,header:n("entities.editCase"),children:a.jsx(ra,{}),onClose:i,hasActionButton:!0,actionButtonText:"submit",hasCancelButton:!0,onSubmit:()=>F(Vt(o)),isLoading:N,hasCloseIconButton:!0,extraButtonText:"delete",hasExtraButton:!0,onExtraButtonClick:()=>v({type:m.confirmationDialogOpen,payload:!l})}),a.jsx(mt,{title:"entities.deleteCase",isLoading:w,open:l,onClose:()=>j(),onSubmit:()=>p()}),h&&(r!=null&&r.data.message)?a.jsx(G,{open:u,onClose:()=>v({type:m.openSuccessSnackbar,payload:!1}),severity:"success",content:r==null?void 0:r.data.message}):"",E&&(S!=null&&S.data.message)?a.jsx(G,{open:u,onClose:()=>v({type:m.openSuccessSnackbar,payload:!1}),severity:"success",content:S==null?void 0:S.data.message}):"",O&&((z=(V=D==null?void 0:D.response)==null?void 0:V.data)!=null&&z.message)?a.jsx(G,{open:y,onClose:()=>v({type:m.openErrorSnackbar,payload:!1}),severity:"error",content:(b=(L=D==null?void 0:D.response)==null?void 0:L.data)==null?void 0:b.message}):""]})},ua=()=>{const{state:{filterableByClient:e,pageable:t},dispatch:i}=Y(),{t:n}=Q(),{data:o,isSuccess:d}=Se({});let l=[];d&&o&&(l=o.map(g=>Lt(g)));const u=[{id:9999,label:n("all"),value:9999},...l],y=g=>{i({type:m.filterableByClient,payload:g}),i({type:Ce.pageable,payload:{...t,page:1}})};return a.jsx(U,{children:a.jsx(Qe,{label:n("entities.client"),size:"small",options:u,value:e,onChange:y})})},pa=e=>{const{onClose:t,open:i,title:n,exportCSVButton:o,exportExcelButton:d,exportChecklist:l,className:u}=e,{t:y}=Q();return a.jsx(U,{children:a.jsxs(ht,{fullWidth:!0,className:`z-[9999] ${u}`,open:i,keepMounted:!0,onClose:t,"aria-describedby":"alert-dialog-slide-description",children:[a.jsx(yt,{children:y(n)}),a.jsxs(gt,{children:[a.jsx(P,{children:l?a.jsxs(a.Fragment,{children:[l,a.jsx(Be,{})]}):""}),a.jsx(bt,{id:"alert-dialog-slide-description",children:a.jsxs(ft,{className:"mx-10 mt-6 mb-2",direction:"row",justifyContent:"space-between",children:[a.jsx(P,{children:o}),a.jsx(P,{children:d})]})})]})]})})},De=e=>{const{icon:t,isLoading:i,text:n,disabled:o,onClick:d}=e,{t:l}=Q();return a.jsx(U,{children:a.jsx(de,{className:"w-52 h-16 flex justify-between items-center",variant:"contained",color:"info",startIcon:t||a.jsx(_t,{}),disabled:i||o,onClick:()=>d&&d(),children:a.jsx(P,{className:"w-full flex items-center justify-center",children:i?a.jsx(qe,{color:"inherit",size:24,thickness:4}):l(n)})})})},ma=async e=>{const{filter:t="active",clientsFilter:i=9999}=e;let n;if(n=await q({method:"post",url:"api/export-cases-list",data:{...e,filter:t===ce.all?"":t,clientsFilter:i===9999?"":i},withCredentials:!0}),!n.data.error){const o=n.data.data;if(o)if(typeof o=="object"&&o.type==="Buffer"&&Array.isArray(o.data)){const d=new Uint8Array(o.data);return new Blob([d])}else return new Blob([o])}},ha=e=>pe(t=>ma(t),{onError:t=>{var i,n,o,d;return console.error(t),(n=(i=t==null?void 0:t.response)==null?void 0:i.data)!=null&&n.message&&e({type:m.openErrorSnackbar,payload:!0}),{error:t,message:((d=(o=t==null?void 0:t.response)==null?void 0:o.data)==null?void 0:d.message)||"Error has occured"}}}),Ae=[{name:"caseNumber",type:s.checkbox,gridWidth:4},{name:"contractNumber",type:s.checkbox,gridWidth:4},{name:"name",type:s.checkbox,gridWidth:4},{name:"isLegal",type:s.checkbox,gridWidth:4},{name:"package",type:s.checkbox,gridWidth:4},{name:"principal",type:s.checkbox,gridWidth:4},{name:"interest",type:s.checkbox,gridWidth:4},{name:"cession",type:s.checkbox,gridWidth:4},{name:"state",type:s.checkbox,gridWidth:4},{name:"phoneNumbers",type:s.checkbox,gridWidth:4},{name:"zipCode",type:s.checkbox,gridWidth:4},{name:"city",type:s.checkbox,gridWidth:4},{name:"address",type:s.checkbox,gridWidth:4},{name:"employed",type:s.checkbox,gridWidth:4},{name:"employer",type:s.checkbox,gridWidth:4},{name:"jmbg_pib",type:s.checkbox,gridWidth:4},{name:"lawyer",type:s.checkbox,gridWidth:4},{name:"ssn",type:s.checkbox,gridWidth:4},{name:"executors",type:s.checkbox,gridWidth:4},{name:"businessNumbers",type:s.checkbox,gridWidth:4},{name:"status",type:s.checkbox,gridWidth:4},{name:"client",type:s.checkbox,gridWidth:4},{name:"court",type:s.checkbox,gridWidth:4},{name:"oldPayment",type:s.checkbox,gridWidth:4},{name:"ourTaxes",type:s.checkbox,gridWidth:4},{name:"warningPrice",type:s.checkbox,gridWidth:4},{name:"comment",type:s.checkbox,gridWidth:4},{name:"closingDate",type:s.checkbox,gridWidth:4},{name:"enteringDate",type:s.checkbox,gridWidth:4},{name:"lawyerHandOverDate",type:s.checkbox,gridWidth:4},{name:"limitationObjection",type:s.checkbox,gridWidth:4}],ya=()=>{const{t:e}=Q(),{state:{casesExportChecklistValues:t},dispatch:i}=Y(),n=l=>(u,y)=>{i({type:m.casesExportChecklistValues,payload:{checkboxName:l,checkboxValue:y}})},o=l=>{const{name:u,type:y,gridWidth:g}=l;return y===s.checkbox?a.jsx(A,{item:!0,xs:g||4,children:a.jsx(ue,{control:a.jsx(Ne,{color:"info",name:u,size:"small",checked:t[u],onChange:n(u)}),label:e(`entities.${u}`)})},u):""},d=()=>Object.values(t).reduce((u,y)=>y?u+1:u,0)/Ae.length>.5;return a.jsx(U,{children:a.jsx(he,{className:"mx-4 my-6",children:a.jsx("form",{children:a.jsxs(A,{container:!0,spacing:1,children:[Ae.map(l=>o(l)),a.jsx(A,{item:!0,xs:12,children:a.jsx(de,{color:"info",onClick:()=>i({type:m.casesCheckUncheckAll,payload:!d()}),variant:d()?"outlined":"contained",className:"min-w-full mt-2",children:d()?e("unselectAll"):e("selectAll")})})]})})})})},ga=e=>{var x,f,p,w;const{open:t,onClose:i}=e,{t:n}=Q(),{state:{searchable:o,filterable:d,filterableByClient:l,downloadFile:u,exportFileType:y,casesExportChecklistValues:g,openSuccessSnackbar:C,openErrorSnackbar:k},dispatch:W}=Y(),v=o.reduce((S,$)=>{const E=Te($);return{...S,...E}},{}),{data:j,isLoading:F,mutateAsync:N,error:r,isSuccess:c,isError:h}=ha(W);return H.useEffect(()=>{if(!F&&j){const S=window.URL.createObjectURL(j),$=document.createElement("a");$.href=S,$.download=`${n("entities.cases")} - ${lt().format("YYYY.MM.DD HH-mm")}${y==="excel"?".xlsx":".csv"}`,document.body.appendChild($),$.click(),window.URL.revokeObjectURL(S),c&&(W({type:m.openSuccessSnackbar,payload:!0}),setTimeout(()=>{i()},1500))}},[F,j]),a.jsxs(U,{children:[a.jsx(pa,{title:"entities.exportCases",open:t,onClose:i,exportChecklist:a.jsx(ya,{}),exportCSVButton:a.jsx(De,{text:"exportCSV",isLoading:F,disabled:me(g).length===0,onClick:async()=>{W({type:m.exportFileType,payload:"csv"}),W({type:m.downloadFile,payload:!0}),await N({...v,filter:d,clientsFilter:l,fileType:"csv",downloadFile:u,checkedProps:me(g)})}}),exportExcelButton:a.jsx(De,{text:"exportExcel",isLoading:F,disabled:me(g).length===0,onClick:async()=>{W({type:m.exportFileType,payload:"excel"}),W({type:m.downloadFile,payload:!0}),await N({...v,filter:d,clientsFilter:l,fileType:"excel",downloadFile:u,checkedProps:me(g)})}})}),c&&j?a.jsx(G,{open:C,onClose:()=>W({type:m.openSuccessSnackbar,payload:!1}),severity:"success",content:"messages.fileExportSuccess"}):"",h&&((f=(x=r==null?void 0:r.response)==null?void 0:x.data)!=null&&f.message)?a.jsx(G,{open:k,onClose:()=>W({type:m.openErrorSnackbar,payload:!1}),severity:"error",content:(w=(p=r==null?void 0:r.response)==null?void 0:p.data)==null?void 0:w.message}):""]})},ba=async e=>{let t;const i=new FormData;return i.append("file",e),t=await q({method:"post",url:"api/import-cases-list",data:i,withCredentials:!0,headers:{"Content-Type":"multipart/form-data"}}),t},fa=(e,t)=>{const i=ge();return pe(n=>ba(n),{onSuccess:n=>(n.data.error||(t({type:m.openSuccessSnackbar,payload:!0}),t({type:m.resetCaseFormData}),i.invalidateQueries({queryKey:["casesList"]}),setTimeout(()=>{e()},1500)),n.data.message),onError:n=>{var o,d,l,u;return console.error(n),(d=(o=n==null?void 0:n.response)==null?void 0:o.data)!=null&&d.message&&t({type:m.openErrorSnackbar,payload:!0}),{error:n,message:((u=(l=n==null?void 0:n.response)==null?void 0:l.data)==null?void 0:u.message)||"Error has occured"}}})},xa=e=>{var v,j,F,N;const{open:t,onClose:i}=e,{state:{casesFileForUpload:n,openSuccessSnackbar:o,openErrorSnackbar:d},dispatch:l}=Y(),{isLoading:u,mutateAsync:y,data:g,error:C,isError:k,isSuccess:W}=fa(i,l);return a.jsxs(U,{children:[a.jsx(xt,{title:"entities.importCases",open:t,onClose:i,uploadComponent:a.jsx(Ct,{onFileUpload:r=>l({type:m.casesFileForUpload,payload:r}),onFileDelete:()=>l({type:m.resetCaseFormData})}),isLoading:u,file:n,onSubmitFile:()=>n&&y(n)}),W&&(g!=null&&g.data.message)?a.jsx(G,{open:o,onClose:()=>l({type:m.openSuccessSnackbar,payload:!1}),severity:"success",content:g==null?void 0:g.data.message}):"",k&&((j=(v=C==null?void 0:C.response)==null?void 0:v.data)!=null&&j.message)?a.jsx(G,{open:d,onClose:()=>l({type:m.openErrorSnackbar,payload:!1}),severity:"error",content:(N=(F=C==null?void 0:C.response)==null?void 0:F.data)==null?void 0:N.message}):""]})},va=e=>{const{t}=Q(),{state:{addCaseModalOpen:i,editCaseModalOpen:n,exportCasesDialogOpen:o,importCasesDialogOpen:d},dispatch:l}=Y(),u=()=>{l({type:m.addCaseModalOpen,payload:!1}),l({type:m.resetCaseFormData})},y=()=>{l({type:m.editCaseModalOpen,payload:!1}),l({type:m.resetCaseFormData})},g=()=>{l({type:m.exportCasesDialogOpen,payload:!1}),l({type:m.downloadFile,payload:!1})},C=()=>{l({type:m.importCasesDialogOpen,payload:!1}),l({type:m.resetCaseFormData})};return a.jsx(U,{children:a.jsxs(H.Suspense,{fallback:"Loading....",children:[a.jsxs(P,{className:"my-2 flex justify-between",children:[a.jsxs(P,{className:"grid grid-flow-col gap-2",children:[a.jsx(ta,{}),a.jsx(ua,{})]}),a.jsxs(P,{children:[a.jsx(de,{color:"success",onClick:()=>l({type:m.importCasesDialogOpen,payload:!d}),children:t("entities.importCases")}),a.jsx(de,{color:"info",onClick:()=>l({type:m.exportCasesDialogOpen,payload:!o}),children:t("entities.exportCases")}),a.jsx(de,{onClick:()=>l({type:m.addCaseModalOpen,payload:!i}),children:t("entities.addNewCase")})]})]}),a.jsx(Rt,{}),a.jsx(ea,{open:i,onClose:u}),a.jsx(da,{open:n,onClose:y}),o?a.jsx(ga,{open:o,onClose:g}):"",d?a.jsx(xa,{open:d,onClose:C}):""]})})};export{va as Cases};
