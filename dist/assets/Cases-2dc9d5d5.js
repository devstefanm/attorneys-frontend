import{g as et,e as tt,s as ge,f as oe,_ as re,h as Oe,i as at,k as st,r as H,m as it,n as nt,j as a,o as ot,p as rt,c as ke,q as ce,a as q,t as Y,v as m,w as s,B as U,D as Be,I as De,E as Q,x as be,y as he,z as lt}from"./index-79aed4de.js";import{S as ct,u as X,a as K,c as ze,t as le,r as ne,m as Te,T as dt,R as ut,A as pt,d as je,C as ye,G as A,D as Ve,L as Le,b as Ie,e as Pe,F as ue,f as Ne,M as Re,g as G,h as qe,i as mt,j as ht,k as yt,l as gt,n as bt}from"./ConfirmationDialog-18afe8fd.js";import{s as R,T as Z,u as pe,S as ft,B as de}from"./setupAxios-1965d90e.js";import{u as Qe}from"./useGetCitiesNamesQuery-59292c71.js";import{A as we}from"./Autocomplete-c2a1a426.js";import{F as Se,I as xt,a as Ct}from"./FileUpload-8deff75a.js";function kt(e){return tt("MuiSwitch",e)}const jt=et("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]),P=jt,Nt=["className","color","edge","size","sx"],wt=e=>{const{classes:t,edge:i,size:n,color:o,checked:c,disabled:l}=e,u={root:["root",i&&`edge${oe(i)}`,`size${oe(n)}`],switchBase:["switchBase",`color${oe(o)}`,c&&"checked",l&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},h=rt(u,kt,t);return re({},t,h)},St=ge("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,i.edge&&t[`edge${oe(i.edge)}`],t[`size${oe(i.size)}`]]}})(({ownerState:e})=>re({display:"inline-flex",width:34+12*2,height:14+12*2,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"}},e.edge==="start"&&{marginLeft:-8},e.edge==="end"&&{marginRight:-8},e.size==="small"&&{width:40,height:24,padding:7,[`& .${P.thumb}`]:{width:16,height:16},[`& .${P.switchBase}`]:{padding:4,[`&.${P.checked}`]:{transform:"translateX(16px)"}}})),vt=ge(ct,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.switchBase,{[`& .${P.input}`]:t.input},i.color!=="default"&&t[`color${oe(i.color)}`]]}})(({theme:e})=>({position:"absolute",top:0,left:0,zIndex:1,color:e.vars?e.vars.palette.Switch.defaultColor:`${e.palette.mode==="light"?e.palette.common.white:e.palette.grey[300]}`,transition:e.transitions.create(["left","transform"],{duration:e.transitions.duration.shortest}),[`&.${P.checked}`]:{transform:"translateX(20px)"},[`&.${P.disabled}`]:{color:e.vars?e.vars.palette.Switch.defaultDisabledColor:`${e.palette.mode==="light"?e.palette.grey[100]:e.palette.grey[600]}`},[`&.${P.checked} + .${P.track}`]:{opacity:.5},[`&.${P.disabled} + .${P.track}`]:{opacity:e.vars?e.vars.opacity.switchTrackDisabled:`${e.palette.mode==="light"?.12:.2}`},[`& .${P.input}`]:{left:"-100%",width:"300%"}}),({theme:e,ownerState:t})=>re({"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:Oe(e.palette.action.active,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},t.color!=="default"&&{[`&.${P.checked}`]:{color:(e.vars||e).palette[t.color].main,"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette[t.color].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:Oe(e.palette[t.color].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${P.disabled}`]:{color:e.vars?e.vars.palette.Switch[`${t.color}DisabledColor`]:`${e.palette.mode==="light"?at(e.palette[t.color].main,.62):st(e.palette[t.color].main,.55)}`}},[`&.${P.checked} + .${P.track}`]:{backgroundColor:(e.vars||e).palette[t.color].main}})),Wt=ge("span",{name:"MuiSwitch",slot:"Track",overridesResolver:(e,t)=>t.track})(({theme:e})=>({height:"100%",width:"100%",borderRadius:14/2,zIndex:-1,transition:e.transitions.create(["opacity","background-color"],{duration:e.transitions.duration.shortest}),backgroundColor:e.vars?e.vars.palette.common.onBackground:`${e.palette.mode==="light"?e.palette.common.black:e.palette.common.white}`,opacity:e.vars?e.vars.opacity.switchTrack:`${e.palette.mode==="light"?.38:.3}`})),Ft=ge("span",{name:"MuiSwitch",slot:"Thumb",overridesResolver:(e,t)=>t.thumb})(({theme:e})=>({boxShadow:(e.vars||e).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"})),$t=H.forwardRef(function(t,i){const n=it({props:t,name:"MuiSwitch"}),{className:o,color:c="primary",edge:l=!1,size:u="medium",sx:h}=n,b=nt(n,Nt),C=re({},n,{color:c,edge:l,size:u}),v=wt(C),W=a.jsx(Ft,{className:v.thumb,ownerState:C});return a.jsxs(St,{className:ot(v.root,o),sx:h,ownerState:C,children:[a.jsx(vt,re({type:"checkbox",icon:W,checkedIcon:W,ref:i,ownerState:C},b,{classes:re({},v,{root:v.switchBase})})),a.jsx(Wt,{className:v.track,ownerState:C})]})}),Ue=$t,Et=ke(a.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8 0-1.85.63-3.55 1.69-4.9L16.9 18.31C15.55 19.37 13.85 20 12 20zm6.31-3.1L7.1 5.69C8.45 4.63 10.15 4 12 4c4.42 0 8 3.58 8 8 0 1.85-.63 3.55-1.69 4.9z"}),"DoNotDisturb"),_t=ke(a.jsx("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"}),"GetApp"),Ot=ke(a.jsx("path",{d:"M22 5.18 10.59 16.6l-4.24-4.24 1.41-1.41 2.83 2.83 10-10L22 5.18zm-2.21 5.04c.13.57.21 1.17.21 1.78 0 4.42-3.58 8-8 8s-8-3.58-8-8 3.58-8 8-8c1.58 0 3.04.46 4.28 1.25l1.44-1.44C16.1 2.67 14.13 2 12 2 6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10c0-1.19-.22-2.33-.6-3.39l-1.61 1.61z"}),"TaskAlt"),Dt=({id:e,first_name:t,last_name:i,case_number:n,contract_number:o,jmbg:c,pib:l,name:u,executors:h,lawyer_first_name:b,lawyer_last_name:C,lawyer_office_name:v,state:W,ssn:j,package:k,business_numbers:F,cession:N,principal:r,interest:x})=>({id:e,name:u?X(u):`${t?X(t):""} ${i?X(i):""}`,jmbg_pib:c||""||l||"",caseNumber:n,contractNumber:o,executors:h,lawyer:v?`${b?X(b):""} ${C?X(C):""} (${X(v)})`:`${b?X(b):""} ${C?X(C):""}`,ssn:j??"",package:k??"",state:W,businessNumbers:F,cession:N?a.jsx(Ot,{color:"success"}):a.jsx(Et,{color:"error"}),principal:r,interest:x}),At=async e=>{var h;const{sortBy:t="created_at",sort:i="desc",page:n=1,size:o=25,filter:c="active",clientsFilter:l=9999}=e;let u;try{u=await R({method:"get",url:"api/cases-list",params:{...e,sortBy:t===""?"created_at":ze(t),sort:i===""?"asc":i,page:n,size:o,filter:c===ce.all?"":c,clientsFilter:l===9999?"":l},withCredentials:!0}),(h=u.data.data)!=null&&h.cases&&(u.data.data.cases=u.data.data.cases.map(b=>Dt(b)))}catch{u={data:{error:500,message:"Connection problem"}}}return u},Mt=e=>K(["casesList",e],()=>At(e),{keepPreviousData:!0,refetchOnMount:!1,refetchOnWindowFocus:!1}),Bt=e=>{switch(e){case"active":return"#22c55e";case"closed":return"#9ca3af";default:return""}},ee=e=>{const{id:t,first_name:i,last_name:n,name:o,package_name:c,ssn:l}=e;let u="";return o&&(u=o),i&&(u=`${i} ${n??""}`),c&&(u=c),l&&(u=l),{id:t,name:u}},zt=({address:e,businessNumbers:t,caseNumber:i,cession:n,city:o,client:c,closingDate:l,contractNumber:u,court:h,email:b,employed:C,employer:v,executors:W,firstName:j,interest:k,jmbg:F,lastName:N,lawyer:r,legalEntity:x,name:y,package:d,phoneNumbers:g,pib:p,principal:w,ssnNumber:S,zipCode:$,status:E,oldPayment:_,ourTaxes:M,warningPrice:O,enteringDate:D,lawyerHandOverDate:V,comment:B,limitationObjection:L})=>{let f=null,z=null,te=null,ae=[],se=null,ie=null,I=null,fe=null,We=null,xe=null,Ce=null;typeof o!="string"&&(f=o.id),typeof c!="string"&&(z=c.id),typeof h!="string"&&(te=h.id),typeof W!==null&&(ae=W.map(J=>J.id).filter(J=>J!==null)),typeof r!="string"&&(se=r.id),typeof S!="string"&&(ie=S.id),typeof d!="string"&&(I=d.id),typeof v!="string"&&(We=v==null?void 0:v.id),l&&(fe=le(l)),D&&(xe=le(D)),V&&(Ce=le(V));const Fe=i,$e=u,Ee=g.filter(J=>J.length>5),_e=t.filter(J=>J.length>0);return x?{name:y,pib:p,address:e,cession:n,email:b,zip_code:$,case_number:Fe,contract_number:$e,principal:Number(w),interest:Number(k),city_id:f,client_id:z,court_id:te,executor_ids:ae,lawyer_id:se,ssn_number_id:ie,package_id:I,phone_numbers:Ee,business_numbers:_e,closing_date:fe,status:E,old_payment:_?Number(_):null,our_taxes:M?Number(M):null,warning_price:O?Number(O):null,entering_date:xe,lawyer_hand_over_date:Ce,comment:B,limitation_objection:L}:{first_name:j,last_name:N,employed:C,employer_id:We,jmbg:F,address:e,cession:n,email:b,zip_code:$,case_number:Fe,contract_number:$e,principal:Number(w),interest:Number(k),city_id:f,client_id:z,court_id:te,executor_ids:ae,lawyer_id:se,ssn_number_id:ie,package_id:I,phone_numbers:Ee,business_numbers:_e,closing_date:fe,status:E,old_payment:_?Number(_):null,our_taxes:M?Number(M):null,warning_price:O?Number(O):null,entering_date:xe,lawyer_hand_over_date:Ce,comment:B,limitation_objection:L}},Tt=e=>{const{is_legal:t,first_name:i,last_name:n,jmbg:o,name:c,pib:l,employed:u,employer:h,executors:b,cession:C,address:v,email:W,zip_code:j,city:k,case_number:F,contract_number:N,closing_date:r,business_numbers:x,lawyer:y,client:d,court:g,ssn_number:p,package:w,principal:S,interest:$,phone_numbers:E,state:_,status:M,old_payment:O,our_taxes:D,warning_price:V,entering_date:B,lawyer_hand_over_date:L,comment:f,limitation_objection:z,fee:te,legal_fee:ae,payment:se,withdrawal:ie}=e;return t?{address:v,email:W,cession:C,name:c,pib:l,legalEntity:t,executors:b&&b.length>0?b.map(I=>({id:I.id,name:`${I.first_name} ${I.last_name}`})):[{id:null,name:""}],phoneNumbers:E&&E.length>0?E:[""],zipCode:j,city:k!=null&&k.id?{id:k.id,name:k.name}:"",caseNumber:F,contractNumber:N,closingDate:r?ne(r):null,businessNumbers:x&&x.length>0?x.map(I=>I.number):[""],lawyer:y!=null&&y.id?{id:y.id,name:`${y.first_name} ${y.last_name}`}:"",client:d!=null&&d.id?{id:d.id,name:d.name}:"",court:g!=null&&g.id?{id:g.id,name:g.name}:"",ssnNumber:p!=null&&p.id?{id:p.id,name:String(p.ssn)}:"",package:w!=null&&w.id?{id:w.id,name:w.package_name}:"",principal:S.toString(),interest:$.toString(),state:_||"active",status:M,comment:f,oldPayment:O?O.toString():"",ourTaxes:D?D.toString():"",warningPrice:V?V.toString():"",enteringDate:B?ne(B):null,lawyerHandOverDate:L?ne(L):null,limitationObjection:z||!1,transactions:{fees:te||null,legal_fees:ae||null,payments:se||null,withdrawals:ie||null}}:{address:v,email:W,cession:C,jmbg:o,employed:u,legalEntity:t,firstName:i,lastName:n,employer:h!=null&&h.id?{id:h.id,name:h.name}:"",executors:b&&b.length>0?b.map(I=>({id:I.id,name:`${I.first_name} ${I.last_name}`})):[{id:null,name:""}],phoneNumbers:E&&E.length>0?E:[""],zipCode:j,city:k!=null&&k.id?{id:k.id,name:k.name}:"",caseNumber:F,contractNumber:N,closingDate:r?ne(r):null,businessNumbers:x&&x.length>0?x.map(I=>I.number):[""],lawyer:y!=null&&y.id?{id:y.id,name:`${y.first_name} ${y.last_name}`}:"",client:d!=null&&d.id?{id:d.id,name:d.name}:"",court:g!=null&&g.id?{id:g.id,name:g.name}:"",ssnNumber:p!=null&&p.id?{id:p.id,name:String(p.ssn)}:"",package:w!=null&&w.id?{id:w.id,name:w.package_name}:"",principal:S.toString(),interest:$.toString(),state:_||"active",status:M,comment:f,oldPayment:O?O.toString():"",ourTaxes:D?D.toString():"",warningPrice:V?V.toString():"",enteringDate:B?ne(B):null,lawyerHandOverDate:L?ne(L):null,limitationObjection:z||!1,transactions:{fees:te||null,legal_fees:ae||null,payments:se||null,withdrawals:ie||null}}},Vt=({address:e,businessNumbers:t,caseNumber:i,cession:n,city:o,client:c,closingDate:l,contractNumber:u,court:h,email:b,employed:C,employer:v,executors:W,firstName:j,interest:k,jmbg:F,lastName:N,lawyer:r,name:x,package:y,phoneNumbers:d,pib:g,principal:p,ssnNumber:w,zipCode:S,state:$,status:E,oldPayment:_,ourTaxes:M,warningPrice:O,enteringDate:D,lawyerHandOverDate:V,comment:B,limitationObjection:L})=>{const f={};return o!==void 0&&(typeof o!="string"?f.city_id=o.id||null:o===""&&(f.city_id=null)),c!==void 0&&(typeof c!="string"?f.client_id=c.id||null:c===""&&(f.client_id=null)),h!==void 0&&(typeof h!="string"?f.court_id=h.id||null:h===""&&(f.court_id=null)),W!==void 0&&(W.length>0?f.executor_ids=W.filter(z=>z.id!==0&&z.id!==null).map(z=>z.id):f.executor_ids=[]),r!==void 0&&(typeof r!="string"?f.lawyer_id=r.id||null:r===""&&(f.lawyer_id=null)),w!==void 0&&(typeof w!="string"?f.ssn_number_id=w.id||null:w===""&&(f.ssn_number_id=null)),y!==void 0&&(typeof y!="string"?f.package_id=y.id||null:y===""&&(f.package_id=null)),v!==void 0&&(typeof v!="string"?f.employer_id=v.id||null:v===""&&(f.employer_id=null)),l!==void 0&&(f.closing_date=l?le(l):null),D!==void 0&&(f.entering_date=D?le(D):null),V!==void 0&&(f.lawyer_hand_over_date=V?le(V):null),i!==void 0&&(f.case_number=i||null),u!==void 0&&(f.contract_number=u||null),d!==void 0&&(d.length>0?f.phone_numbers=d==null?void 0:d.filter(z=>z.length>5):f.phone_numbers=[""]),t!==void 0&&(t.length>0?f.business_numbers=t==null?void 0:t.filter(z=>z.length>0):f.business_numbers=[""]),x!==void 0&&(f.name=x||null),g!==void 0&&(f.pib=g||null),j!==void 0&&(f.first_name=j||null),N!==void 0&&(f.last_name=N||null),C!==void 0&&(f.employed=C),F!==void 0&&(f.jmbg=F||null),$!==void 0&&(f.state=$||null),B!==void 0&&(f.comment=B||null),E!==void 0&&(f.status=E||null),L!==void 0&&(f.limitation_objection=L||null),e!==void 0&&(f.address=e||null),n!==void 0&&(f.cession=n),b!==void 0&&(f.email=b||null),S!==void 0&&(f.zip_code=S||null),p!==void 0&&(f.principal=Number(p)||null),k!==void 0&&(f.interest=Number(k)||null),_!==void 0&&(f.old_payment=Number(_)||null),M!==void 0&&(f.our_taxes=Number(M)||null),O!==void 0&&(f.warning_price=Number(O)||null),f},Lt=({id:e,name:t})=>({id:e,label:t,value:e}),me=e=>Object.keys(e).filter(t=>e[t]===!0).map(t=>ze(t)),It=(e,t)=>{const{principal:i,interest:n,warningPrice:o}=e;let c=i?parseFloat(i):0,l=n?parseFloat(n):0,u=o?parseFloat(o):0;isNaN(c)&&(c=0),isNaN(l)&&(l=0),isNaN(u)&&(u=0);let h=c+l+u;return t&&(h=h+(t.fees||0)+(t.legal_fees||0)-(t.withdrawals||0)-(t.payments||0)),parseFloat(h.toFixed(2))},T={name:"name",jmbg_pib:"jmbg_pib",caseNumber:"caseNumber",contractNumber:"contractNumber",cession:"cession",executors:"executors",lawyer:"lawyer",ssn:"ssn",package:"package",state:"state",businessNumbers:"businessNumbers",principal:"principal",interest:"interest"},Pt=()=>{var x,y;const{t:e}=q(),{state:{sortable:{sort:t,sortBy:i},pageable:{page:n,size:o},searchable:c,filterable:l,filterableByClient:u,filterableMultiselect:h},dispatch:b}=Y();let C={page:n,size:o,sort:t,sortBy:i};const v=c.reduce((d,g)=>{const p=Te(g);return{...d,...p}},{}),W=h.reduce((d,g)=>(g!==""&&(d[g]=!0),d),{}),{data:j,isLoading:k,refetch:F}=Mt({...C,...v,filter:l,clientsFilter:u,...W}),N=d=>{const{id:g}=d.original;g&&(b({type:m.editCaseId,payload:g}),b({type:m.editCaseModalOpen,payload:!0}))},r=H.useMemo(()=>[{accessorFn:d=>d.name,id:T.name,header:()=>a.jsx("span",{children:e(`entities.${[T.name]}`)}),cell:d=>d.getValue(),isSearchable:!0,isSortable:!0},{accessorFn:d=>d.jmbg_pib,id:T.jmbg_pib,header:()=>a.jsx("span",{children:e(`entities.${[T.jmbg_pib]}`)}),cell:d=>d.getValue(),isSearchable:!0,isSortable:!0},{accessorFn:d=>d.caseNumber,id:T.caseNumber,header:()=>a.jsx("span",{children:e(`entities.${[T.caseNumber]}`)}),cell:d=>d.getValue(),isSearchable:!0,isSortable:!0},{accessorFn:d=>d.contractNumber,id:T.contractNumber,header:()=>a.jsx("span",{children:e(`entities.${[T.contractNumber]}`)}),cell:d=>d.getValue(),isSearchable:!0,isSortable:!0},{accessorFn:d=>d.businessNumbers,id:T.businessNumbers,header:()=>a.jsx("span",{children:e(`entities.${[T.businessNumbers]}`)}),cell:d=>d.getValue(),isSearchable:!0,isSortable:!0},{accessorFn:d=>d.executors,id:T.executors,header:()=>a.jsx("span",{children:e(`entities.${[T.executors]}`)}),cell:d=>d.getValue(),isSearchable:!0,isSortable:!0},{accessorFn:d=>d.lawyer,id:T.lawyer,header:()=>a.jsx("span",{children:e(`entities.${[T.lawyer]}`)}),cell:d=>d.getValue(),isSearchable:!0,isSortable:!0},{accessorFn:d=>d.ssn,id:T.ssn,header:()=>a.jsx("span",{children:e(`entities.${[T.ssn]}`)}),cell:d=>d.getValue(),isSearchable:!0,isSortable:!0},{accessorFn:d=>d.package,id:T.package,header:()=>a.jsx("span",{children:e(`entities.${[T.package]}`)}),cell:d=>d.getValue(),isSearchable:!0,isSortable:!0}],[]);return k?a.jsx(a.Fragment,{children:"Loading..."}):a.jsx(dt,{columns:r,data:(x=j==null?void 0:j.data.data)==null?void 0:x.cases,hasSearch:!0,sort:t,sortBy:i,totalNumber:(y=j==null?void 0:j.data.data)==null?void 0:y.meta.total_number,page:n,size:o,borderKeyword:"state",updateState:b,refetch:F,mapBorderColors:Bt,onRowClick:N})},Rt=({employersOptions:e,lawyersOptions:t,clientsOptions:i,courtsOptions:n,ssnNumbersOptions:o,packagesOptions:c,citiesOptions:l,executorsOptions:u})=>[{name:"legalEntity",type:s.toggle,options:[!0,!1],gridClassName:"flex justify-center",labelPlacement:"top"},{name:"firstName",required:!0,type:s.input,gridWidth:6,condition:!1},{name:"lastName",required:!0,type:s.input,gridWidth:6,condition:!1},{name:"jmbg",required:!0,type:s.input,gridWidth:12,condition:!1},{name:"name",required:!0,type:s.input,gridWidth:6,condition:!0},{name:"pib",type:s.input,gridWidth:6,condition:!0},{name:"employed",type:s.checkbox,gridWidth:6,condition:!1},{name:"employer",type:s.autocomplete,gridWidth:12,condition:!1,secondCondition:!0,options:e},{name:"cession",type:s.checkbox,gridWidth:6},{name:"executors",subfieldName:"executor",type:s.dynamicAutocompletes,gridWidth:12,options:u},{name:"principal",type:s.input,gridWidth:6,format:/^[\d 0-9.]{0,24}$/},{name:"interest",type:s.input,gridWidth:6,format:/^[\d 0-9.]{0,24}$/},{name:"businessNumbers",subfieldName:"businessNumber",type:s.dynamicInputs,gridWidth:12},{name:"caseNumber",required:!0,type:s.input,gridWidth:6},{name:"contractNumber",required:!0,type:s.input,gridWidth:6},{name:"ssnNumber",type:s.autocomplete,gridWidth:6,options:o},{name:"package",type:s.autocomplete,gridWidth:6,options:c},{name:"phoneNumbers",subfieldName:"phoneNumber",type:s.dynamicInputs,gridWidth:12},{name:"address",type:s.input,gridWidth:6},{name:"email",type:s.input,gridWidth:6},{name:"zipCode",type:s.input,gridWidth:6,format:/^\d{6}$/},{name:"city",type:s.autocomplete,gridWidth:6,options:l},{name:"lawyer",type:s.autocomplete,gridWidth:6,options:t},{name:"court",type:s.autocomplete,gridWidth:6,options:n},{name:"client",required:!0,type:s.autocomplete,gridWidth:6,options:i},{name:"enteringDate",type:s.datepicker,gridWidth:6},{name:"lawyerHandOverDate",type:s.datepicker,gridWidth:6},{name:"closingDate",type:s.datepicker,gridWidth:6},{name:"status",type:s.input,gridWidth:6},{name:"oldPayment",type:s.input,gridWidth:6,format:/^[\d 0-9.]{0,24}$/},{name:"ourTaxes",type:s.input,gridWidth:6,format:/^[\d 0-9.]{0,24}$/},{name:"warningPrice",type:s.input,gridWidth:6,format:/^[\d 0-9.]{0,24}$/},{name:"comment",type:s.textArea,gridWidth:6},{name:"limitationObjection",type:s.checkbox,gridWidth:6}],qt=async e=>{let t;try{t=await R({method:"get",url:"api/clients-names",params:{...e},withCredentials:!0})}catch{t={data:{error:500,message:"Connection problem"}}}return t},ve=e=>K(["clientsNames",e],()=>qt(e),{keepPreviousData:!0,refetchOnMount:!1,refetchOnWindowFocus:!1,select(t){return t.data.data}}),Qt=async e=>{let t;try{t=await R({method:"get",url:"api/courts-names",params:{...e},withCredentials:!0})}catch{t={data:{error:500,message:"Connection problem"}}}return t},Ye=e=>K(["courtsNames",e],()=>Qt(e),{keepPreviousData:!0,refetchOnMount:!1,refetchOnWindowFocus:!1,select(t){return t.data.data}}),Ut=async e=>{let t;try{t=await R({method:"get",url:"api/executors-names",params:{...e},withCredentials:!0})}catch{t={data:{error:500,message:"Connection problem"}}}return t},Ge=e=>K(["executorsNames",e],()=>Ut(e),{keepPreviousData:!0,refetchOnMount:!1,refetchOnWindowFocus:!1,select(t){return t.data.data}}),Yt=async e=>{let t;try{t=await R({method:"get",url:"api/lawyers-names",params:{...e},withCredentials:!0})}catch{t={data:{error:500,message:"Connection problem"}}}return t},He=e=>K(["lawyersNames",e],()=>Yt(e),{keepPreviousData:!0,refetchOnMount:!1,refetchOnWindowFocus:!1,select(t){return t.data.data}}),Gt=async e=>{let t;try{t=await R({method:"get",url:"api/packages-names",params:{...e},withCredentials:!0})}catch{t={data:{error:500,message:"Connection problem"}}}return t},Ke=e=>K(["packagesNames",e],()=>Gt(e),{keepPreviousData:!0,refetchOnMount:!1,refetchOnWindowFocus:!1,select(t){return t.data.data}}),Ht=async e=>{let t;try{t=await R({method:"get",url:"api/ssn-numbers",params:{...e},withCredentials:!0})}catch{t={data:{error:500,message:"Connection problem"}}}return t},Xe=e=>K(["ssnNumbers",e],()=>Ht(e),{keepPreviousData:!0,refetchOnMount:!1,refetchOnWindowFocus:!1,select(t){return t.data.data}}),Kt=async e=>{let t;try{t=await R({method:"get",url:"api/employers-names",params:{...e},withCredentials:!0})}catch{t={data:{error:500,message:"Connection problem"}}}return t},Je=e=>K(["employersNames",e],()=>Kt(e),{keepPreviousData:!0,refetchOnMount:!1,refetchOnWindowFocus:!1,select(t){return t.data.data}}),Ze=({label:e,values:t,autocompleteProps:i,inputProps:n,options:o,name:c,actionType:l,limit:u,onValuesChange:h,updateState:b})=>{const[C,v]=H.useState(t??[{id:null,name:""}]);H.useEffect(()=>{t&&v(t)},[t]);const W=()=>{if(C.length<6){const r=[...C,{id:null,name:""}];v(r),h&&h(r)}},j=r=>{const x=[...C];x.splice(r,1),v(x),h&&h(x)},k=(r,x)=>{const y=[...C];y[r]=x,v(y),h&&h(y)},F=(r,x)=>{const{value:y}=r.target;je(g=>b&&b({type:l,payload:{inputName:c,inputValue:g}}),300)(y),y===""&&k(x,{id:0,name:y})},N=(r,x)=>{var y;if(((y=r==null?void 0:r.currentTarget)==null?void 0:y.ariaLabel)==="Clear")return k(x,{id:0,name:""});if(r!=null&&r.target&&"value"in r.target){const{value:d}=r.target;if(d==="")return k(x,{id:0,name:""})}};return a.jsxs(U,{className:"my-3",children:[a.jsx(Be,{textAlign:"left",children:e}),C.map((r,x)=>a.jsxs(U,{className:"flex my-3",children:[a.jsx(we,{...i,clearIcon:!1,isOptionEqualToValue:(y,d)=>y.id===d.id,options:o??[],getOptionLabel:y=>ee(y).name,onBlur:()=>b&&b({type:l,payload:{inputName:c,inputValue:""}}),value:r!=null&&r.id?r:null,onChange:(y,d)=>k(x,d),onInputChange:y=>N(y,x),renderInput:y=>a.jsx(Z,{...y,...n,label:`${n==null?void 0:n.label} ${x+1}`,onBlur:()=>b&&b({type:l,payload:{inputName:c,inputValue:""}}),onChange:d=>F(d,x)})}),x>0?a.jsx(De,{onClick:()=>j(x),children:a.jsx(ut,{})}):a.jsx(U,{className:"w-[42px]"})]},x)),C.length<(u||4)&&a.jsx(U,{className:"flex justify-center",children:a.jsx(De,{onClick:W,children:a.jsx(pt,{})})})]})},Xt=()=>{const{t:e}=q(),{state:{isLegalEntity:t,addCaseForm:i,addCaseAutocompleteValues:n},dispatch:o}=Y(),{data:c}=Qe({search:n.city}),{data:l}=ve({search:n.client}),{data:u}=Ye({search:n.court}),{data:h}=Ge({search:n.executors}),{data:b}=He({search:n.lawyer}),{data:C}=Ke({search:n.package}),{data:v}=Xe({search:n.ssnNumber}),{data:W}=Je({search:n.employer}),j=(N,r,x)=>(y,d)=>{switch(r){case s.toggle:N==="legalEntity"?(o({type:m.isLegalEntity,payload:!t}),o({type:m.addCaseForm,payload:{name:N,fieldValue:d}})):o({type:m.addCaseForm,payload:{name:N,fieldValue:d}});break;case s.input:case s.textArea:const{value:g}=y==null?void 0:y.target;let p=g;x?p.match(x)&&o({type:m.addCaseForm,payload:{name:N,fieldValue:p}}):o({type:m.addCaseForm,payload:{name:N,fieldValue:p}});break;case s.checkbox:o({type:m.addCaseForm,payload:{name:N,fieldValue:d}});break;case s.datepicker:o({type:m.addCaseForm,payload:{name:N,fieldValue:y}});break;case s.dynamicInputs:o({type:m.addCaseForm,payload:{name:N,fieldValue:y}});break;case s.autocomplete:o({type:m.addCaseForm,payload:{name:N,fieldValue:d?ee(d):""}});break;case s.dynamicAutocompletes:o({type:m.addCaseForm,payload:{name:N,fieldValue:y.map(w=>ee(w))}});break}},k=()=>console.log("Submitted"),F=N=>{var M;const{name:r,type:x,gridClassName:y,formFieldClassName:d,gridWidth:g,labelPlacement:p,options:w,size:S,subfieldName:$,format:E,required:_}=N;switch(x){case s.toggle:return a.jsx(A,{className:y,item:!0,xs:g||12,children:a.jsx(ue,{required:_,className:d,value:t,onChange:j(r,x),control:a.jsx(Ue,{color:"primary"}),label:e(`entities.${r}`),labelPlacement:p})},r);case s.checkbox:return a.jsx(A,{className:y,item:!0,xs:g||12,children:a.jsx(ue,{required:_,control:a.jsx(Ne,{className:d,name:r,size:S??"small",checked:i[r],onChange:j(r,x)}),label:e(`entities.${r}`)})},r);case s.input:return a.jsx(A,{className:y,item:!0,xs:g||12,children:a.jsx(Z,{required:_,fullWidth:!0,className:d,size:S??"small",label:e(`entities.${r}`),name:r,value:i[r],onChange:j(r,x,E)})},r);case s.autocomplete:return a.jsx(A,{className:y,item:!0,xs:g||12,children:a.jsx(we,{isOptionEqualToValue:(O,D)=>O.id===D.id,fullWidth:!0,clearIcon:!1,className:d,options:w??[],getOptionLabel:O=>ee(O).name,size:S??"small",value:(M=i[r])!=null&&M.id?i[r]:null,onChange:j(r,x),renderInput:O=>a.jsx(Z,{...O,required:_,label:e(`entities.${r}`),onBlur:()=>o({type:m.addCaseAutocompleteValues,payload:{inputName:r,inputValue:""}}),onChange:je(D=>o({type:m.addCaseAutocompleteValues,payload:{inputName:r,inputValue:D.target.value}}),300)})})},r);case s.datepicker:return a.jsx(A,{className:y,item:!0,xs:g||12,children:a.jsx(Le,{dateAdapter:Ie,children:a.jsx(Pe,{localeText:{clearButtonLabel:e("clear")},label:e(`entities.${r}`),value:i[r],className:d,slotProps:{textField:{size:"small",fullWidth:!0,required:_},actionBar:{actions:["clear"]}},format:"DD. MM. YYYY",onChange:j(r,x)})})},r);case s.dynamicInputs:return a.jsx(A,{className:y,item:!0,xs:g||12,children:a.jsx(Ve,{limit:r==="phoneNumbers"?4:2,label:e(`entities.${r}`),inputProps:{label:e(`entities.${$}`),size:"small",fullWidth:!0},values:i[r],onValuesChange:j(r,x)})},r);case s.dynamicAutocompletes:return a.jsx(A,{className:y,item:!0,xs:g||12,children:a.jsx(Ze,{limit:r==="phoneNumbers"?4:2,options:w,label:e(`entities.${r}`),autocompleteProps:{size:"small",fullWidth:!0},inputProps:{label:e(`entities.${$}`)},value:i[r],onValuesChange:j(r,x),actionType:m.addCaseAutocompleteValues,name:r,updateState:o})},r);case s.textArea:return a.jsx(A,{className:y,item:!0,xs:g||12,children:a.jsx(Z,{required:_,fullWidth:!0,multiline:!0,className:d,size:S??"small",label:e(`entities.${r}`),name:r,rows:2,value:i[r],onChange:j(r,x,E)})},r);default:return""}};return a.jsx(Q,{children:a.jsx(ye,{children:a.jsx("form",{onSubmit:k,children:a.jsx(A,{container:!0,spacing:2,children:Rt({citiesOptions:c,clientsOptions:l,courtsOptions:u,executorsOptions:h,lawyersOptions:b,packagesOptions:C,ssnNumbersOptions:v,employersOptions:W}).map(N=>(typeof N.condition!="boolean"||N.condition===t)&&(typeof N.secondCondition!="boolean"||N.secondCondition===i.employed)&&F(N))})})})})},Jt=async e=>{let t;return t=await R({method:"post",url:"api/cases",data:e,withCredentials:!0}),t},Zt=(e,t)=>{const i=be();return pe(n=>Jt(n),{onSuccess:n=>(n.data.error||(t({type:m.resetCaseFormData}),t({type:m.openSuccessSnackbar,payload:!0}),e(),i.invalidateQueries({queryKey:["casesList"]})),n.data.message),onError:n=>{var o,c;return console.error(n),t({type:m.openErrorSnackbar,payload:!0}),{error:n,message:((c=(o=n==null?void 0:n.response)==null?void 0:o.data)==null?void 0:c.message)||"Error has occured"}}})},ea=e=>{var y,d,g,p;const{open:t,onClose:i}=e,{t:n}=q(),{state:{addCaseForm:o,openSuccessSnackbar:c,openErrorSnackbar:l,addCaseModalOpen:u,editCaseModalOpen:h,exportCasesDialogOpen:b,importCasesDialogOpen:C},dispatch:v}=Y(),{mutate:W,isLoading:j,data:k,error:F,isSuccess:N,isError:r,reset:x}=Zt(i,v);return H.useEffect(()=>{(u||h||b||C)&&N&&x()},[u,h,b,C]),a.jsxs(Q,{children:[a.jsx(Re,{open:t,header:n("entities.addNewCase"),children:a.jsx(Xt,{}),onClose:i,hasActionButton:!0,actionButtonText:"submit",hasCancelButton:!0,onSubmit:()=>W(zt(o)),isLoading:j,hasCloseIconButton:!0}),N&&(k!=null&&k.data.message)?a.jsx(G,{open:c,onClose:()=>v({type:m.openSuccessSnackbar,payload:!1}),severity:"success",content:k==null?void 0:k.data.message}):"",r&&((d=(y=F==null?void 0:F.response)==null?void 0:y.data)!=null&&d.message)?a.jsx(G,{open:l,onClose:()=>v({type:m.openErrorSnackbar,payload:!1}),severity:"error",content:(p=(g=F==null?void 0:F.response)==null?void 0:g.data)==null?void 0:p.message}):""]})},ta=()=>{const{state:{filterable:e,pageable:t},dispatch:i}=Y(),{t:n}=q(),o=[{id:1,label:n("all"),value:ce.all},{id:2,label:n("active"),value:ce.active},{id:3,label:n("closed"),value:ce.closed}],c=l=>{i({type:he.filterable,payload:l}),i({type:he.pageable,payload:{...t,page:1}})};return a.jsx(Q,{children:a.jsx(Se,{label:n("entities.stateOfCases"),size:"small",options:o,value:e,onChange:c})})},aa=async(e,t)=>{let i;return i=await R({method:"patch",url:`api/case/${e}`,data:t,withCredentials:!0}),i},sa=(e,t,i)=>{const n=be();return pe(o=>aa(i,o),{onSuccess:o=>(o.data.error||(t({type:m.resetCaseFormData}),t({type:m.openSuccessSnackbar,payload:!0}),e(),n.invalidateQueries({queryKey:["casesList"]}),n.invalidateQueries({queryKey:["case"]})),o.data.message),onError:o=>{var c,l,u,h;return console.error(o),(l=(c=o==null?void 0:o.response)==null?void 0:c.data)!=null&&l.message&&t({type:m.openErrorSnackbar,payload:!0}),{error:o,message:((h=(u=o==null?void 0:o.response)==null?void 0:u.data)==null?void 0:h.message)||"Error has occured"}}})},ia=({employersOptions:e,lawyersOptions:t,clientsOptions:i,courtsOptions:n,ssnNumbersOptions:o,packagesOptions:c,citiesOptions:l,executorsOptions:u})=>[{name:"firstName",required:!0,type:s.input,gridWidth:6,condition:!1},{name:"lastName",required:!0,type:s.input,gridWidth:6,condition:!1},{name:"jmbg",required:!0,type:s.input,gridWidth:12,condition:!1},{name:"name",required:!0,type:s.input,gridWidth:6,condition:!0},{name:"pib",type:s.input,gridWidth:6,condition:!0},{name:"employed",type:s.checkbox,gridWidth:6,condition:!1},{name:"employer",type:s.autocomplete,gridWidth:12,condition:!1,secondCondition:!0,options:e},{name:"cession",type:s.checkbox,gridWidth:6},{name:"executors",subfieldName:"executor",type:s.dynamicAutocompletes,gridWidth:12,options:u},{name:"principal",type:s.input,gridWidth:6,format:/^[\d 0-9.]{0,24}$/},{name:"interest",type:s.input,gridWidth:6,format:/^[\d 0-9.]{0,24}$/},{name:"businessNumbers",subfieldName:"businessNumber",type:s.dynamicInputs,gridWidth:12},{name:"caseNumber",required:!0,type:s.input,gridWidth:6},{name:"contractNumber",required:!0,type:s.input,gridWidth:6},{name:"ssnNumber",type:s.autocomplete,gridWidth:6,options:o},{name:"package",type:s.autocomplete,gridWidth:6,options:c},{name:"phoneNumbers",subfieldName:"phoneNumber",type:s.dynamicInputs,gridWidth:12},{name:"address",type:s.input,gridWidth:6},{name:"email",type:s.input,gridWidth:6},{name:"zipCode",type:s.input,gridWidth:6,format:/^\d{6}$/},{name:"city",type:s.autocomplete,gridWidth:6,options:l},{name:"lawyer",type:s.autocomplete,gridWidth:6,options:t},{name:"court",type:s.autocomplete,gridWidth:6,options:n},{name:"client",required:!0,type:s.autocomplete,gridWidth:6,options:i},{name:"enteringDate",type:s.datepicker,gridWidth:6},{name:"lawyerHandOverDate",type:s.datepicker,gridWidth:6},{name:"closingDate",type:s.datepicker,gridWidth:6},{name:"status",type:s.input,gridWidth:6},{name:"oldPayment",type:s.input,gridWidth:6,format:/^[\d 0-9.]{0,24}$/},{name:"ourTaxes",type:s.input,gridWidth:6,format:/^[\d 0-9.]{0,24}$/},{name:"warningPrice",type:s.input,gridWidth:6,format:/^[\d 0-9.]{0,24}$/},{name:"comment",type:s.textArea,gridWidth:6},{name:"limitationObjection",type:s.checkbox,gridWidth:6}],na=async e=>{let t;if(e){try{t=await R({method:"get",url:`api/case/${e}`,withCredentials:!0})}catch{t={data:{error:500,message:"errors.serverError"}}}return t}return{data:{error:400,message:"errors.notFound"}}},oa=e=>K(["case",e],()=>na(e),{keepPreviousData:!1,refetchOnMount:!0,refetchOnWindowFocus:!1,select(t){if(t.data.data)return Tt(t.data.data)}}),ra=()=>{const{t:e}=q(),{state:{isLegalEntity:t,editCaseForm:i,editCaseAutocompleteValues:n,editCaseId:o},dispatch:c}=Y(),{data:l,isLoading:u,isSuccess:h}=oa(o);H.useEffect(()=>{h&&(l!=null&&l.caseNumber)&&c({type:m.setCaseFormData,payload:l})},[l==null?void 0:l.caseNumber]);const{data:b}=Qe({search:n.city}),{data:C}=ve({search:n.client}),{data:v}=Ye({search:n.court}),{data:W}=Ge({search:n.executors}),{data:j}=He({search:n.lawyer}),{data:k}=Ke({search:n.package}),{data:F}=Xe({search:n.ssnNumber}),{data:N}=Je({search:n.employer}),r=(g,p,w)=>(S,$)=>{switch(p){case s.toggle:c({type:m.editCaseForm,payload:{editName:g,fieldEditValue:$}});break;case s.input:case s.textArea:const{value:E}=S==null?void 0:S.target;let _=E;w?_.match(w)&&c({type:m.editCaseForm,payload:{editName:g,fieldEditValue:_}}):c({type:m.editCaseForm,payload:{editName:g,fieldEditValue:_}});break;case s.checkbox:c({type:m.editCaseForm,payload:{editName:g,fieldEditValue:$}});break;case s.datepicker:c({type:m.editCaseForm,payload:{editName:g,fieldEditValue:S}});break;case s.dynamicInputs:c({type:m.editCaseForm,payload:{editName:g,fieldEditValue:S}});break;case s.autocomplete:c({type:m.editCaseForm,payload:{editName:g,fieldEditValue:$?ee($):""}});break;case s.dynamicAutocompletes:c({type:m.editCaseForm,payload:{editName:g,fieldEditValue:S.map(M=>ee(M))}});break}},x=()=>console.log("Submitted"),y=g=>{var L;const{name:p,type:w,gridClassName:S,formFieldClassName:$,gridWidth:E,labelPlacement:_,options:M,size:O,subfieldName:D,format:V,required:B}=g;switch(w){case s.toggle:return a.jsx(A,{className:S,item:!0,xs:E||12,children:a.jsx(ue,{required:B,className:$,value:t,onChange:r(p,w),control:a.jsx(Ue,{color:"primary"}),label:e(`entities.${p}`),labelPlacement:_})},p);case s.checkbox:return a.jsx(A,{className:S,item:!0,xs:E||12,children:a.jsx(ue,{required:B,control:a.jsx(Ne,{className:$,name:p,size:O??"small",checked:i[p],onChange:r(p,w)}),label:e(`entities.${p}`)})},p);case s.input:return a.jsx(A,{className:S,item:!0,xs:E||12,children:a.jsx(Z,{required:B,fullWidth:!0,className:$,size:O??"small",label:e(`entities.${p}`),name:p,value:i[p],onChange:r(p,w,V)})},p);case s.autocomplete:return a.jsx(A,{className:S,item:!0,xs:E||12,children:a.jsx(we,{isOptionEqualToValue:(f,z)=>f.id===z.id,fullWidth:!0,clearIcon:!1,className:$,options:M??[],getOptionLabel:f=>ee(f).name,size:O??"small",value:(L=i[p])!=null&&L.id?i[p]:null,onChange:r(p,w),renderInput:f=>a.jsx(Z,{...f,required:B,label:e(`entities.${p}`),onBlur:()=>c({type:m.editCaseAutocompleteValues,payload:{inputName:p,inputValue:""}}),onChange:je(z=>c({type:m.editCaseAutocompleteValues,payload:{inputName:p,inputValue:z.target.value}}),300)})})},p);case s.datepicker:return a.jsx(A,{className:S,item:!0,xs:E||12,children:a.jsx(Le,{dateAdapter:Ie,children:a.jsx(Pe,{localeText:{clearButtonLabel:e("clear")},label:e(`entities.${p}`),value:i[p],className:$,slotProps:{textField:{size:"small",fullWidth:!0,required:B},actionBar:{actions:["clear"]}},format:"DD. MM. YYYY",onChange:r(p,w)})})},p);case s.dynamicInputs:return a.jsx(A,{className:S,item:!0,xs:E||12,children:a.jsx(Ve,{limit:p==="phoneNumbers"?4:2,label:e(`entities.${p}`),inputProps:{label:e(`entities.${D}`),size:"small",fullWidth:!0},values:i[p],onValuesChange:r(p,w)})},p);case s.dynamicAutocompletes:return a.jsx(A,{className:S,item:!0,xs:E||12,children:a.jsx(Ze,{limit:p==="phoneNumbers"?4:2,options:M,label:e(`entities.${p}`),autocompleteProps:{size:"small",fullWidth:!0},inputProps:{label:e(`entities.${D}`)},values:i[p],onValuesChange:r(p,w),actionType:m.editCaseAutocompleteValues,name:p,updateState:c})},p);case s.textArea:return a.jsx(A,{className:S,item:!0,xs:E||12,children:a.jsx(Z,{required:B,fullWidth:!0,multiline:!0,className:$,size:O??"small",label:e(`entities.${p}`),name:p,rows:2,value:i[p],onChange:r(p,w,V)})},p);default:return""}},d=g=>{if(g){const p=Object.entries(g);return a.jsxs(ye,{className:"flex justify-between mb-10",children:[a.jsxs("span",{className:"text-xs",children:[e("entities.current_debt"),":"," ",It(i,g)]}),p.map(([w,S])=>S?a.jsxs("span",{className:"text-xs",children:[e(`entities.${w}`),": ",S]},w):"")]})}return""};return u||!i.caseNumber?a.jsx(U,{className:"flex justify-center items-center h-[1300px]",children:a.jsx(qe,{})}):a.jsxs(Q,{children:[h&&(l!=null&&l.transactions)?d(l.transactions):"",a.jsx(ye,{children:h&&i?a.jsx("form",{onSubmit:x,children:a.jsx(A,{container:!0,spacing:2,children:ia({citiesOptions:b,clientsOptions:C,courtsOptions:v,executorsOptions:W,lawyersOptions:j,packagesOptions:k,ssnNumbersOptions:F,employersOptions:N}).map(g=>(typeof g.condition!="boolean"||g.condition===i.legalEntity)&&(typeof g.secondCondition!="boolean"||g.secondCondition===i.employed)&&y(g))})}):""})]})},la=async e=>{let t;return t=await R({method:"delete",url:`api/case/${e}`,withCredentials:!0}),t},ca=(e,t,i)=>{const n=be();return pe(()=>la(i),{onSuccess:o=>(o.data.error||(t({type:m.resetCaseFormData}),t({type:m.openSuccessSnackbar,payload:!0}),e(),n.invalidateQueries({queryKey:["casesList"]})),o.data.message),onError:o=>{var c,l,u,h;return console.error(o),(l=(c=o==null?void 0:o.response)==null?void 0:c.data)!=null&&l.message&&t({type:m.openErrorSnackbar,payload:!0}),{error:o,message:((h=(u=o==null?void 0:o.response)==null?void 0:u.data)==null?void 0:h.message)||"Error has occured"}}})},da=e=>{var V,B,L,f;const{open:t,onClose:i}=e,{t:n}=q(),{state:{editedCaseFormData:o,editCaseId:c,confirmationDialogOpen:l,openSuccessSnackbar:u,openErrorSnackbar:h,addCaseModalOpen:b,editCaseModalOpen:C,exportCasesDialogOpen:v,importCasesDialogOpen:W},dispatch:j}=Y(),k=()=>{j({type:m.confirmationDialogOpen,payload:!1}),i()},{mutate:F,isLoading:N,data:r,error:x,isSuccess:y,isError:d,reset:g}=sa(i,j,c),{mutate:p,isLoading:w,data:S,error:$,isSuccess:E,isError:_,reset:M}=ca(k,j,c);H.useEffect(()=>{(b||C||v||W)&&(y&&g(),E&&M())},[b,C,v,W]);const O=d||_,D=x||$;return a.jsxs(Q,{children:[a.jsx(Re,{open:t,header:n("entities.editCase"),children:a.jsx(ra,{}),onClose:i,hasActionButton:!0,actionButtonText:"submit",hasCancelButton:!0,onSubmit:()=>F(Vt(o)),isLoading:N,hasCloseIconButton:!0,extraButtonText:"delete",hasExtraButton:!0,onExtraButtonClick:()=>j({type:m.confirmationDialogOpen,payload:!l})}),a.jsx(mt,{title:"entities.deleteCase",isLoading:w,open:l,onClose:()=>k(),onSubmit:()=>p()}),y&&(r!=null&&r.data.message)?a.jsx(G,{open:u,onClose:()=>j({type:m.openSuccessSnackbar,payload:!1}),severity:"success",content:r==null?void 0:r.data.message}):"",E&&(S!=null&&S.data.message)?a.jsx(G,{open:u,onClose:()=>j({type:m.openSuccessSnackbar,payload:!1}),severity:"success",content:S==null?void 0:S.data.message}):"",O&&((B=(V=D==null?void 0:D.response)==null?void 0:V.data)!=null&&B.message)?a.jsx(G,{open:h,onClose:()=>j({type:m.openErrorSnackbar,payload:!1}),severity:"error",content:(f=(L=D==null?void 0:D.response)==null?void 0:L.data)==null?void 0:f.message}):""]})},ua=()=>{const{state:{filterableByClient:e,pageable:t},dispatch:i}=Y(),{t:n}=q(),{data:o,isSuccess:c}=ve({});let l=[];c&&o&&(l=o.map(b=>Lt(b)));const u=[{id:9999,label:n("all"),value:9999},...l],h=b=>{i({type:m.filterableByClient,payload:b}),i({type:he.pageable,payload:{...t,page:1}})};return a.jsx(Q,{children:a.jsx(Se,{label:n("entities.client"),size:"small",options:u,value:e,onChange:h})})},pa=e=>{const{onClose:t,open:i,title:n,exportCSVButton:o,exportExcelButton:c,exportChecklist:l,className:u}=e,{t:h}=q();return a.jsx(Q,{children:a.jsxs(ht,{fullWidth:!0,className:`z-[9999] ${u}`,open:i,keepMounted:!0,onClose:t,"aria-describedby":"alert-dialog-slide-description",children:[a.jsx(yt,{children:h(n)}),a.jsxs(gt,{children:[a.jsx(U,{children:l?a.jsxs(a.Fragment,{children:[l,a.jsx(Be,{})]}):""}),a.jsx(bt,{id:"alert-dialog-slide-description",children:a.jsxs(ft,{className:"mx-10 mt-6 mb-2",direction:"row",justifyContent:"space-between",children:[a.jsx(U,{children:o}),a.jsx(U,{children:c})]})})]})]})})},Ae=e=>{const{icon:t,isLoading:i,text:n,disabled:o,onClick:c}=e,{t:l}=q();return a.jsx(Q,{children:a.jsx(de,{className:"w-52 h-16 flex justify-between items-center",variant:"contained",color:"info",startIcon:t||a.jsx(_t,{}),disabled:i||o,onClick:()=>c&&c(),children:a.jsx(U,{className:"w-full flex items-center justify-center",children:i?a.jsx(qe,{color:"inherit",size:24,thickness:4}):l(n)})})})},ma=async e=>{const{filter:t="active",clientsFilter:i=9999}=e;let n;if(n=await R({method:"post",url:"api/export-cases-list",data:{...e,filter:t===ce.all?"":t,clientsFilter:i===9999?"":i},withCredentials:!0}),!n.data.error){const o=n.data.data;if(o)if(typeof o=="object"&&o.type==="Buffer"&&Array.isArray(o.data)){const c=new Uint8Array(o.data);return new Blob([c])}else return new Blob([o])}},ha=e=>pe(t=>ma(t),{onError:t=>{var i,n,o,c;return console.error(t),(n=(i=t==null?void 0:t.response)==null?void 0:i.data)!=null&&n.message&&e({type:m.openErrorSnackbar,payload:!0}),{error:t,message:((c=(o=t==null?void 0:t.response)==null?void 0:o.data)==null?void 0:c.message)||"Error has occured"}}}),Me=[{name:"caseNumber",type:s.checkbox,gridWidth:4},{name:"contractNumber",type:s.checkbox,gridWidth:4},{name:"name",type:s.checkbox,gridWidth:4},{name:"isLegal",type:s.checkbox,gridWidth:4},{name:"package",type:s.checkbox,gridWidth:4},{name:"principal",type:s.checkbox,gridWidth:4},{name:"interest",type:s.checkbox,gridWidth:4},{name:"currentDebt",type:s.checkbox,gridWidth:4},{name:"cession",type:s.checkbox,gridWidth:4},{name:"state",type:s.checkbox,gridWidth:4},{name:"phoneNumbers",type:s.checkbox,gridWidth:4},{name:"zipCode",type:s.checkbox,gridWidth:4},{name:"city",type:s.checkbox,gridWidth:4},{name:"address",type:s.checkbox,gridWidth:4},{name:"employed",type:s.checkbox,gridWidth:4},{name:"employer",type:s.checkbox,gridWidth:4},{name:"jmbg_pib",type:s.checkbox,gridWidth:4},{name:"lawyer",type:s.checkbox,gridWidth:4},{name:"ssn",type:s.checkbox,gridWidth:4},{name:"executors",type:s.checkbox,gridWidth:4},{name:"businessNumbers",type:s.checkbox,gridWidth:4},{name:"status",type:s.checkbox,gridWidth:4},{name:"client",type:s.checkbox,gridWidth:4},{name:"court",type:s.checkbox,gridWidth:4},{name:"oldPayment",type:s.checkbox,gridWidth:4},{name:"ourTaxes",type:s.checkbox,gridWidth:4},{name:"warningPrice",type:s.checkbox,gridWidth:4},{name:"comment",type:s.checkbox,gridWidth:4},{name:"closingDate",type:s.checkbox,gridWidth:4},{name:"enteringDate",type:s.checkbox,gridWidth:4},{name:"lawyerHandOverDate",type:s.checkbox,gridWidth:4},{name:"limitationObjection",type:s.checkbox,gridWidth:4}],ya=()=>{const{t:e}=q(),{state:{casesExportChecklistValues:t},dispatch:i}=Y(),n=l=>(u,h)=>{i({type:m.casesExportChecklistValues,payload:{checkboxName:l,checkboxValue:h}})},o=l=>{const{name:u,type:h,gridWidth:b}=l;return h===s.checkbox?a.jsx(A,{item:!0,xs:b||4,children:a.jsx(ue,{control:a.jsx(Ne,{color:"info",name:u,size:"small",checked:t[u],onChange:n(u)}),label:e(`entities.${u}`)})},u):""},c=()=>Object.values(t).reduce((u,h)=>h?u+1:u,0)/Me.length>.5;return a.jsx(Q,{children:a.jsx(ye,{className:"mx-4 my-6",children:a.jsx("form",{children:a.jsxs(A,{container:!0,spacing:1,children:[Me.map(l=>o(l)),a.jsx(A,{item:!0,xs:12,children:a.jsx(de,{color:"info",onClick:()=>i({type:m.casesCheckUncheckAll,payload:!c()}),variant:c()?"outlined":"contained",className:"min-w-full mt-2",children:c()?e("unselectAll"):e("selectAll")})})]})})})})},ga=e=>{var d,g,p,w;const{open:t,onClose:i}=e,{t:n}=q(),{state:{searchable:o,filterable:c,filterableByClient:l,downloadFile:u,exportFileType:h,casesExportChecklistValues:b,openSuccessSnackbar:C,openErrorSnackbar:v},dispatch:W}=Y(),j=o.reduce((S,$)=>{const E=Te($);return{...S,...E}},{}),{data:k,isLoading:F,mutateAsync:N,error:r,isSuccess:x,isError:y}=ha(W);return H.useEffect(()=>{if(!F&&k){const S=window.URL.createObjectURL(k),$=document.createElement("a");$.href=S,$.download=`${n("entities.cases")} - ${lt().format("YYYY.MM.DD HH-mm")}${h==="excel"?".xlsx":".csv"}`,document.body.appendChild($),$.click(),window.URL.revokeObjectURL(S),x&&(W({type:m.openSuccessSnackbar,payload:!0}),setTimeout(()=>{i()},1500))}},[F,k]),a.jsxs(Q,{children:[a.jsx(pa,{title:"entities.exportCases",open:t,onClose:i,exportChecklist:a.jsx(ya,{}),exportCSVButton:a.jsx(Ae,{text:"exportCSV",isLoading:F,disabled:me(b).length===0,onClick:async()=>{W({type:m.exportFileType,payload:"csv"}),W({type:m.downloadFile,payload:!0}),await N({...j,filter:c,clientsFilter:l,fileType:"csv",downloadFile:u,checkedProps:me(b)})}}),exportExcelButton:a.jsx(Ae,{text:"exportExcel",isLoading:F,disabled:me(b).length===0,onClick:async()=>{W({type:m.exportFileType,payload:"excel"}),W({type:m.downloadFile,payload:!0}),await N({...j,filter:c,clientsFilter:l,fileType:"excel",downloadFile:u,checkedProps:me(b)})}})}),x&&k?a.jsx(G,{open:C,onClose:()=>W({type:m.openSuccessSnackbar,payload:!1}),severity:"success",content:"messages.fileExportSuccess"}):"",y&&((g=(d=r==null?void 0:r.response)==null?void 0:d.data)!=null&&g.message)?a.jsx(G,{open:v,onClose:()=>W({type:m.openErrorSnackbar,payload:!1}),severity:"error",content:(w=(p=r==null?void 0:r.response)==null?void 0:p.data)==null?void 0:w.message}):""]})},ba=async e=>{let t;const i=new FormData;return i.append("file",e),t=await R({method:"post",url:"api/import-cases-list",data:i,withCredentials:!0,headers:{"Content-Type":"multipart/form-data"}}),t},fa=(e,t)=>{const i=be();return pe(n=>ba(n),{onSuccess:n=>(n.data.error||(t({type:m.openSuccessSnackbar,payload:!0}),t({type:m.resetCaseFormData}),i.invalidateQueries({queryKey:["casesList"]}),setTimeout(()=>{e()},1500)),n.data.message),onError:n=>{var o,c,l,u;return console.error(n),(c=(o=n==null?void 0:n.response)==null?void 0:o.data)!=null&&c.message&&t({type:m.openErrorSnackbar,payload:!0}),{error:n,message:((u=(l=n==null?void 0:n.response)==null?void 0:l.data)==null?void 0:u.message)||"Error has occured"}}})},xa=e=>{var j,k,F,N;const{open:t,onClose:i}=e,{state:{casesFileForUpload:n,openSuccessSnackbar:o,openErrorSnackbar:c},dispatch:l}=Y(),{isLoading:u,mutateAsync:h,data:b,error:C,isError:v,isSuccess:W}=fa(i,l);return a.jsxs(Q,{children:[a.jsx(xt,{title:"entities.importCases",open:t,onClose:i,uploadComponent:a.jsx(Ct,{onFileUpload:r=>l({type:m.casesFileForUpload,payload:r}),onFileDelete:()=>l({type:m.resetCaseFormData})}),isLoading:u,file:n,onSubmitFile:()=>n&&h(n)}),W&&(b!=null&&b.data.message)?a.jsx(G,{open:o,onClose:()=>l({type:m.openSuccessSnackbar,payload:!1}),severity:"success",content:b==null?void 0:b.data.message}):"",v&&((k=(j=C==null?void 0:C.response)==null?void 0:j.data)!=null&&k.message)?a.jsx(G,{open:c,onClose:()=>l({type:m.openErrorSnackbar,payload:!1}),severity:"error",content:(N=(F=C==null?void 0:C.response)==null?void 0:F.data)==null?void 0:N.message}):""]})},Ca=()=>{const{state:{filterableMultiselect:e,pageable:t},dispatch:i}=Y(),{t:n}=q(),o=[{id:1,label:n("all"),value:"",disabled:!0},{id:2,label:n("entities.hasObjection"),value:"hasObjection"},{id:3,label:n("entities.hasPayments"),value:"hasPayments"}],c=l=>{l.length===0?i({type:m.filterableMultiselect,payload:[""]}):(l.length>1&&l.some(u=>u==="")&&(l=l.filter(u=>u!=="")),i({type:m.filterableMultiselect,payload:l})),i({type:he.pageable,payload:{...t,page:1}})};return a.jsx(Q,{children:a.jsx(Se,{className:"w-96",label:n("entities.hasObjectionPayments"),size:"small",options:o,value:e,onChange:c,multiple:!0})})},Wa=e=>{const{t}=q(),{state:{addCaseModalOpen:i,editCaseModalOpen:n,exportCasesDialogOpen:o,importCasesDialogOpen:c},dispatch:l}=Y(),u=()=>{l({type:m.addCaseModalOpen,payload:!1}),l({type:m.resetCaseFormData})},h=()=>{l({type:m.editCaseModalOpen,payload:!1}),l({type:m.resetCaseFormData})},b=()=>{l({type:m.exportCasesDialogOpen,payload:!1}),l({type:m.downloadFile,payload:!1})},C=()=>{l({type:m.importCasesDialogOpen,payload:!1}),l({type:m.resetCaseFormData})};return a.jsx(Q,{children:a.jsxs(H.Suspense,{fallback:"Loading....",children:[a.jsxs(U,{className:"my-2 flex justify-between",children:[a.jsxs(U,{className:"grid grid-flow-col gap-2",children:[a.jsx(ta,{}),a.jsx(ua,{}),a.jsx(Ca,{})]}),a.jsxs(U,{children:[a.jsx(de,{color:"success",onClick:()=>l({type:m.importCasesDialogOpen,payload:!c}),children:t("entities.importCases")}),a.jsx(de,{color:"info",onClick:()=>l({type:m.exportCasesDialogOpen,payload:!o}),children:t("entities.exportCases")}),a.jsx(de,{onClick:()=>l({type:m.addCaseModalOpen,payload:!i}),children:t("entities.addNewCase")})]})]}),a.jsx(Pt,{}),a.jsx(ea,{open:i,onClose:u}),a.jsx(da,{open:n,onClose:h}),o?a.jsx(ga,{open:o,onClose:b}):"",c?a.jsx(xa,{open:c,onClose:C}):""]})})};export{Wa as Cases};
