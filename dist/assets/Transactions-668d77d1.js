import{L as F,e as p,j as s,F as D,H as M}from"./index-6f850072.js";import{a as L,c as $,E as m,m as k,T as C}from"./transformData-fc9facda.js";import{a as V}from"./setupAxios-882f9868.js";const v=({amount:a,case_number:t,excerpt_number:n,payment_date:c,posting_method:l,type:r})=>({amount:a,caseNumber:t,excerptNumber:n,paymentDate:c,postingMethod:l,type:F.t(`entities.${r}`)}),w=async a=>{var i;const{sortBy:t="created_at",sort:n="asc",page:c=1,size:l=10}=a;let r;try{r=await V({method:"get",url:"api/transactions-list",params:{...a,sortBy:t===""?"created_at":$(t),sort:n===""?"asc":n,page:c,size:l},withCredentials:!0}),(i=r.data.data)!=null&&i.transactions&&(r.data.data.transactions=r.data.data.transactions.map(d=>v(d)))}catch{r={data:{error:500,message:"Connection problem"}}}return r},B=a=>L(["transactionsList",a],()=>w(a),{keepPreviousData:!0,refetchOnMount:!1,refetchOnWindowFocus:!1}),E=(a,t)=>{var n;switch(t.type){case m.sortable:return{...a,sortable:t.payload};case m.pageable:return{...a,pageable:t.payload};case m.searchable:const{key:c,value:l}=t.payload,r=(n=a.searchable)==null?void 0:n.map(i=>i.key===c?{...i,value:l}:i);return a.searchable.some(i=>i.key===c)||r.push({key:c,value:l}),{...a,searchable:r};default:return a}},y={sortable:{sort:"",sortBy:""},pageable:{page:1,size:10,totalNumber:null},searchable:[]},x=p.createContext({state:y,dispatch:()=>null}),P=({children:a})=>{const[t,n]=p.useReducer(E,y);return s.jsx(x.Provider,{value:{state:t,dispatch:n},children:a})},R=()=>p.useContext(x),o={type:"type",amount:"amount",postingMethod:"postingMethod",paymentDate:"paymentDate",caseNumber:"caseNumber",excerptNumber:"excerptNumber"},_=()=>{var h,b;const{t:a}=D(),{state:{sortable:{sort:t,sortBy:n},pageable:{page:c,size:l},searchable:r},dispatch:i}=R();let d={page:c,size:l,sort:t,sortBy:n};const g=r.reduce((e,f)=>{const N=k(f);return{...e,...N}},{}),{data:u,isLoading:S,refetch:T}=B({...d,...g}),j=p.useMemo(()=>[{accessorFn:e=>e.caseNumber,id:o.caseNumber,header:()=>s.jsx("span",{children:a(`entities.${[o.caseNumber]}`)}),cell:e=>e.getValue(),isSearchable:!0,isSortable:!0},{accessorFn:e=>e.excerptNumber,id:o.excerptNumber,header:()=>s.jsx("span",{children:a(`entities.${[o.excerptNumber]}`)}),cell:e=>e.getValue(),isSearchable:!0,isSortable:!0},{accessorFn:e=>e.amount,id:o.amount,header:()=>s.jsx("span",{children:a(`entities.${[o.amount]}`)}),cell:e=>e.getValue(),isSearchable:!0,isSortable:!0},{accessorFn:e=>e.type,id:o.type,header:()=>s.jsx("span",{children:a(`entities.${[o.type]}`)}),cell:e=>e.getValue(),isSortable:!0},{accessorFn:e=>e.postingMethod,id:o.postingMethod,header:()=>s.jsx("span",{children:a(`entities.${[o.postingMethod]}`)}),cell:e=>e.getValue(),isSearchable:!1,isSortable:!0},{accessorFn:e=>e.paymentDate,id:o.paymentDate,header:()=>s.jsx("span",{children:a(`entities.${[o.paymentDate]}`)}),cell:e=>e.getValue(),isSortable:!0}],[]);return S?s.jsx(s.Fragment,{children:"Loading..."}):s.jsx(C,{columns:j,data:(h=u==null?void 0:u.data.data)==null?void 0:h.transactions,hasSearch:!0,sort:t,sortBy:n,totalNumber:(b=u==null?void 0:u.data.data)==null?void 0:b.meta.total_number,page:c,size:l,updateState:i,refetch:T})},H=a=>s.jsx(M,{children:s.jsx(p.Suspense,{fallback:"Loading....",children:s.jsx(P,{children:s.jsx(_,{})})})});export{H as Transactions};
