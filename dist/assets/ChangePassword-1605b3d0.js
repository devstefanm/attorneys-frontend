import{b0 as W,E as n,b as q,a as z,j as e,c as F,r as O,B as U,I as P}from"./index-0fc86f99.js";import{u as $,s as G,S as H,T as C,I as S,B as J,a as k}from"./SnackbarNotification-fe22749b.js";import{V as _,a as E}from"./VisibilityOff-a861a11e.js";import{C as K}from"./CircularProgress-9f706af9.js";const Q=()=>{const o=localStorage.getItem("attorneys_access_token");if(o){const a=W(o);return a==null?void 0:a.id}return null},X=async(o,a)=>{let s;return s=await G({method:"put",url:`auth/change-password/${o}`,data:{newPassword:a},withCredentials:!0}),s},Y=(o,a)=>$(s=>X(o,s),{onSuccess:s=>(s.data.error||(a({type:n.openSuccessSnackbar,payload:!0}),a({type:n.reset_password_credentials})),s.data.message),onError:s=>{var i,c,l,t;return console.error(s),(c=(i=s==null?void 0:s.response)==null?void 0:i.data)!=null&&c.message&&a({type:n.openErrorSnackbar,payload:!0}),{error:s,message:((t=(l=s==null?void 0:s.response)==null?void 0:l.data)==null?void 0:t.message)||"Error has occured"}}}),ts=o=>{var x,b,f,j;const{state:{showNewPassword:a,showNewRepeatedPassword:s,changePasswordCredentials:i,openErrorSnackbar:c,openSuccessSnackbar:l},dispatch:t}=q(),{newPassword:p,newRepeatedPassword:h}=i,I=Q(),{t:u}=z(),{mutate:N,isLoading:m,data:r,error:d,isSuccess:v,isError:A}=Y(I,t),B=()=>t({type:n.show_new_password,payload:!a}),D=()=>t({type:n.show_new_repeated_password,payload:!s}),g=w=>{w.preventDefault()},y=w=>{const{name:T,value:L}=w.target,V={...i,[T]:L};t({type:n.change_password_credentials,payload:V})},M=()=>!!(p!==h||p.length===0||m),R=()=>{N(p)};return e.jsx(F,{children:e.jsxs(O.Suspense,{fallback:"Loading....",children:[e.jsx(U,{className:"flex justify-center",children:e.jsxs(H,{className:"w-96",children:[e.jsx(C,{margin:"normal",required:!0,fullWidth:!0,name:"newPassword",label:u("newPassword"),type:a?"text":"password",id:"password",autoComplete:"current-password",onChange:y,value:p,InputProps:{endAdornment:e.jsx(S,{position:"end",children:e.jsx(P,{"aria-label":"toggle password visibility",onClick:B,onMouseDown:g,children:a?e.jsx(_,{}):e.jsx(E,{})})})}}),e.jsx(C,{margin:"normal",required:!0,fullWidth:!0,name:"newRepeatedPassword",label:u("repeatNewPassword"),type:s?"text":"password",id:"password",autoComplete:"current-password",onChange:y,value:h,InputProps:{endAdornment:e.jsx(S,{position:"end",children:e.jsx(P,{"aria-label":"toggle password visibility",onClick:D,onMouseDown:g,children:s?e.jsx(_,{}):e.jsx(E,{})})})}}),e.jsx(J,{disabled:M(),className:"mt-8",size:"large",type:"submit",fullWidth:!0,variant:"contained",onClick:R,children:m?e.jsx(K,{size:24,thickness:4}):u("changePassword")})]})}),v&&(r!=null&&r.data.message)?e.jsx(k,{open:l,onClose:()=>t({type:n.openSuccessSnackbar,payload:!1}),severity:"success",content:r==null?void 0:r.data.message}):"",A&&((b=(x=d==null?void 0:d.response)==null?void 0:x.data)!=null&&b.message)?e.jsx(k,{open:c,onClose:()=>t({type:n.openErrorSnackbar,payload:!1}),severity:"error",content:(j=(f=d==null?void 0:d.response)==null?void 0:f.data)==null?void 0:j.message}):""]})})};export{ts as ChangePassword};
