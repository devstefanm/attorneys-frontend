import{a as F,a9 as S,r as D,j as e,aa as k,x as p,E as w,ab as j,y as A,ac as g,B as N}from"./index-a59700e2.js";import{a as $,c as V,m as z,T as E,C as W,G as y,L as P,A as Y,b as I,F as Q,e as _,M as q}from"./AdapterMoment-1f717f9b.js";import{s as B,T as R,u as G,B as M}from"./setupAxios-41eb1db7.js";import{D as K}from"./DynamicInputs-fcabbf9d.js";const H=({case_count:a,court:s})=>({numberOfCases:a,court:s}),v=async a=>{var i;const{sortBy:s="created_at",sort:o="desc",page:r=1,size:u=25}=a;let c;try{c=await B({method:"get",url:"api/courts-list",params:{...a,sortBy:s===""?"created_at":V(s),sort:o===""?"asc":o,page:r,size:u},withCredentials:!0}),(i=c.data.data)!=null&&i.courts&&(c.data.data.courts=c.data.data.courts.map(t=>H(t)))}catch{c={data:{error:500,message:"Connection problem"}}}return c},J=a=>$(["courtsList",a],()=>v(a),{keepPreviousData:!0,refetchOnMount:!1,refetchOnWindowFocus:!1}),U=()=>"#6b7280",X=({name:a})=>({name:a}),O={court:"court",numberOfCases:"numberOfCases"},Z=()=>{var b,x;const{t:a}=F(),{state:{sortable:{sort:s,sortBy:o},pageable:{page:r,size:u},searchable:c},dispatch:i}=S();let t={page:r,size:u,sort:s,sortBy:o};const d=c.reduce((l,L)=>{const T=z(L);return{...l,...T}},{}),{data:n,isLoading:C,refetch:m}=J({...t,...d}),h=D.useMemo(()=>[{accessorFn:l=>l.court,id:O.court,header:()=>e.jsx("span",{children:a(`entities.${[O.court]}`)}),cell:l=>l.getValue(),isSearchable:!0,isSortable:!0},{accessorFn:l=>l.numberOfCases,id:O.numberOfCases,header:()=>e.jsx("span",{children:a(`entities.${[O.numberOfCases]}`)}),cell:l=>l.getValue(),isSortable:!0}],[]);return C?e.jsx(e.Fragment,{children:"Loading..."}):e.jsx(E,{columns:h,data:(b=n==null?void 0:n.data.data)==null?void 0:b.courts,hasSearch:!0,sort:s,sortBy:o,totalNumber:(x=n==null?void 0:n.data.data)==null?void 0:x.meta.total_number,page:r,size:u,borderKeyword:"type",updateState:i,refetch:m,mapBorderColors:U})},ee=({debtor_count:a,executor_count:s,lawyer_count:o,city:r})=>({numberOfDebtors:a,numberOfExecutors:s,numberOfLawyers:o,city:r}),te=async a=>{var i;const{sortBy:s="created_at",sort:o="desc",page:r=1,size:u=25}=a;let c;try{c=await B({method:"get",url:"api/cities-list",params:{...a,sortBy:s===""?"created_at":V(s),sort:o===""?"asc":o,page:r,size:u},withCredentials:!0}),(i=c.data.data)!=null&&i.cities&&(c.data.data.cities=c.data.data.cities.map(t=>ee(t)))}catch{c={data:{error:500,message:"Connection problem"}}}return c},ae=a=>$(["citiesList",a],()=>te(a),{keepPreviousData:!0,refetchOnMount:!1,refetchOnWindowFocus:!1}),se=()=>"#6b7280",re=({name:a})=>({name:a}),f={city:"city",numberOfDebtors:"numberOfDebtors",numberOfExecutors:"numberOfExecutors",numberOfLawyers:"numberOfLawyers"},oe=()=>{var b,x;const{t:a}=F(),{state:{sortable:{sort:s,sortBy:o},pageable:{page:r,size:u},searchable:c},dispatch:i}=k();let t={page:r,size:u,sort:s,sortBy:o};const d=c.reduce((l,L)=>{const T=z(L);return{...l,...T}},{}),{data:n,isLoading:C,refetch:m}=ae({...t,...d}),h=D.useMemo(()=>[{accessorFn:l=>l.city,id:f.city,header:()=>e.jsx("span",{children:a(`entities.${[f.city]}`)}),cell:l=>l.getValue(),isSearchable:!0,isSortable:!0},{accessorFn:l=>l.numberOfDebtors,id:f.numberOfDebtors,header:()=>e.jsx("span",{children:a(`entities.${[f.numberOfDebtors]}`)}),cell:l=>l.getValue(),isSortable:!0},{accessorFn:l=>l.numberOfExecutors,id:f.numberOfExecutors,header:()=>e.jsx("span",{children:a(`entities.${[f.numberOfExecutors]}`)}),cell:l=>l.getValue(),isSortable:!0},{accessorFn:l=>l.numberOfLawyers,id:f.numberOfLawyers,header:()=>e.jsx("span",{children:a(`entities.${[f.numberOfLawyers]}`)}),cell:l=>l.getValue(),isSortable:!0}],[]);return C?e.jsx(e.Fragment,{children:"Loading..."}):e.jsx(E,{columns:h,data:(b=n==null?void 0:n.data.data)==null?void 0:b.cities,hasSearch:!0,sort:s,sortBy:o,totalNumber:(x=n==null?void 0:n.data.data)==null?void 0:x.meta.total_number,page:r,size:u,borderKeyword:"type",updateState:i,refetch:m,mapBorderColors:se})},ne=[{name:"name",type:p.input,gridWidth:12,condition:!1}],ie=()=>{const{t:a}=F(),{state:{addCourtForm:s},dispatch:o}=S(),r=(i,t,d)=>(n,C)=>{switch(t){case p.input:const{value:m}=n==null?void 0:n.target;let h=m;d?(h=m.replace(d,""),o({type:j.addCourtForm,payload:{name:i,fieldValue:h}})):o({type:j.addCourtForm,payload:{name:i,fieldValue:h}});break;case p.checkbox:o({type:j.addCourtForm,payload:{name:i,fieldValue:C}});break;case p.datepicker:o({type:j.addCourtForm,payload:{name:i,fieldValue:n}});break;case p.dynamicInputs:o({type:j.addCourtForm,payload:{name:i,fieldValue:n}});break}},u=()=>console.log("Submitted"),c=i=>{const{name:t,type:d,gridClassName:n,formFieldClassName:C,gridWidth:m,size:h,subfieldName:b,format:x}=i;switch(d){case p.checkbox:return e.jsx(y,{className:n,item:!0,xs:m||12,children:e.jsx(Q,{control:e.jsx(_,{className:C,name:t,size:h??"small",checked:s[t],onChange:r(t,d)}),label:a(`entities.${t}`)})},t);case p.input:return e.jsx(y,{className:n,item:!0,xs:m||12,children:e.jsx(R,{fullWidth:!0,className:C,size:h??"small",label:a(`entities.${t}`),name:t,value:s[t],onChange:r(t,d,x)})},t);case p.datepicker:return e.jsx(y,{className:n,item:!0,xs:m||12,children:e.jsx(P,{dateAdapter:Y,children:e.jsx(I,{label:a(`entities.${t}`),value:s[t],className:C,slotProps:{textField:{size:"small",fullWidth:!0},actionBar:{actions:["clear"]}},format:"DD. MM. YYYY",onChange:r(t,d)})})},t);case p.dynamicInputs:return e.jsx(y,{className:n,item:!0,xs:m||12,children:e.jsx(K,{label:a(`entities.${t}`),inputProps:{label:a(`entities.${b}`),size:"small",fullWidth:!0},values:s[t],onValuesChange:r(t,d)})},t);default:return""}};return e.jsx(w,{children:e.jsx(W,{children:e.jsx("form",{onSubmit:u,children:e.jsx(y,{container:!0,spacing:2,children:ne.map(i=>c(i))})})})})},ce=async a=>{let s;try{s=await B({method:"post",url:"api/courts",data:a,withCredentials:!0})}catch{s={data:{error:500,message:"Connection problem"}}}return s},le=(a,s)=>{const o=A();return G(r=>ce(r),{onSuccess:r=>(r.data.error||(s({type:j.resetCourtFormData}),a(),o.invalidateQueries({queryKey:["courtsList"]})),r.data.message),onError:r=>({error:r,message:"Connection problem"})})},de=a=>{const{open:s,onClose:o}=a,{t:r}=F(),{state:{addCourtForm:u},dispatch:c}=S(),{mutate:i,isLoading:t}=le(o,c);return e.jsx(w,{children:e.jsx(q,{open:s,header:r("entities.addNewCourt"),children:e.jsx(ie,{}),onClose:o,hasActionButton:!0,actionButtonText:"submit",hasCancelButton:!0,onSubmit:()=>i(X(u)),isLoading:t,hasCloseIconButton:!0})})},ue=[{name:"name",type:p.input,gridWidth:12,condition:!1}],me=()=>{const{t:a}=F(),{state:{addCityForm:s},dispatch:o}=k(),r=(i,t,d)=>(n,C)=>{switch(t){case p.input:const{value:m}=n==null?void 0:n.target;let h=m;d?(h=m.replace(d,""),o({type:g.addCityForm,payload:{name:i,fieldValue:h}})):o({type:g.addCityForm,payload:{name:i,fieldValue:h}});break;case p.checkbox:o({type:g.addCityForm,payload:{name:i,fieldValue:C}});break;case p.datepicker:o({type:g.addCityForm,payload:{name:i,fieldValue:n}});break;case p.dynamicInputs:o({type:g.addCityForm,payload:{name:i,fieldValue:n}});break}},u=()=>console.log("Submitted"),c=i=>{const{name:t,type:d,gridClassName:n,formFieldClassName:C,gridWidth:m,size:h,subfieldName:b,format:x}=i;switch(d){case p.checkbox:return e.jsx(y,{className:n,item:!0,xs:m||12,children:e.jsx(Q,{control:e.jsx(_,{className:C,name:t,size:h??"small",checked:s[t],onChange:r(t,d)}),label:a(`entities.${t}`)})},t);case p.input:return e.jsx(y,{className:n,item:!0,xs:m||12,children:e.jsx(R,{fullWidth:!0,className:C,size:h??"small",label:a(`entities.${t}`),name:t,value:s[t],onChange:r(t,d,x)})},t);case p.datepicker:return e.jsx(y,{className:n,item:!0,xs:m||12,children:e.jsx(P,{dateAdapter:Y,children:e.jsx(I,{label:a(`entities.${t}`),value:s[t],className:C,slotProps:{textField:{size:"small",fullWidth:!0},actionBar:{actions:["clear"]}},format:"DD. MM. YYYY",onChange:r(t,d)})})},t);case p.dynamicInputs:return e.jsx(y,{className:n,item:!0,xs:m||12,children:e.jsx(K,{label:a(`entities.${t}`),inputProps:{label:a(`entities.${b}`),size:"small",fullWidth:!0},values:s[t],onValuesChange:r(t,d)})},t);default:return""}};return e.jsx(w,{children:e.jsx(W,{children:e.jsx("form",{onSubmit:u,children:e.jsx(y,{container:!0,spacing:2,children:ue.map(i=>c(i))})})})})},pe=async a=>{let s;try{s=await B({method:"post",url:"api/cities",data:a,withCredentials:!0})}catch{s={data:{error:500,message:"Connection problem"}}}return s},he=(a,s)=>{const o=A();return G(r=>pe(r),{onSuccess:r=>(r.data.error||(s({type:g.resetCityFormData}),a(),o.invalidateQueries({queryKey:["citiesList"]})),r.data.message),onError:r=>({error:r,message:"Connection problem"})})},Ce=a=>{const{open:s,onClose:o}=a,{t:r}=F(),{state:{addCityForm:u},dispatch:c}=k(),{mutate:i,isLoading:t}=he(o,c);return e.jsx(w,{children:e.jsx(q,{open:s,header:r("entities.addNewCity"),children:e.jsx(me,{}),onClose:o,hasActionButton:!0,actionButtonText:"submit",hasCancelButton:!0,onSubmit:()=>i(re(u)),isLoading:t,hasCloseIconButton:!0})})},je=a=>{const{t:s}=F(),{state:{addCourtModalOpen:o},dispatch:r}=S(),{state:{addCityModalOpen:u},dispatch:c}=k();return e.jsx(w,{children:e.jsxs(D.Suspense,{fallback:"Loading....",children:[e.jsxs(N,{className:"flex flex-col lg:flex-row gap-4",children:[e.jsxs(N,{className:"w-full",children:[e.jsx(N,{className:"my-2 flex justify-end",children:e.jsx(M,{onClick:()=>r({type:j.addCourtModalOpen,payload:!o}),children:s("entities.addNewCourt")})}),e.jsx(Z,{})]}),e.jsxs(N,{className:"w-full",children:[e.jsx(N,{className:"my-2 flex justify-end",children:e.jsx(M,{onClick:()=>c({type:g.addCityModalOpen,payload:!u}),children:s("entities.addNewCity")})}),e.jsx(oe,{})]})]}),e.jsx(de,{open:o,onClose:()=>r({type:j.addCourtModalOpen,payload:!1})}),e.jsx(Ce,{open:u,onClose:()=>c({type:g.addCityModalOpen,payload:!1})})]})})};export{je as CourtsAndCities};
