import{a as k,a1 as P,r as O,j as e,a2 as w,x as p,E as j,a3 as x,y as L,a4 as y,B as f}from"./index-a59700e2.js";import{a as D,c as $,m as z,T as V,C as W,G as N,L as _,A as E,b as Y,F as I,e as Q,M as q}from"./AdapterMoment-1f717f9b.js";import{s as B,T as R,u as G,B as A}from"./setupAxios-41eb1db7.js";import{D as K}from"./DynamicInputs-fcabbf9d.js";const H=({ssn:s,case_count:t})=>({ssn:s,numberOfCases:t}),v=async s=>{var c;const{sortBy:t="created_at",sort:n="desc",page:r=1,size:i=25}=s;let l;try{l=await B({method:"get",url:"api/ssn-list",params:{...s,sortBy:t===""?"created_at":$(t),sort:n===""?"asc":n,page:r,size:i},withCredentials:!0}),(c=l.data.data)!=null&&c.ssn_numbers&&(l.data.data.ssn_numbers=l.data.data.ssn_numbers.map(a=>H(a)))}catch{l={data:{error:500,message:"Connection problem"}}}return l},J=s=>D(["ssnNumbersList",s],()=>v(s),{keepPreviousData:!0,refetchOnMount:!1,refetchOnWindowFocus:!1}),U=()=>"#6b7280",X=({ssnNumber:s})=>({ssn:s}),C={ssn:"ssn",numberOfCases:"numberOfCases"},Z=()=>{var g,S;const{t:s}=k(),{state:{sortable:{sort:t,sortBy:n},pageable:{page:r,size:i},searchable:l},dispatch:c}=P();let a={page:r,size:i,sort:t,sortBy:n};const d=l.reduce((m,T)=>{const M=z(T);return{...m,...M}},{}),{data:o,isLoading:h,refetch:u}=J({...a,...d}),b=O.useMemo(()=>[{accessorFn:m=>m.ssn,id:C.ssn,header:()=>e.jsx("span",{children:s(`entities.${[C.ssn]}`)}),cell:m=>m.getValue(),isSearchable:!0,isSortable:!0},{accessorFn:m=>m.numberOfCases,id:C.numberOfCases,header:()=>e.jsx("span",{children:s(`entities.${[C.numberOfCases]}`)}),cell:m=>m.getValue(),isSortable:!0}],[]);return h?e.jsx(e.Fragment,{children:"Loading..."}):e.jsx(V,{columns:b,data:(g=o==null?void 0:o.data.data)==null?void 0:g.ssn_numbers,hasSearch:!0,sort:t,sortBy:n,totalNumber:(S=o==null?void 0:o.data.data)==null?void 0:S.meta.total_number,page:r,size:i,borderKeyword:"type",updateState:c,refetch:u,mapBorderColors:U})},ee=({case_count:s,package_name:t})=>({numberOfCases:s,packageName:t}),ae=async s=>{var c;const{sortBy:t="created_at",sort:n="desc",page:r=1,size:i=25}=s;let l;try{l=await B({method:"get",url:"api/packages-list",params:{...s,sortBy:t===""?"created_at":$(t),sort:n===""?"asc":n,page:r,size:i},withCredentials:!0}),(c=l.data.data)!=null&&c.packages&&(l.data.data.packages=l.data.data.packages.map(a=>ee(a)))}catch{l={data:{error:500,message:"Connection problem"}}}return l},se=s=>D(["packagesList",s],()=>ae(s),{keepPreviousData:!0,refetchOnMount:!1,refetchOnWindowFocus:!1}),te=()=>"#6b7280",re=({packageName:s})=>({package_name:s}),F={packageName:"packageName",numberOfCases:"numberOfCases"},ne=()=>{var g,S;const{t:s}=k(),{state:{sortable:{sort:t,sortBy:n},pageable:{page:r,size:i},searchable:l},dispatch:c}=w();let a={page:r,size:i,sort:t,sortBy:n};const d=l.reduce((m,T)=>{const M=z(T);return{...m,...M}},{}),{data:o,isLoading:h,refetch:u}=se({...a,...d}),b=O.useMemo(()=>[{accessorFn:m=>m.packageName,id:F.packageName,header:()=>e.jsx("span",{children:s(`entities.${[F.packageName]}`)}),cell:m=>m.getValue(),isSearchable:!0,isSortable:!0},{accessorFn:m=>m.numberOfCases,id:F.numberOfCases,header:()=>e.jsx("span",{children:s(`entities.${[F.numberOfCases]}`)}),cell:m=>m.getValue(),isSortable:!0}],[]);return h?e.jsx(e.Fragment,{children:"Loading..."}):e.jsx(V,{columns:b,data:(g=o==null?void 0:o.data.data)==null?void 0:g.packages,hasSearch:!0,sort:t,sortBy:n,totalNumber:(S=o==null?void 0:o.data.data)==null?void 0:S.meta.total_number,page:r,size:i,borderKeyword:"type",updateState:c,refetch:u,mapBorderColors:te})},oe=[{name:"ssnNumber",type:p.input,gridWidth:12,condition:!1}],ce=()=>{const{t:s}=k(),{state:{addSSNNumberForm:t},dispatch:n}=P(),r=(c,a,d)=>(o,h)=>{switch(a){case p.input:const{value:u}=o==null?void 0:o.target;let b=u;d?(b=u.replace(d,""),n({type:x.addSSNNumberForm,payload:{name:c,fieldValue:b}})):n({type:x.addSSNNumberForm,payload:{name:c,fieldValue:b}});break;case p.checkbox:n({type:x.addSSNNumberForm,payload:{name:c,fieldValue:h}});break;case p.datepicker:n({type:x.addSSNNumberForm,payload:{name:c,fieldValue:o}});break;case p.dynamicInputs:n({type:x.addSSNNumberForm,payload:{name:c,fieldValue:o}});break}},i=()=>console.log("Submitted"),l=c=>{const{name:a,type:d,gridClassName:o,formFieldClassName:h,gridWidth:u,size:b,subfieldName:g,format:S}=c;switch(d){case p.checkbox:return e.jsx(N,{className:o,item:!0,xs:u||12,children:e.jsx(I,{control:e.jsx(Q,{className:h,name:a,size:b??"small",checked:t[a],onChange:r(a,d)}),label:s(`entities.${a}`)})},a);case p.input:return e.jsx(N,{className:o,item:!0,xs:u||12,children:e.jsx(R,{fullWidth:!0,className:h,size:b??"small",label:s(`entities.${a}`),name:a,value:t[a],onChange:r(a,d,S)})},a);case p.datepicker:return e.jsx(N,{className:o,item:!0,xs:u||12,children:e.jsx(_,{dateAdapter:E,children:e.jsx(Y,{label:s(`entities.${a}`),value:t[a],className:h,slotProps:{textField:{size:"small",fullWidth:!0},actionBar:{actions:["clear"]}},format:"DD. MM. YYYY",onChange:r(a,d)})})},a);case p.dynamicInputs:return e.jsx(N,{className:o,item:!0,xs:u||12,children:e.jsx(K,{label:s(`entities.${a}`),inputProps:{label:s(`entities.${g}`),size:"small",fullWidth:!0},values:t[a],onValuesChange:r(a,d)})},a);default:return""}};return e.jsx(j,{children:e.jsx(W,{children:e.jsx("form",{onSubmit:i,children:e.jsx(N,{container:!0,spacing:2,children:oe.map(c=>l(c))})})})})},le=async s=>{let t;try{t=await B({method:"post",url:"api/ssn",data:s,withCredentials:!0})}catch{t={data:{error:500,message:"Connection problem"}}}return t},de=(s,t)=>{const n=L();return G(r=>le(r),{onSuccess:r=>(r.data.error||(t({type:x.resetSSNNumberFormData}),s(),n.invalidateQueries({queryKey:["ssnNumbersList"]})),r.data.message),onError:r=>({error:r,message:"Connection problem"})})},ie=s=>{const{open:t,onClose:n}=s,{t:r}=k(),{state:{addSSNNumberForm:i},dispatch:l}=P(),{mutate:c,isLoading:a}=de(n,l);return e.jsx(j,{children:e.jsx(q,{open:t,header:r("entities.addNewSSNNumber"),children:e.jsx(ce,{}),onClose:n,hasActionButton:!0,actionButtonText:"submit",hasCancelButton:!0,onSubmit:()=>c(X(i)),isLoading:a,hasCloseIconButton:!0})})},ue=[{name:"packageName",type:p.input,gridWidth:12,condition:!1}],me=()=>{const{t:s}=k(),{state:{addPackageForm:t},dispatch:n}=w(),r=(c,a,d)=>(o,h)=>{switch(a){case p.input:const{value:u}=o==null?void 0:o.target;let b=u;d?(b=u.replace(d,""),n({type:y.addPackageForm,payload:{name:c,fieldValue:b}})):n({type:y.addPackageForm,payload:{name:c,fieldValue:b}});break;case p.checkbox:n({type:y.addPackageForm,payload:{name:c,fieldValue:h}});break;case p.datepicker:n({type:y.addPackageForm,payload:{name:c,fieldValue:o}});break;case p.dynamicInputs:n({type:y.addPackageForm,payload:{name:c,fieldValue:o}});break}},i=()=>console.log("Submitted"),l=c=>{const{name:a,type:d,gridClassName:o,formFieldClassName:h,gridWidth:u,size:b,subfieldName:g,format:S}=c;switch(d){case p.checkbox:return e.jsx(N,{className:o,item:!0,xs:u||12,children:e.jsx(I,{control:e.jsx(Q,{className:h,name:a,size:b??"small",checked:t[a],onChange:r(a,d)}),label:s(`entities.${a}`)})},a);case p.input:return e.jsx(N,{className:o,item:!0,xs:u||12,children:e.jsx(R,{fullWidth:!0,className:h,size:b??"small",label:s(`entities.${a}`),name:a,value:t[a],onChange:r(a,d,S)})},a);case p.datepicker:return e.jsx(N,{className:o,item:!0,xs:u||12,children:e.jsx(_,{dateAdapter:E,children:e.jsx(Y,{label:s(`entities.${a}`),value:t[a],className:h,slotProps:{textField:{size:"small",fullWidth:!0},actionBar:{actions:["clear"]}},format:"DD. MM. YYYY",onChange:r(a,d)})})},a);case p.dynamicInputs:return e.jsx(N,{className:o,item:!0,xs:u||12,children:e.jsx(K,{label:s(`entities.${a}`),inputProps:{label:s(`entities.${g}`),size:"small",fullWidth:!0},values:t[a],onValuesChange:r(a,d)})},a);default:return""}};return e.jsx(j,{children:e.jsx(W,{children:e.jsx("form",{onSubmit:i,children:e.jsx(N,{container:!0,spacing:2,children:ue.map(c=>l(c))})})})})},pe=async s=>{let t;try{t=await B({method:"post",url:"api/packages",data:s,withCredentials:!0})}catch{t={data:{error:500,message:"Connection problem"}}}return t},be=(s,t)=>{const n=L();return G(r=>pe(r),{onSuccess:r=>(r.data.error||(t({type:y.resetPackageFormData}),s(),n.invalidateQueries({queryKey:["packagesList"]})),r.data.message),onError:r=>({error:r,message:"Connection problem"})})},he=s=>{const{open:t,onClose:n}=s,{t:r}=k(),{state:{addPackageForm:i},dispatch:l}=w(),{mutate:c,isLoading:a}=be(n,l);return e.jsx(j,{children:e.jsx(q,{open:t,header:r("entities.addNewPackage"),children:e.jsx(me,{}),onClose:n,hasActionButton:!0,actionButtonText:"submit",hasCancelButton:!0,onSubmit:()=>c(re(i)),isLoading:a,hasCloseIconButton:!0})})},ye=s=>{const{t}=k(),{state:{addSSNNumberModalOpen:n},dispatch:r}=P(),{state:{addPackageModalOpen:i},dispatch:l}=w();return e.jsx(j,{children:e.jsxs(O.Suspense,{fallback:"Loading....",children:[e.jsxs(f,{className:"flex flex-col lg:flex-row gap-4",children:[e.jsxs(f,{className:"w-full",children:[e.jsx(f,{className:"my-2 flex justify-end",children:e.jsx(A,{onClick:()=>r({type:x.addSSNNumberModalOpen,payload:!n}),children:t("entities.addNewSSNNumber")})}),e.jsx(Z,{})]}),e.jsxs(f,{className:"w-full",children:[e.jsx(f,{className:"my-2 flex justify-end",children:e.jsx(A,{onClick:()=>l({type:y.addPackageModalOpen,payload:!i}),children:t("entities.addNewPackage")})}),e.jsx(ne,{})]})]}),e.jsx(ie,{open:n,onClose:()=>r({type:x.addSSNNumberModalOpen,payload:!1})}),e.jsx(he,{open:i,onClose:()=>l({type:y.addPackageModalOpen,payload:!1})})]})})};export{ye as SSNNumbersAndPackages};
