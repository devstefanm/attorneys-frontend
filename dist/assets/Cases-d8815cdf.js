import{g as Je,e as Ze,s as ge,f as oe,_ as re,h as _e,i as et,k as tt,r as G,m as at,n as st,j as a,o as it,p as nt,c as Me,q as ce,a as Q,t as q,v as m,w as s,B as X,D as ot,I as Oe,E as U,x as be,y as he,z as rt}from"./index-8fcced7b.js";import{S as lt,u as H,a as K,c as Be,t as le,r as ne,m as Te,T as ct,R as dt,A as ut,d as ke,C as ye,G as A,D as Ve,L as ze,b as Le,e as Ie,F as de,f as je,M as Pe,g as Y,h as pt,i as mt}from"./ConfirmationDialog-f41fe5ee.js";import{s as R,T as Z,u as ue,B as me}from"./setupAxios-fb948032.js";import{u as Re}from"./useGetCitiesNamesQuery-e84c656d.js";import{A as Ne}from"./Autocomplete-ac7aa55f.js";import{F as we,E as ht,a as De,I as yt,b as gt}from"./FileUpload-26f8fe23.js";function bt(e){return Ze("MuiSwitch",e)}const ft=Je("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]),P=ft,xt=["className","color","edge","size","sx"],Ct=e=>{const{classes:t,edge:i,size:n,color:o,checked:d,disabled:l}=e,u={root:["root",i&&`edge${oe(i)}`,`size${oe(n)}`],switchBase:["switchBase",`color${oe(o)}`,d&&"checked",l&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},y=nt(u,bt,t);return re({},t,y)},kt=ge("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,i.edge&&t[`edge${oe(i.edge)}`],t[`size${oe(i.size)}`]]}})(({ownerState:e})=>re({display:"inline-flex",width:34+12*2,height:14+12*2,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"}},e.edge==="start"&&{marginLeft:-8},e.edge==="end"&&{marginRight:-8},e.size==="small"&&{width:40,height:24,padding:7,[`& .${P.thumb}`]:{width:16,height:16},[`& .${P.switchBase}`]:{padding:4,[`&.${P.checked}`]:{transform:"translateX(16px)"}}})),jt=ge(lt,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.switchBase,{[`& .${P.input}`]:t.input},i.color!=="default"&&t[`color${oe(i.color)}`]]}})(({theme:e})=>({position:"absolute",top:0,left:0,zIndex:1,color:e.vars?e.vars.palette.Switch.defaultColor:`${e.palette.mode==="light"?e.palette.common.white:e.palette.grey[300]}`,transition:e.transitions.create(["left","transform"],{duration:e.transitions.duration.shortest}),[`&.${P.checked}`]:{transform:"translateX(20px)"},[`&.${P.disabled}`]:{color:e.vars?e.vars.palette.Switch.defaultDisabledColor:`${e.palette.mode==="light"?e.palette.grey[100]:e.palette.grey[600]}`},[`&.${P.checked} + .${P.track}`]:{opacity:.5},[`&.${P.disabled} + .${P.track}`]:{opacity:e.vars?e.vars.opacity.switchTrackDisabled:`${e.palette.mode==="light"?.12:.2}`},[`& .${P.input}`]:{left:"-100%",width:"300%"}}),({theme:e,ownerState:t})=>re({"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:_e(e.palette.action.active,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},t.color!=="default"&&{[`&.${P.checked}`]:{color:(e.vars||e).palette[t.color].main,"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette[t.color].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:_e(e.palette[t.color].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${P.disabled}`]:{color:e.vars?e.vars.palette.Switch[`${t.color}DisabledColor`]:`${e.palette.mode==="light"?et(e.palette[t.color].main,.62):tt(e.palette[t.color].main,.55)}`}},[`&.${P.checked} + .${P.track}`]:{backgroundColor:(e.vars||e).palette[t.color].main}})),Nt=ge("span",{name:"MuiSwitch",slot:"Track",overridesResolver:(e,t)=>t.track})(({theme:e})=>({height:"100%",width:"100%",borderRadius:14/2,zIndex:-1,transition:e.transitions.create(["opacity","background-color"],{duration:e.transitions.duration.shortest}),backgroundColor:e.vars?e.vars.palette.common.onBackground:`${e.palette.mode==="light"?e.palette.common.black:e.palette.common.white}`,opacity:e.vars?e.vars.opacity.switchTrack:`${e.palette.mode==="light"?.38:.3}`})),wt=ge("span",{name:"MuiSwitch",slot:"Thumb",overridesResolver:(e,t)=>t.thumb})(({theme:e})=>({boxShadow:(e.vars||e).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"})),St=G.forwardRef(function(t,i){const n=at({props:t,name:"MuiSwitch"}),{className:o,color:d="primary",edge:l=!1,size:u="medium",sx:y}=n,b=st(n,xt),C=re({},n,{color:d,edge:l,size:u}),v=Ct(C),W=a.jsx(wt,{className:v.thumb,ownerState:C});return a.jsxs(kt,{className:it(v.root,o),sx:y,ownerState:C,children:[a.jsx(jt,re({type:"checkbox",icon:W,checkedIcon:W,ref:i,ownerState:C},b,{classes:re({},v,{root:v.switchBase})})),a.jsx(Nt,{className:v.track,ownerState:C})]})}),qe=St,vt=Me(a.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8 0-1.85.63-3.55 1.69-4.9L16.9 18.31C15.55 19.37 13.85 20 12 20zm6.31-3.1L7.1 5.69C8.45 4.63 10.15 4 12 4c4.42 0 8 3.58 8 8 0 1.85-.63 3.55-1.69 4.9z"}),"DoNotDisturb"),Wt=Me(a.jsx("path",{d:"M22 5.18 10.59 16.6l-4.24-4.24 1.41-1.41 2.83 2.83 10-10L22 5.18zm-2.21 5.04c.13.57.21 1.17.21 1.78 0 4.42-3.58 8-8 8s-8-3.58-8-8 3.58-8 8-8c1.58 0 3.04.46 4.28 1.25l1.44-1.44C16.1 2.67 14.13 2 12 2 6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10c0-1.19-.22-2.33-.6-3.39l-1.61 1.61z"}),"TaskAlt"),Ft=({id:e,first_name:t,last_name:i,case_number:n,contract_number:o,jmbg:d,pib:l,name:u,executors:y,lawyer_first_name:b,lawyer_last_name:C,lawyer_office_name:v,state:W,ssn:j,package:k,business_numbers:F,cession:N,principal:r,interest:x})=>({id:e,name:u?H(u):`${t?H(t):""} ${i?H(i):""}`,jmbg_pib:d||""||l||"",caseNumber:n,contractNumber:o,executors:y,lawyer:v?`${b?H(b):""} ${C?H(C):""} (${H(v)})`:`${b?H(b):""} ${C?H(C):""}`,ssn:j??"",package:k??"",state:W,businessNumbers:F,cession:N?a.jsx(Wt,{color:"success"}):a.jsx(vt,{color:"error"}),principal:r,interest:x}),$t=async e=>{var y;const{sortBy:t="created_at",sort:i="desc",page:n=1,size:o=25,filter:d="active",clientsFilter:l=9999}=e;let u;try{u=await R({method:"get",url:"api/cases-list",params:{...e,sortBy:t===""?"created_at":Be(t),sort:i===""?"asc":i,page:n,size:o,filter:d===ce.all?"":d,clientsFilter:l===9999?"":l},withCredentials:!0}),(y=u.data.data)!=null&&y.cases&&(u.data.data.cases=u.data.data.cases.map(b=>Ft(b)))}catch{u={data:{error:500,message:"Connection problem"}}}return u},Et=e=>K(["casesList",e],()=>$t(e),{keepPreviousData:!0,refetchOnMount:!1,refetchOnWindowFocus:!1}),_t=e=>{switch(e){case"active":return"#22c55e";case"closed":return"#9ca3af";default:return""}},ee=e=>{const{id:t,first_name:i,last_name:n,name:o,package_name:d,ssn:l}=e;let u="";return o&&(u=o),i&&(u=`${i} ${n??""}`),d&&(u=d),l&&(u=l),{id:t,name:u}},Ot=({address:e,businessNumbers:t,caseNumber:i,cession:n,city:o,client:d,closingDate:l,contractNumber:u,court:y,email:b,employed:C,employer:v,executors:W,firstName:j,interest:k,jmbg:F,lastName:N,lawyer:r,legalEntity:x,name:h,package:c,phoneNumbers:g,pib:p,principal:w,ssnNumber:S,zipCode:$,status:E,oldPayment:_,ourTaxes:M,warningPrice:O,enteringDate:D,lawyerHandOverDate:z,comment:B,limitationObjection:L})=>{let f=null,T=null,te=null,ae=[],se=null,ie=null,I=null,fe=null,ve=null,xe=null,Ce=null;typeof o!="string"&&(f=o.id),typeof d!="string"&&(T=d.id),typeof y!="string"&&(te=y.id),typeof W!==null&&(ae=W.map(J=>J.id).filter(J=>J!==null)),typeof r!="string"&&(se=r.id),typeof S!="string"&&(ie=S.id),typeof c!="string"&&(I=c.id),typeof v!="string"&&(ve=v==null?void 0:v.id),l&&(fe=le(l)),D&&(xe=le(D)),z&&(Ce=le(z));const We=i,Fe=u,$e=g.filter(J=>J.length>5),Ee=t.filter(J=>J.length>0);return x?{name:h,pib:p,address:e,cession:n,email:b,zip_code:$,case_number:We,contract_number:Fe,principal:Number(w),interest:Number(k),city_id:f,client_id:T,court_id:te,executor_ids:ae,lawyer_id:se,ssn_number_id:ie,package_id:I,phone_numbers:$e,business_numbers:Ee,closing_date:fe,status:E,old_payment:_?Number(_):null,our_taxes:M?Number(M):null,warning_price:O?Number(O):null,entering_date:xe,lawyer_hand_over_date:Ce,comment:B,limitation_objection:L}:{first_name:j,last_name:N,employed:C,employer_id:ve,jmbg:F,address:e,cession:n,email:b,zip_code:$,case_number:We,contract_number:Fe,principal:Number(w),interest:Number(k),city_id:f,client_id:T,court_id:te,executor_ids:ae,lawyer_id:se,ssn_number_id:ie,package_id:I,phone_numbers:$e,business_numbers:Ee,closing_date:fe,status:E,old_payment:_?Number(_):null,our_taxes:M?Number(M):null,warning_price:O?Number(O):null,entering_date:xe,lawyer_hand_over_date:Ce,comment:B,limitation_objection:L}},Dt=e=>{const{is_legal:t,first_name:i,last_name:n,jmbg:o,name:d,pib:l,employed:u,employer:y,executors:b,cession:C,address:v,email:W,zip_code:j,city:k,case_number:F,contract_number:N,closing_date:r,business_numbers:x,lawyer:h,client:c,court:g,ssn_number:p,package:w,principal:S,interest:$,phone_numbers:E,state:_,status:M,old_payment:O,our_taxes:D,warning_price:z,entering_date:B,lawyer_hand_over_date:L,comment:f,limitation_objection:T,fee:te,legal_fee:ae,payment:se,withdrawal:ie}=e;return t?{address:v,email:W,cession:C,name:d,pib:l,legalEntity:t,executors:b&&b.length>0?b.map(I=>({id:I.id,name:`${I.first_name} ${I.last_name}`})):[{id:null,name:""}],phoneNumbers:E&&E.length>0?E:[""],zipCode:j,city:k!=null&&k.id?{id:k.id,name:k.name}:"",caseNumber:F,contractNumber:N,closingDate:r?ne(r):null,businessNumbers:x&&x.length>0?x.map(I=>I.number):[""],lawyer:h!=null&&h.id?{id:h.id,name:`${h.first_name} ${h.last_name}`}:"",client:c!=null&&c.id?{id:c.id,name:c.name}:"",court:g!=null&&g.id?{id:g.id,name:g.name}:"",ssnNumber:p!=null&&p.id?{id:p.id,name:String(p.ssn)}:"",package:w!=null&&w.id?{id:w.id,name:w.package_name}:"",principal:S.toString(),interest:$.toString(),state:_||"active",status:M,comment:f,oldPayment:O?O.toString():"",ourTaxes:D?D.toString():"",warningPrice:z?z.toString():"",enteringDate:B?ne(B):null,lawyerHandOverDate:L?ne(L):null,limitationObjection:T||!1,transactions:{fees:te||null,legal_fees:ae||null,payments:se||null,withdrawals:ie||null}}:{address:v,email:W,cession:C,jmbg:o,employed:u,legalEntity:t,firstName:i,lastName:n,employer:y!=null&&y.id?{id:y.id,name:y.name}:"",executors:b&&b.length>0?b.map(I=>({id:I.id,name:`${I.first_name} ${I.last_name}`})):[{id:null,name:""}],phoneNumbers:E&&E.length>0?E:[""],zipCode:j,city:k!=null&&k.id?{id:k.id,name:k.name}:"",caseNumber:F,contractNumber:N,closingDate:r?ne(r):null,businessNumbers:x&&x.length>0?x.map(I=>I.number):[""],lawyer:h!=null&&h.id?{id:h.id,name:`${h.first_name} ${h.last_name}`}:"",client:c!=null&&c.id?{id:c.id,name:c.name}:"",court:g!=null&&g.id?{id:g.id,name:g.name}:"",ssnNumber:p!=null&&p.id?{id:p.id,name:String(p.ssn)}:"",package:w!=null&&w.id?{id:w.id,name:w.package_name}:"",principal:S.toString(),interest:$.toString(),state:_||"active",status:M,comment:f,oldPayment:O?O.toString():"",ourTaxes:D?D.toString():"",warningPrice:z?z.toString():"",enteringDate:B?ne(B):null,lawyerHandOverDate:L?ne(L):null,limitationObjection:T||!1,transactions:{fees:te||null,legal_fees:ae||null,payments:se||null,withdrawals:ie||null}}},At=({address:e,businessNumbers:t,caseNumber:i,cession:n,city:o,client:d,closingDate:l,contractNumber:u,court:y,email:b,employed:C,employer:v,executors:W,firstName:j,interest:k,jmbg:F,lastName:N,lawyer:r,name:x,package:h,phoneNumbers:c,pib:g,principal:p,ssnNumber:w,zipCode:S,state:$,status:E,oldPayment:_,ourTaxes:M,warningPrice:O,enteringDate:D,lawyerHandOverDate:z,comment:B,limitationObjection:L})=>{const f={};return o!==void 0&&(typeof o!="string"?f.city_id=o.id||null:o===""&&(f.city_id=null)),d!==void 0&&(typeof d!="string"?f.client_id=d.id||null:d===""&&(f.client_id=null)),y!==void 0&&(typeof y!="string"?f.court_id=y.id||null:y===""&&(f.court_id=null)),W!==void 0&&(W.length>0?f.executor_ids=W.filter(T=>T.id!==0&&T.id!==null).map(T=>T.id):f.executor_ids=[]),r!==void 0&&(typeof r!="string"?f.lawyer_id=r.id||null:r===""&&(f.lawyer_id=null)),w!==void 0&&(typeof w!="string"?f.ssn_number_id=w.id||null:w===""&&(f.ssn_number_id=null)),h!==void 0&&(typeof h!="string"?f.package_id=h.id||null:h===""&&(f.package_id=null)),v!==void 0&&(typeof v!="string"?f.employer_id=v.id||null:v===""&&(f.employer_id=null)),l!==void 0&&(f.closing_date=l?le(l):null),D!==void 0&&(f.entering_date=D?le(D):null),z!==void 0&&(f.lawyer_hand_over_date=z?le(z):null),i!==void 0&&(f.case_number=i||null),u!==void 0&&(f.contract_number=u||null),c!==void 0&&(c.length>0?f.phone_numbers=c==null?void 0:c.filter(T=>T.length>5):f.phone_numbers=[""]),t!==void 0&&(t.length>0?f.business_numbers=t==null?void 0:t.filter(T=>T.length>0):f.business_numbers=[""]),x!==void 0&&(f.name=x||null),g!==void 0&&(f.pib=g||null),j!==void 0&&(f.first_name=j||null),N!==void 0&&(f.last_name=N||null),C!==void 0&&(f.employed=C),F!==void 0&&(f.jmbg=F||null),$!==void 0&&(f.state=$||null),B!==void 0&&(f.comment=B||null),E!==void 0&&(f.status=E||null),L!==void 0&&(f.limitation_objection=L||null),e!==void 0&&(f.address=e||null),n!==void 0&&(f.cession=n),b!==void 0&&(f.email=b||null),S!==void 0&&(f.zip_code=S||null),p!==void 0&&(f.principal=Number(p)||null),k!==void 0&&(f.interest=Number(k)||null),_!==void 0&&(f.old_payment=Number(_)||null),M!==void 0&&(f.our_taxes=Number(M)||null),O!==void 0&&(f.warning_price=Number(O)||null),f},Mt=({id:e,name:t})=>({id:e,label:t,value:e}),pe=e=>Object.keys(e).filter(t=>e[t]===!0).map(t=>Be(t)),Bt=(e,t)=>{const{principal:i,interest:n,warningPrice:o}=e;let d=i?parseFloat(i):0,l=n?parseFloat(n):0,u=o?parseFloat(o):0;isNaN(d)&&(d=0),isNaN(l)&&(l=0),isNaN(u)&&(u=0);let y=d+l+u;return t&&(y=y+(t.fees||0)+(t.legal_fees||0)-(t.withdrawals||0)-(t.payments||0)),parseFloat(y.toFixed(2))},V={name:"name",jmbg_pib:"jmbg_pib",caseNumber:"caseNumber",contractNumber:"contractNumber",cession:"cession",executors:"executors",lawyer:"lawyer",ssn:"ssn",package:"package",state:"state",businessNumbers:"businessNumbers",principal:"principal",interest:"interest"},Tt=()=>{var x,h;const{t:e}=Q(),{state:{sortable:{sort:t,sortBy:i},pageable:{page:n,size:o},searchable:d,filterable:l,filterableByClient:u,filterableMultiselect:y},dispatch:b}=q();let C={page:n,size:o,sort:t,sortBy:i};const v=d.reduce((c,g)=>{const p=Te(g);return{...c,...p}},{}),W=y.reduce((c,g)=>(g!==""&&(c[g]=!0),c),{}),{data:j,isLoading:k,refetch:F}=Et({...C,...v,filter:l,clientsFilter:u,...W}),N=c=>{const{id:g}=c.original;g&&(b({type:m.editCaseId,payload:g}),b({type:m.editCaseModalOpen,payload:!0}))},r=G.useMemo(()=>[{accessorFn:c=>c.name,id:V.name,header:()=>a.jsx("span",{children:e(`entities.${[V.name]}`)}),cell:c=>c.getValue(),isSearchable:!0,isSortable:!0},{accessorFn:c=>c.jmbg_pib,id:V.jmbg_pib,header:()=>a.jsx("span",{children:e(`entities.${[V.jmbg_pib]}`)}),cell:c=>c.getValue(),isSearchable:!0,isSortable:!0},{accessorFn:c=>c.caseNumber,id:V.caseNumber,header:()=>a.jsx("span",{children:e(`entities.${[V.caseNumber]}`)}),cell:c=>c.getValue(),isSearchable:!0,isSortable:!0},{accessorFn:c=>c.contractNumber,id:V.contractNumber,header:()=>a.jsx("span",{children:e(`entities.${[V.contractNumber]}`)}),cell:c=>c.getValue(),isSearchable:!0,isSortable:!0},{accessorFn:c=>c.businessNumbers,id:V.businessNumbers,header:()=>a.jsx("span",{children:e(`entities.${[V.businessNumbers]}`)}),cell:c=>c.getValue(),isSearchable:!0,isSortable:!0},{accessorFn:c=>c.executors,id:V.executors,header:()=>a.jsx("span",{children:e(`entities.${[V.executors]}`)}),cell:c=>c.getValue(),isSearchable:!0,isSortable:!0},{accessorFn:c=>c.lawyer,id:V.lawyer,header:()=>a.jsx("span",{children:e(`entities.${[V.lawyer]}`)}),cell:c=>c.getValue(),isSearchable:!0,isSortable:!0},{accessorFn:c=>c.ssn,id:V.ssn,header:()=>a.jsx("span",{children:e(`entities.${[V.ssn]}`)}),cell:c=>c.getValue(),isSearchable:!0,isSortable:!0},{accessorFn:c=>c.package,id:V.package,header:()=>a.jsx("span",{children:e(`entities.${[V.package]}`)}),cell:c=>c.getValue(),isSearchable:!0,isSortable:!0}],[]);return k?a.jsx(a.Fragment,{children:"Loading..."}):a.jsx(ct,{columns:r,data:(x=j==null?void 0:j.data.data)==null?void 0:x.cases,hasSearch:!0,sort:t,sortBy:i,totalNumber:(h=j==null?void 0:j.data.data)==null?void 0:h.meta.total_number,page:n,size:o,borderKeyword:"state",updateState:b,refetch:F,mapBorderColors:_t,onRowClick:N})},Vt=({employersOptions:e,lawyersOptions:t,clientsOptions:i,courtsOptions:n,ssnNumbersOptions:o,packagesOptions:d,citiesOptions:l,executorsOptions:u})=>[{name:"legalEntity",type:s.toggle,options:[!0,!1],gridClassName:"flex justify-center",labelPlacement:"top"},{name:"firstName",required:!0,type:s.input,gridWidth:6,condition:!1},{name:"lastName",required:!0,type:s.input,gridWidth:6,condition:!1},{name:"jmbg",required:!0,type:s.input,gridWidth:12,condition:!1},{name:"name",required:!0,type:s.input,gridWidth:6,condition:!0},{name:"pib",type:s.input,gridWidth:6,condition:!0},{name:"employed",type:s.checkbox,gridWidth:6,condition:!1},{name:"employer",type:s.autocomplete,gridWidth:12,condition:!1,secondCondition:!0,options:e},{name:"cession",type:s.checkbox,gridWidth:6},{name:"executors",subfieldName:"executor",type:s.dynamicAutocompletes,gridWidth:12,options:u},{name:"principal",type:s.input,gridWidth:6,format:/^[\d 0-9.]{0,24}$/},{name:"interest",type:s.input,gridWidth:6,format:/^[\d 0-9.]{0,24}$/},{name:"businessNumbers",subfieldName:"businessNumber",type:s.dynamicInputs,gridWidth:12},{name:"caseNumber",required:!0,type:s.input,gridWidth:6},{name:"contractNumber",required:!0,type:s.input,gridWidth:6},{name:"ssnNumber",type:s.autocomplete,gridWidth:6,options:o},{name:"package",type:s.autocomplete,gridWidth:6,options:d},{name:"phoneNumbers",subfieldName:"phoneNumber",type:s.dynamicInputs,gridWidth:12},{name:"address",type:s.input,gridWidth:6},{name:"email",type:s.input,gridWidth:6},{name:"zipCode",type:s.input,gridWidth:6,format:/^\d{6}$/},{name:"city",type:s.autocomplete,gridWidth:6,options:l},{name:"lawyer",type:s.autocomplete,gridWidth:6,options:t},{name:"court",type:s.autocomplete,gridWidth:6,options:n},{name:"client",required:!0,type:s.autocomplete,gridWidth:6,options:i},{name:"enteringDate",type:s.datepicker,gridWidth:6},{name:"lawyerHandOverDate",type:s.datepicker,gridWidth:6},{name:"closingDate",type:s.datepicker,gridWidth:6},{name:"status",type:s.input,gridWidth:6},{name:"oldPayment",type:s.input,gridWidth:6,format:/^[\d 0-9.]{0,24}$/},{name:"ourTaxes",type:s.input,gridWidth:6,format:/^[\d 0-9.]{0,24}$/},{name:"warningPrice",type:s.input,gridWidth:6,format:/^[\d 0-9.]{0,24}$/},{name:"comment",type:s.textArea,gridWidth:6},{name:"limitationObjection",type:s.checkbox,gridWidth:6}],zt=async e=>{let t;try{t=await R({method:"get",url:"api/clients-names",params:{...e},withCredentials:!0})}catch{t={data:{error:500,message:"Connection problem"}}}return t},Se=e=>K(["clientsNames",e],()=>zt(e),{keepPreviousData:!0,refetchOnMount:!1,refetchOnWindowFocus:!1,select(t){return t.data.data}}),Lt=async e=>{let t;try{t=await R({method:"get",url:"api/courts-names",params:{...e},withCredentials:!0})}catch{t={data:{error:500,message:"Connection problem"}}}return t},Qe=e=>K(["courtsNames",e],()=>Lt(e),{keepPreviousData:!0,refetchOnMount:!1,refetchOnWindowFocus:!1,select(t){return t.data.data}}),It=async e=>{let t;try{t=await R({method:"get",url:"api/executors-names",params:{...e},withCredentials:!0})}catch{t={data:{error:500,message:"Connection problem"}}}return t},Ue=e=>K(["executorsNames",e],()=>It(e),{keepPreviousData:!0,refetchOnMount:!1,refetchOnWindowFocus:!1,select(t){return t.data.data}}),Pt=async e=>{let t;try{t=await R({method:"get",url:"api/lawyers-names",params:{...e},withCredentials:!0})}catch{t={data:{error:500,message:"Connection problem"}}}return t},Ye=e=>K(["lawyersNames",e],()=>Pt(e),{keepPreviousData:!0,refetchOnMount:!1,refetchOnWindowFocus:!1,select(t){return t.data.data}}),Rt=async e=>{let t;try{t=await R({method:"get",url:"api/packages-names",params:{...e},withCredentials:!0})}catch{t={data:{error:500,message:"Connection problem"}}}return t},Ge=e=>K(["packagesNames",e],()=>Rt(e),{keepPreviousData:!0,refetchOnMount:!1,refetchOnWindowFocus:!1,select(t){return t.data.data}}),qt=async e=>{let t;try{t=await R({method:"get",url:"api/ssn-numbers",params:{...e},withCredentials:!0})}catch{t={data:{error:500,message:"Connection problem"}}}return t},Ke=e=>K(["ssnNumbers",e],()=>qt(e),{keepPreviousData:!0,refetchOnMount:!1,refetchOnWindowFocus:!1,select(t){return t.data.data}}),Qt=async e=>{let t;try{t=await R({method:"get",url:"api/employers-names",params:{...e},withCredentials:!0})}catch{t={data:{error:500,message:"Connection problem"}}}return t},He=e=>K(["employersNames",e],()=>Qt(e),{keepPreviousData:!0,refetchOnMount:!1,refetchOnWindowFocus:!1,select(t){return t.data.data}}),Xe=({label:e,values:t,autocompleteProps:i,inputProps:n,options:o,name:d,actionType:l,limit:u,onValuesChange:y,updateState:b})=>{const[C,v]=G.useState(t??[{id:null,name:""}]);G.useEffect(()=>{t&&v(t)},[t]);const W=()=>{if(C.length<6){const r=[...C,{id:null,name:""}];v(r),y&&y(r)}},j=r=>{const x=[...C];x.splice(r,1),v(x),y&&y(x)},k=(r,x)=>{const h=[...C];h[r]=x,v(h),y&&y(h)},F=(r,x)=>{const{value:h}=r.target;ke(g=>b&&b({type:l,payload:{inputName:d,inputValue:g}}),300)(h),h===""&&k(x,{id:0,name:h})},N=(r,x)=>{var h;if(((h=r==null?void 0:r.currentTarget)==null?void 0:h.ariaLabel)==="Clear")return k(x,{id:0,name:""});if(r!=null&&r.target&&"value"in r.target){const{value:c}=r.target;if(c==="")return k(x,{id:0,name:""})}};return a.jsxs(X,{className:"my-3",children:[a.jsx(ot,{textAlign:"left",children:e}),C.map((r,x)=>a.jsxs(X,{className:"flex my-3",children:[a.jsx(Ne,{...i,clearIcon:!1,isOptionEqualToValue:(h,c)=>h.id===c.id,options:o??[],getOptionLabel:h=>ee(h).name,onBlur:()=>b&&b({type:l,payload:{inputName:d,inputValue:""}}),value:r!=null&&r.id?r:null,onChange:(h,c)=>k(x,c),onInputChange:h=>N(h,x),renderInput:h=>a.jsx(Z,{...h,...n,label:`${n==null?void 0:n.label} ${x+1}`,onBlur:()=>b&&b({type:l,payload:{inputName:d,inputValue:""}}),onChange:c=>F(c,x)})}),x>0?a.jsx(Oe,{onClick:()=>j(x),children:a.jsx(dt,{})}):a.jsx(X,{className:"w-[42px]"})]},x)),C.length<(u||4)&&a.jsx(X,{className:"flex justify-center",children:a.jsx(Oe,{onClick:W,children:a.jsx(ut,{})})})]})},Ut=()=>{const{t:e}=Q(),{state:{isLegalEntity:t,addCaseForm:i,addCaseAutocompleteValues:n},dispatch:o}=q(),{data:d}=Re({search:n.city}),{data:l}=Se({search:n.client}),{data:u}=Qe({search:n.court}),{data:y}=Ue({search:n.executors}),{data:b}=Ye({search:n.lawyer}),{data:C}=Ge({search:n.package}),{data:v}=Ke({search:n.ssnNumber}),{data:W}=He({search:n.employer}),j=(N,r,x)=>(h,c)=>{switch(r){case s.toggle:N==="legalEntity"?(o({type:m.isLegalEntity,payload:!t}),o({type:m.addCaseForm,payload:{name:N,fieldValue:c}})):o({type:m.addCaseForm,payload:{name:N,fieldValue:c}});break;case s.input:case s.textArea:const{value:g}=h==null?void 0:h.target;let p=g;x?p.match(x)&&o({type:m.addCaseForm,payload:{name:N,fieldValue:p}}):o({type:m.addCaseForm,payload:{name:N,fieldValue:p}});break;case s.checkbox:o({type:m.addCaseForm,payload:{name:N,fieldValue:c}});break;case s.datepicker:o({type:m.addCaseForm,payload:{name:N,fieldValue:h}});break;case s.dynamicInputs:o({type:m.addCaseForm,payload:{name:N,fieldValue:h}});break;case s.autocomplete:o({type:m.addCaseForm,payload:{name:N,fieldValue:c?ee(c):""}});break;case s.dynamicAutocompletes:o({type:m.addCaseForm,payload:{name:N,fieldValue:h.map(w=>ee(w))}});break}},k=()=>console.log("Submitted"),F=N=>{var M;const{name:r,type:x,gridClassName:h,formFieldClassName:c,gridWidth:g,labelPlacement:p,options:w,size:S,subfieldName:$,format:E,required:_}=N;switch(x){case s.toggle:return a.jsx(A,{className:h,item:!0,xs:g||12,children:a.jsx(de,{required:_,className:c,value:t,onChange:j(r,x),control:a.jsx(qe,{color:"primary"}),label:e(`entities.${r}`),labelPlacement:p})},r);case s.checkbox:return a.jsx(A,{className:h,item:!0,xs:g||12,children:a.jsx(de,{required:_,control:a.jsx(je,{className:c,name:r,size:S??"small",checked:i[r],onChange:j(r,x)}),label:e(`entities.${r}`)})},r);case s.input:return a.jsx(A,{className:h,item:!0,xs:g||12,children:a.jsx(Z,{required:_,fullWidth:!0,className:c,size:S??"small",label:e(`entities.${r}`),name:r,value:i[r],onChange:j(r,x,E)})},r);case s.autocomplete:return a.jsx(A,{className:h,item:!0,xs:g||12,children:a.jsx(Ne,{isOptionEqualToValue:(O,D)=>O.id===D.id,fullWidth:!0,clearIcon:!1,className:c,options:w??[],getOptionLabel:O=>ee(O).name,size:S??"small",value:(M=i[r])!=null&&M.id?i[r]:null,onChange:j(r,x),renderInput:O=>a.jsx(Z,{...O,required:_,label:e(`entities.${r}`),onBlur:()=>o({type:m.addCaseAutocompleteValues,payload:{inputName:r,inputValue:""}}),onChange:ke(D=>o({type:m.addCaseAutocompleteValues,payload:{inputName:r,inputValue:D.target.value}}),300)})})},r);case s.datepicker:return a.jsx(A,{className:h,item:!0,xs:g||12,children:a.jsx(ze,{dateAdapter:Le,children:a.jsx(Ie,{localeText:{clearButtonLabel:e("clear")},label:e(`entities.${r}`),value:i[r],className:c,slotProps:{textField:{size:"small",fullWidth:!0,required:_},actionBar:{actions:["clear"]}},format:"DD. MM. YYYY",onChange:j(r,x)})})},r);case s.dynamicInputs:return a.jsx(A,{className:h,item:!0,xs:g||12,children:a.jsx(Ve,{limit:r==="phoneNumbers"?4:2,label:e(`entities.${r}`),inputProps:{label:e(`entities.${$}`),size:"small",fullWidth:!0},values:i[r],onValuesChange:j(r,x)})},r);case s.dynamicAutocompletes:return a.jsx(A,{className:h,item:!0,xs:g||12,children:a.jsx(Xe,{limit:r==="phoneNumbers"?4:2,options:w,label:e(`entities.${r}`),autocompleteProps:{size:"small",fullWidth:!0},inputProps:{label:e(`entities.${$}`)},value:i[r],onValuesChange:j(r,x),actionType:m.addCaseAutocompleteValues,name:r,updateState:o})},r);case s.textArea:return a.jsx(A,{className:h,item:!0,xs:g||12,children:a.jsx(Z,{required:_,fullWidth:!0,multiline:!0,className:c,size:S??"small",label:e(`entities.${r}`),name:r,rows:2,value:i[r],onChange:j(r,x,E)})},r);default:return""}};return a.jsx(U,{children:a.jsx(ye,{children:a.jsx("form",{onSubmit:k,children:a.jsx(A,{container:!0,spacing:2,children:Vt({citiesOptions:d,clientsOptions:l,courtsOptions:u,executorsOptions:y,lawyersOptions:b,packagesOptions:C,ssnNumbersOptions:v,employersOptions:W}).map(N=>(typeof N.condition!="boolean"||N.condition===t)&&(typeof N.secondCondition!="boolean"||N.secondCondition===i.employed)&&F(N))})})})})},Yt=async e=>{let t;return t=await R({method:"post",url:"api/cases",data:e,withCredentials:!0}),t},Gt=(e,t)=>{const i=be();return ue(n=>Yt(n),{onSuccess:n=>(n.data.error||(t({type:m.resetCaseFormData}),t({type:m.openSuccessSnackbar,payload:!0}),e(),i.invalidateQueries({queryKey:["casesList"]})),n.data.message),onError:n=>{var o,d;return console.error(n),t({type:m.openErrorSnackbar,payload:!0}),{error:n,message:((d=(o=n==null?void 0:n.response)==null?void 0:o.data)==null?void 0:d.message)||"Error has occured"}}})},Kt=e=>{var h,c,g,p;const{open:t,onClose:i}=e,{t:n}=Q(),{state:{addCaseForm:o,openSuccessSnackbar:d,openErrorSnackbar:l,addCaseModalOpen:u,editCaseModalOpen:y,exportCasesDialogOpen:b,importCasesDialogOpen:C},dispatch:v}=q(),{mutate:W,isLoading:j,data:k,error:F,isSuccess:N,isError:r,reset:x}=Gt(i,v);return G.useEffect(()=>{(u||y||b||C)&&N&&x()},[u,y,b,C]),a.jsxs(U,{children:[a.jsx(Pe,{open:t,header:n("entities.addNewCase"),children:a.jsx(Ut,{}),onClose:i,hasActionButton:!0,actionButtonText:"submit",hasCancelButton:!0,onSubmit:()=>W(Ot(o)),isLoading:j,hasCloseIconButton:!0}),N&&(k!=null&&k.data.message)?a.jsx(Y,{open:d,onClose:()=>v({type:m.openSuccessSnackbar,payload:!1}),severity:"success",content:k==null?void 0:k.data.message}):"",r&&((c=(h=F==null?void 0:F.response)==null?void 0:h.data)!=null&&c.message)?a.jsx(Y,{open:l,onClose:()=>v({type:m.openErrorSnackbar,payload:!1}),severity:"error",content:(p=(g=F==null?void 0:F.response)==null?void 0:g.data)==null?void 0:p.message}):""]})},Ht=()=>{const{state:{filterable:e,pageable:t},dispatch:i}=q(),{t:n}=Q(),o=[{id:1,label:n("all"),value:ce.all},{id:2,label:n("active"),value:ce.active},{id:3,label:n("closed"),value:ce.closed}],d=l=>{i({type:he.filterable,payload:l}),i({type:he.pageable,payload:{...t,page:1}})};return a.jsx(U,{children:a.jsx(we,{label:n("entities.stateOfCases"),size:"small",options:o,value:e,onChange:d})})},Xt=async(e,t)=>{let i;return i=await R({method:"patch",url:`api/case/${e}`,data:t,withCredentials:!0}),i},Jt=(e,t,i)=>{const n=be();return ue(o=>Xt(i,o),{onSuccess:o=>(o.data.error||(t({type:m.resetCaseFormData}),t({type:m.openSuccessSnackbar,payload:!0}),e(),n.invalidateQueries({queryKey:["casesList"]}),n.invalidateQueries({queryKey:["case"]})),o.data.message),onError:o=>{var d,l,u,y;return console.error(o),(l=(d=o==null?void 0:o.response)==null?void 0:d.data)!=null&&l.message&&t({type:m.openErrorSnackbar,payload:!0}),{error:o,message:((y=(u=o==null?void 0:o.response)==null?void 0:u.data)==null?void 0:y.message)||"Error has occured"}}})},Zt=({employersOptions:e,lawyersOptions:t,clientsOptions:i,courtsOptions:n,ssnNumbersOptions:o,packagesOptions:d,citiesOptions:l,executorsOptions:u})=>[{name:"firstName",required:!0,type:s.input,gridWidth:6,condition:!1},{name:"lastName",required:!0,type:s.input,gridWidth:6,condition:!1},{name:"jmbg",required:!0,type:s.input,gridWidth:12,condition:!1},{name:"name",required:!0,type:s.input,gridWidth:6,condition:!0},{name:"pib",type:s.input,gridWidth:6,condition:!0},{name:"employed",type:s.checkbox,gridWidth:6,condition:!1},{name:"employer",type:s.autocomplete,gridWidth:12,condition:!1,secondCondition:!0,options:e},{name:"cession",type:s.checkbox,gridWidth:6},{name:"executors",subfieldName:"executor",type:s.dynamicAutocompletes,gridWidth:12,options:u},{name:"principal",type:s.input,gridWidth:6,format:/^[\d 0-9.]{0,24}$/},{name:"interest",type:s.input,gridWidth:6,format:/^[\d 0-9.]{0,24}$/},{name:"businessNumbers",subfieldName:"businessNumber",type:s.dynamicInputs,gridWidth:12},{name:"caseNumber",required:!0,type:s.input,gridWidth:6},{name:"contractNumber",required:!0,type:s.input,gridWidth:6},{name:"ssnNumber",type:s.autocomplete,gridWidth:6,options:o},{name:"package",type:s.autocomplete,gridWidth:6,options:d},{name:"phoneNumbers",subfieldName:"phoneNumber",type:s.dynamicInputs,gridWidth:12},{name:"address",type:s.input,gridWidth:6},{name:"email",type:s.input,gridWidth:6},{name:"zipCode",type:s.input,gridWidth:6,format:/^\d{6}$/},{name:"city",type:s.autocomplete,gridWidth:6,options:l},{name:"lawyer",type:s.autocomplete,gridWidth:6,options:t},{name:"court",type:s.autocomplete,gridWidth:6,options:n},{name:"client",required:!0,type:s.autocomplete,gridWidth:6,options:i},{name:"enteringDate",type:s.datepicker,gridWidth:6},{name:"lawyerHandOverDate",type:s.datepicker,gridWidth:6},{name:"closingDate",type:s.datepicker,gridWidth:6},{name:"status",type:s.input,gridWidth:6},{name:"oldPayment",type:s.input,gridWidth:6,format:/^[\d 0-9.]{0,24}$/},{name:"ourTaxes",type:s.input,gridWidth:6,format:/^[\d 0-9.]{0,24}$/},{name:"warningPrice",type:s.input,gridWidth:6,format:/^[\d 0-9.]{0,24}$/},{name:"comment",type:s.textArea,gridWidth:6},{name:"limitationObjection",type:s.checkbox,gridWidth:6}],ea=async e=>{let t;if(e){try{t=await R({method:"get",url:`api/case/${e}`,withCredentials:!0})}catch{t={data:{error:500,message:"errors.serverError"}}}return t}return{data:{error:400,message:"errors.notFound"}}},ta=e=>K(["case",e],()=>ea(e),{keepPreviousData:!1,refetchOnMount:!0,refetchOnWindowFocus:!1,select(t){if(t.data.data)return Dt(t.data.data)}}),aa=()=>{const{t:e}=Q(),{state:{isLegalEntity:t,editCaseForm:i,editCaseAutocompleteValues:n,editCaseId:o},dispatch:d}=q(),{data:l,isLoading:u,isSuccess:y}=ta(o);G.useEffect(()=>{y&&(l!=null&&l.caseNumber)&&d({type:m.setCaseFormData,payload:l})},[l==null?void 0:l.caseNumber]);const{data:b}=Re({search:n.city}),{data:C}=Se({search:n.client}),{data:v}=Qe({search:n.court}),{data:W}=Ue({search:n.executors}),{data:j}=Ye({search:n.lawyer}),{data:k}=Ge({search:n.package}),{data:F}=Ke({search:n.ssnNumber}),{data:N}=He({search:n.employer}),r=(g,p,w)=>(S,$)=>{switch(p){case s.toggle:d({type:m.editCaseForm,payload:{editName:g,fieldEditValue:$}});break;case s.input:case s.textArea:const{value:E}=S==null?void 0:S.target;let _=E;w?_.match(w)&&d({type:m.editCaseForm,payload:{editName:g,fieldEditValue:_}}):d({type:m.editCaseForm,payload:{editName:g,fieldEditValue:_}});break;case s.checkbox:d({type:m.editCaseForm,payload:{editName:g,fieldEditValue:$}});break;case s.datepicker:d({type:m.editCaseForm,payload:{editName:g,fieldEditValue:S}});break;case s.dynamicInputs:d({type:m.editCaseForm,payload:{editName:g,fieldEditValue:S}});break;case s.autocomplete:d({type:m.editCaseForm,payload:{editName:g,fieldEditValue:$?ee($):""}});break;case s.dynamicAutocompletes:d({type:m.editCaseForm,payload:{editName:g,fieldEditValue:S.map(M=>ee(M))}});break}},x=()=>console.log("Submitted"),h=g=>{var L;const{name:p,type:w,gridClassName:S,formFieldClassName:$,gridWidth:E,labelPlacement:_,options:M,size:O,subfieldName:D,format:z,required:B}=g;switch(w){case s.toggle:return a.jsx(A,{className:S,item:!0,xs:E||12,children:a.jsx(de,{required:B,className:$,value:t,onChange:r(p,w),control:a.jsx(qe,{color:"primary"}),label:e(`entities.${p}`),labelPlacement:_})},p);case s.checkbox:return a.jsx(A,{className:S,item:!0,xs:E||12,children:a.jsx(de,{required:B,control:a.jsx(je,{className:$,name:p,size:O??"small",checked:i[p],onChange:r(p,w)}),label:e(`entities.${p}`)})},p);case s.input:return a.jsx(A,{className:S,item:!0,xs:E||12,children:a.jsx(Z,{required:B,fullWidth:!0,className:$,size:O??"small",label:e(`entities.${p}`),name:p,value:i[p],onChange:r(p,w,z)})},p);case s.autocomplete:return a.jsx(A,{className:S,item:!0,xs:E||12,children:a.jsx(Ne,{isOptionEqualToValue:(f,T)=>f.id===T.id,fullWidth:!0,clearIcon:!1,className:$,options:M??[],getOptionLabel:f=>ee(f).name,size:O??"small",value:(L=i[p])!=null&&L.id?i[p]:null,onChange:r(p,w),renderInput:f=>a.jsx(Z,{...f,required:B,label:e(`entities.${p}`),onBlur:()=>d({type:m.editCaseAutocompleteValues,payload:{inputName:p,inputValue:""}}),onChange:ke(T=>d({type:m.editCaseAutocompleteValues,payload:{inputName:p,inputValue:T.target.value}}),300)})})},p);case s.datepicker:return a.jsx(A,{className:S,item:!0,xs:E||12,children:a.jsx(ze,{dateAdapter:Le,children:a.jsx(Ie,{localeText:{clearButtonLabel:e("clear")},label:e(`entities.${p}`),value:i[p],className:$,slotProps:{textField:{size:"small",fullWidth:!0,required:B},actionBar:{actions:["clear"]}},format:"DD. MM. YYYY",onChange:r(p,w)})})},p);case s.dynamicInputs:return a.jsx(A,{className:S,item:!0,xs:E||12,children:a.jsx(Ve,{limit:p==="phoneNumbers"?4:2,label:e(`entities.${p}`),inputProps:{label:e(`entities.${D}`),size:"small",fullWidth:!0},values:i[p],onValuesChange:r(p,w)})},p);case s.dynamicAutocompletes:return a.jsx(A,{className:S,item:!0,xs:E||12,children:a.jsx(Xe,{limit:p==="phoneNumbers"?4:2,options:M,label:e(`entities.${p}`),autocompleteProps:{size:"small",fullWidth:!0},inputProps:{label:e(`entities.${D}`)},values:i[p],onValuesChange:r(p,w),actionType:m.editCaseAutocompleteValues,name:p,updateState:d})},p);case s.textArea:return a.jsx(A,{className:S,item:!0,xs:E||12,children:a.jsx(Z,{required:B,fullWidth:!0,multiline:!0,className:$,size:O??"small",label:e(`entities.${p}`),name:p,rows:2,value:i[p],onChange:r(p,w,z)})},p);default:return""}},c=g=>{if(g){const p=Object.entries(g);return a.jsxs(ye,{className:"flex justify-between mb-10",children:[a.jsxs("span",{className:"text-xs",children:[e("entities.current_debt"),":"," ",Bt(i,g)]}),p.map(([w,S])=>S?a.jsxs("span",{className:"text-xs",children:[e(`entities.${w}`),": ",S]},w):"")]})}return""};return u||!i.caseNumber?a.jsx(X,{className:"flex justify-center items-center h-[1300px]",children:a.jsx(pt,{})}):a.jsxs(U,{children:[y&&(l!=null&&l.transactions)?c(l.transactions):"",a.jsx(ye,{children:y&&i?a.jsx("form",{onSubmit:x,children:a.jsx(A,{container:!0,spacing:2,children:Zt({citiesOptions:b,clientsOptions:C,courtsOptions:v,executorsOptions:W,lawyersOptions:j,packagesOptions:k,ssnNumbersOptions:F,employersOptions:N}).map(g=>(typeof g.condition!="boolean"||g.condition===i.legalEntity)&&(typeof g.secondCondition!="boolean"||g.secondCondition===i.employed)&&h(g))})}):""})]})},sa=async e=>{let t;return t=await R({method:"delete",url:`api/case/${e}`,withCredentials:!0}),t},ia=(e,t,i)=>{const n=be();return ue(()=>sa(i),{onSuccess:o=>(o.data.error||(t({type:m.resetCaseFormData}),t({type:m.openSuccessSnackbar,payload:!0}),e(),n.invalidateQueries({queryKey:["casesList"]})),o.data.message),onError:o=>{var d,l,u,y;return console.error(o),(l=(d=o==null?void 0:o.response)==null?void 0:d.data)!=null&&l.message&&t({type:m.openErrorSnackbar,payload:!0}),{error:o,message:((y=(u=o==null?void 0:o.response)==null?void 0:u.data)==null?void 0:y.message)||"Error has occured"}}})},na=e=>{var z,B,L,f;const{open:t,onClose:i}=e,{t:n}=Q(),{state:{editedCaseFormData:o,editCaseId:d,confirmationDialogOpen:l,openSuccessSnackbar:u,openErrorSnackbar:y,addCaseModalOpen:b,editCaseModalOpen:C,exportCasesDialogOpen:v,importCasesDialogOpen:W},dispatch:j}=q(),k=()=>{j({type:m.confirmationDialogOpen,payload:!1}),i()},{mutate:F,isLoading:N,data:r,error:x,isSuccess:h,isError:c,reset:g}=Jt(i,j,d),{mutate:p,isLoading:w,data:S,error:$,isSuccess:E,isError:_,reset:M}=ia(k,j,d);G.useEffect(()=>{(b||C||v||W)&&(h&&g(),E&&M())},[b,C,v,W]);const O=c||_,D=x||$;return a.jsxs(U,{children:[a.jsx(Pe,{open:t,header:n("entities.editCase"),children:a.jsx(aa,{}),onClose:i,hasActionButton:!0,actionButtonText:"submit",hasCancelButton:!0,onSubmit:()=>F(At(o)),isLoading:N,hasCloseIconButton:!0,extraButtonText:"delete",hasExtraButton:!0,onExtraButtonClick:()=>j({type:m.confirmationDialogOpen,payload:!l})}),a.jsx(mt,{title:"entities.deleteCase",isLoading:w,open:l,onClose:()=>k(),onSubmit:()=>p()}),h&&(r!=null&&r.data.message)?a.jsx(Y,{open:u,onClose:()=>j({type:m.openSuccessSnackbar,payload:!1}),severity:"success",content:r==null?void 0:r.data.message}):"",E&&(S!=null&&S.data.message)?a.jsx(Y,{open:u,onClose:()=>j({type:m.openSuccessSnackbar,payload:!1}),severity:"success",content:S==null?void 0:S.data.message}):"",O&&((B=(z=D==null?void 0:D.response)==null?void 0:z.data)!=null&&B.message)?a.jsx(Y,{open:y,onClose:()=>j({type:m.openErrorSnackbar,payload:!1}),severity:"error",content:(f=(L=D==null?void 0:D.response)==null?void 0:L.data)==null?void 0:f.message}):""]})},oa=()=>{const{state:{filterableByClient:e,pageable:t},dispatch:i}=q(),{t:n}=Q(),{data:o,isSuccess:d}=Se({});let l=[];d&&o&&(l=o.map(b=>Mt(b)));const u=[{id:9999,label:n("all"),value:9999},...l],y=b=>{i({type:m.filterableByClient,payload:b}),i({type:he.pageable,payload:{...t,page:1}})};return a.jsx(U,{children:a.jsx(we,{label:n("entities.client"),size:"small",options:u,value:e,onChange:y})})},ra=async e=>{const{filter:t="active",clientsFilter:i=9999}=e;let n;if(n=await R({method:"post",url:"api/export-cases-list",data:{...e,filter:t===ce.all?"":t,clientsFilter:i===9999?"":i},withCredentials:!0}),!n.data.error){const o=n.data.data;if(o)if(typeof o=="object"&&o.type==="Buffer"&&Array.isArray(o.data)){const d=new Uint8Array(o.data);return new Blob([d])}else return new Blob([o])}},la=e=>ue(t=>ra(t),{onError:t=>{var i,n,o,d;return console.error(t),(n=(i=t==null?void 0:t.response)==null?void 0:i.data)!=null&&n.message&&e({type:m.openErrorSnackbar,payload:!0}),{error:t,message:((d=(o=t==null?void 0:t.response)==null?void 0:o.data)==null?void 0:d.message)||"Error has occured"}}}),Ae=[{name:"caseNumber",type:s.checkbox,gridWidth:4},{name:"contractNumber",type:s.checkbox,gridWidth:4},{name:"name",type:s.checkbox,gridWidth:4},{name:"isLegal",type:s.checkbox,gridWidth:4},{name:"package",type:s.checkbox,gridWidth:4},{name:"principal",type:s.checkbox,gridWidth:4},{name:"interest",type:s.checkbox,gridWidth:4},{name:"currentDebt",type:s.checkbox,gridWidth:4},{name:"cession",type:s.checkbox,gridWidth:4},{name:"state",type:s.checkbox,gridWidth:4},{name:"phoneNumbers",type:s.checkbox,gridWidth:4},{name:"zipCode",type:s.checkbox,gridWidth:4},{name:"city",type:s.checkbox,gridWidth:4},{name:"address",type:s.checkbox,gridWidth:4},{name:"employed",type:s.checkbox,gridWidth:4},{name:"employer",type:s.checkbox,gridWidth:4},{name:"jmbg_pib",type:s.checkbox,gridWidth:4},{name:"lawyer",type:s.checkbox,gridWidth:4},{name:"ssn",type:s.checkbox,gridWidth:4},{name:"executors",type:s.checkbox,gridWidth:4},{name:"businessNumbers",type:s.checkbox,gridWidth:4},{name:"status",type:s.checkbox,gridWidth:4},{name:"client",type:s.checkbox,gridWidth:4},{name:"court",type:s.checkbox,gridWidth:4},{name:"oldPayment",type:s.checkbox,gridWidth:4},{name:"ourTaxes",type:s.checkbox,gridWidth:4},{name:"warningPrice",type:s.checkbox,gridWidth:4},{name:"comment",type:s.checkbox,gridWidth:4},{name:"closingDate",type:s.checkbox,gridWidth:4},{name:"enteringDate",type:s.checkbox,gridWidth:4},{name:"lawyerHandOverDate",type:s.checkbox,gridWidth:4},{name:"limitationObjection",type:s.checkbox,gridWidth:4}],ca=()=>{const{t:e}=Q(),{state:{casesExportChecklistValues:t},dispatch:i}=q(),n=l=>(u,y)=>{i({type:m.casesExportChecklistValues,payload:{checkboxName:l,checkboxValue:y}})},o=l=>{const{name:u,type:y,gridWidth:b}=l;return y===s.checkbox?a.jsx(A,{item:!0,xs:b||4,children:a.jsx(de,{control:a.jsx(je,{color:"info",name:u,size:"small",checked:t[u],onChange:n(u)}),label:e(`entities.${u}`)})},u):""},d=()=>Object.values(t).reduce((u,y)=>y?u+1:u,0)/Ae.length>.5;return a.jsx(U,{children:a.jsx(ye,{className:"mx-4 my-6",children:a.jsx("form",{children:a.jsxs(A,{container:!0,spacing:1,children:[Ae.map(l=>o(l)),a.jsx(A,{item:!0,xs:12,children:a.jsx(me,{color:"info",onClick:()=>i({type:m.casesCheckUncheckAll,payload:!d()}),variant:d()?"outlined":"contained",className:"min-w-full mt-2",children:d()?e("unselectAll"):e("selectAll")})})]})})})})},da=e=>{var c,g,p,w;const{open:t,onClose:i}=e,{t:n}=Q(),{state:{searchable:o,filterable:d,filterableByClient:l,downloadFile:u,exportFileType:y,casesExportChecklistValues:b,openSuccessSnackbar:C,openErrorSnackbar:v},dispatch:W}=q(),j=o.reduce((S,$)=>{const E=Te($);return{...S,...E}},{}),{data:k,isLoading:F,mutateAsync:N,error:r,isSuccess:x,isError:h}=la(W);return G.useEffect(()=>{if(!F&&k){const S=window.URL.createObjectURL(k),$=document.createElement("a");$.href=S,$.download=`${n("entities.cases")} - ${rt().format("YYYY.MM.DD HH-mm")}${y==="excel"?".xlsx":".csv"}`,document.body.appendChild($),$.click(),window.URL.revokeObjectURL(S),x&&(W({type:m.openSuccessSnackbar,payload:!0}),setTimeout(()=>{i()},1500))}},[F,k]),a.jsxs(U,{children:[a.jsx(ht,{title:"entities.exportCases",open:t,onClose:i,exportChecklist:a.jsx(ca,{}),exportCSVButton:a.jsx(De,{text:"exportCSV",isLoading:F,disabled:pe(b).length===0,onClick:async()=>{W({type:m.exportFileType,payload:"csv"}),W({type:m.downloadFile,payload:!0}),await N({...j,filter:d,clientsFilter:l,fileType:"csv",downloadFile:u,checkedProps:pe(b)})}}),exportExcelButton:a.jsx(De,{text:"exportExcel",isLoading:F,disabled:pe(b).length===0,onClick:async()=>{W({type:m.exportFileType,payload:"excel"}),W({type:m.downloadFile,payload:!0}),await N({...j,filter:d,clientsFilter:l,fileType:"excel",downloadFile:u,checkedProps:pe(b)})}})}),x&&k?a.jsx(Y,{open:C,onClose:()=>W({type:m.openSuccessSnackbar,payload:!1}),severity:"success",content:"messages.fileExportSuccess"}):"",h&&((g=(c=r==null?void 0:r.response)==null?void 0:c.data)!=null&&g.message)?a.jsx(Y,{open:v,onClose:()=>W({type:m.openErrorSnackbar,payload:!1}),severity:"error",content:(w=(p=r==null?void 0:r.response)==null?void 0:p.data)==null?void 0:w.message}):""]})},ua=async e=>{let t;const i=new FormData;return i.append("file",e),t=await R({method:"post",url:"api/import-cases-list",data:i,withCredentials:!0,headers:{"Content-Type":"multipart/form-data"}}),t},pa=(e,t)=>{const i=be();return ue(n=>ua(n),{onSuccess:n=>(n.data.error||(t({type:m.openSuccessSnackbar,payload:!0}),t({type:m.resetCaseFormData}),i.invalidateQueries({queryKey:["casesList"]}),setTimeout(()=>{e()},1500)),n.data.message),onError:n=>{var o,d,l,u;return console.error(n),(d=(o=n==null?void 0:n.response)==null?void 0:o.data)!=null&&d.message&&t({type:m.openErrorSnackbar,payload:!0}),{error:n,message:((u=(l=n==null?void 0:n.response)==null?void 0:l.data)==null?void 0:u.message)||"Error has occured"}}})},ma=e=>{var j,k,F,N;const{open:t,onClose:i}=e,{state:{casesFileForUpload:n,openSuccessSnackbar:o,openErrorSnackbar:d},dispatch:l}=q(),{isLoading:u,mutateAsync:y,data:b,error:C,isError:v,isSuccess:W}=pa(i,l);return a.jsxs(U,{children:[a.jsx(yt,{title:"entities.importCases",open:t,onClose:i,uploadComponent:a.jsx(gt,{onFileUpload:r=>l({type:m.casesFileForUpload,payload:r}),onFileDelete:()=>l({type:m.resetCaseFormData})}),isLoading:u,file:n,onSubmitFile:()=>n&&y(n)}),W&&(b!=null&&b.data.message)?a.jsx(Y,{open:o,onClose:()=>l({type:m.openSuccessSnackbar,payload:!1}),severity:"success",content:b==null?void 0:b.data.message}):"",v&&((k=(j=C==null?void 0:C.response)==null?void 0:j.data)!=null&&k.message)?a.jsx(Y,{open:d,onClose:()=>l({type:m.openErrorSnackbar,payload:!1}),severity:"error",content:(N=(F=C==null?void 0:C.response)==null?void 0:F.data)==null?void 0:N.message}):""]})},ha=()=>{const{state:{filterableMultiselect:e,pageable:t},dispatch:i}=q(),{t:n}=Q(),o=[{id:1,label:n("all"),value:"",disabled:!0},{id:2,label:n("entities.hasObjection"),value:"hasObjection"},{id:3,label:n("entities.hasPayments"),value:"hasPayments"}],d=l=>{l.length===0?i({type:m.filterableMultiselect,payload:[""]}):(l.length>1&&l.some(u=>u==="")&&(l=l.filter(u=>u!=="")),i({type:m.filterableMultiselect,payload:l})),i({type:he.pageable,payload:{...t,page:1}})};return a.jsx(U,{children:a.jsx(we,{className:"w-96",label:n("entities.hasObjectionPayments"),size:"small",options:o,value:e,onChange:d,multiple:!0})})},ka=e=>{const{t}=Q(),{state:{addCaseModalOpen:i,editCaseModalOpen:n,exportCasesDialogOpen:o,importCasesDialogOpen:d},dispatch:l}=q(),u=()=>{l({type:m.addCaseModalOpen,payload:!1}),l({type:m.resetCaseFormData})},y=()=>{l({type:m.editCaseModalOpen,payload:!1}),l({type:m.resetCaseFormData})},b=()=>{l({type:m.exportCasesDialogOpen,payload:!1}),l({type:m.downloadFile,payload:!1})},C=()=>{l({type:m.importCasesDialogOpen,payload:!1}),l({type:m.resetCaseFormData})};return a.jsx(U,{children:a.jsxs(G.Suspense,{fallback:"Loading....",children:[a.jsxs(X,{className:"my-2 flex justify-between",children:[a.jsxs(X,{className:"grid grid-flow-col gap-2",children:[a.jsx(Ht,{}),a.jsx(oa,{}),a.jsx(ha,{})]}),a.jsxs(X,{children:[a.jsx(me,{color:"success",onClick:()=>l({type:m.importCasesDialogOpen,payload:!d}),children:t("entities.importCases")}),a.jsx(me,{color:"info",onClick:()=>l({type:m.exportCasesDialogOpen,payload:!o}),children:t("entities.exportCases")}),a.jsx(me,{onClick:()=>l({type:m.addCaseModalOpen,payload:!i}),children:t("entities.addNewCase")})]})]}),a.jsx(Tt,{}),a.jsx(Kt,{open:i,onClose:u}),a.jsx(na,{open:n,onClose:y}),o?a.jsx(da,{open:o,onClose:b}):"",d?a.jsx(ma,{open:d,onClose:C}):""]})})};export{ka as Cases};
